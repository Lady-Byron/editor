(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{MenuState:()=>rp,TiptapEditorDriver:()=>Wh,TiptapToolbar:()=>np});const n=flarum.core.compat["forum/app"];var r=t.n(n);const o=flarum.core.compat["common/extend"],i=flarum.core.compat["common/components/TextEditor"];var u=t.n(i);function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,s(t,e)}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h.apply(null,arguments)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function D(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(D=function(){return!!t})()}function v(t){var e="function"==typeof Map?new Map:void 0;return v=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(D())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&s(o,n.prototype),o}(t,arguments,p(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),s(n,t)},v(t)}function g(t){this.content=t}g.prototype={constructor:g,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),i=r.content.slice();return-1==o?i.push(n||t,e):(i[o+1]=e,n&&(i[o]=n)),new g(i)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new g(n)},addToStart:function(t,e){return new g([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new g(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),i=r.find(t);return o.splice(-1==i?o.length:i,0,e,n),new g(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=g.from(t)).size?new g(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=g.from(t)).size?new g(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=g.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}},g.from=function(t){if(t instanceof g)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new g(e)};const F=g;function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function C(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var u=0;o.text[u]==i.text[u];u++)n++;return n}if(o.content.size||i.content.size){var s=C(o.content,i.content,n+1);if(null!=s)return s}n+=o.nodeSize}else n+=o.nodeSize}}function k(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var u=t.child(--o),s=e.child(--i),a=u.nodeSize;if(u!=s){if(!u.sameMarkup(s))return{a:n,b:r};if(u.isText&&u.text!=s.text){for(var c=0,l=Math.min(u.text.length,s.text.length);c<l&&u.text[u.text.length-c-1]==s.text[s.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(u.content.size||s.content.size){var d=k(u.content,s.content,n-1,r-1);if(d)return d}n-=a,r-=a}else n-=a,r-=a}}var E=function(){function t(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize}var e=t.prototype;return e.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,u=0;u<e;i++){var s=this.content[i],a=u+s.nodeSize;if(a>t&&!1!==n(s,r+u,o||null,i)&&s.content.size){var c=u+1;s.nodesBetween(Math.max(0,t-c),Math.min(s.content.size,e-c),n,r+c)}u=a}},e.descendants=function(t){this.nodesBetween(0,this.size,t)},e.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,function(u,s){var a=u.isText?u.text.slice(Math.max(t,s)-s,e-s):u.isLeaf?r?"function"==typeof r?r(u):r:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&a||u.isTextblock)&&n&&(i?i=!1:o+=n),o+=a},0),o},e.append=function(e){if(!e.size)return this;if(!this.size)return e;var n=this.lastChild,r=e.firstChild,o=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)o.push(e.content[i]);return new t(o,this.size+e.size)},e.cut=function(e,n){if(void 0===n&&(n=this.size),0==e&&n==this.size)return this;var r=[],o=0;if(n>e)for(var i=0,u=0;u<n;i++){var s=this.content[i],a=u+s.nodeSize;a>e&&((u<e||a>n)&&(s=s.isText?s.cut(Math.max(0,e-u),Math.min(s.text.length,n-u)):s.cut(Math.max(0,e-u-1),Math.min(s.content.size,n-u-1))),r.push(s),o+=s.nodeSize),u=a}return new t(r,o)},e.cutByIndex=function(e,n){return e==n?t.empty:0==e&&n==this.content.length?this:new t(this.content.slice(e,n))},e.replaceChild=function(e,n){var r=this.content[e];if(r==n)return this;var o=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return o[e]=n,new t(o,i)},e.addToStart=function(e){return new t([e].concat(this.content),this.size+e.nodeSize)},e.addToEnd=function(e){return new t(this.content.concat(e),this.size+e.nodeSize)},e.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},e.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},e.maybeChild=function(t){return this.content[t]||null},e.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},e.findDiffStart=function(t,e){return void 0===e&&(e=0),C(this,t,e)},e.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),k(this,t,e,n)},e.findIndex=function(t){if(0==t)return b(0,t);if(t==this.size)return b(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var e=0,n=0;;e++){var r=n+this.child(e).nodeSize;if(r>=t)return r==t?b(e+1,r):b(e,n);n=r}},e.toString=function(){return"<"+this.toStringInner()+">"},e.toStringInner=function(){return this.content.join(", ")},e.toJSON=function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null},t.fromJSON=function(e,n){if(!n)return t.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new t(n.map(e.nodeFromJSON))},t.fromArray=function(e){if(!e.length)return t.empty;for(var n,r=0,o=0;o<e.length;o++){var i=e[o];r+=i.nodeSize,o&&i.isText&&e[o-1].sameMarkup(i)?(n||(n=e.slice(0,o)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new t(n||e,r)},t.from=function(e){if(!e)return t.empty;if(e instanceof t)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new t([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},f(t,[{key:"firstChild",get:function(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function(){return this.content.length}}])}();E.empty=new E([],0);var A={index:0,offset:0};function b(t,e){return A.index=t,A.offset=e,A}function w(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!w(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!w(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}var x=function(){function t(t,e){this.type=t,this.attrs=e}var e=t.prototype;return e.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},e.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},e.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},e.eq=function(t){return this==t||this.type==t.type&&w(this.attrs,t.attrs)},e.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},t.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");var r=n.create(e.attrs);return n.checkAttrs(r.attrs),r},t.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},t.setFrom=function(e){if(!e||Array.isArray(e)&&0==e.length)return t.none;if(e instanceof t)return[e];var n=e.slice();return n.sort(function(t,e){return t.type.rank-e.type.rank}),n},t}();x.none=[];var B=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e}(v(Error)),S=function(){function t(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}var e=t.prototype;return e.insertAt=function(e,n){var r=T(this.content,e+this.openStart,n);return r&&new t(r,this.openStart,this.openEnd)},e.removeBetween=function(e,n){return new t(M(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)},e.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},e.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},e.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},t.fromJSON=function(e,n){if(!n)return t.empty;var r=n.openStart||0,o=n.openEnd||0;if("number"!=typeof r||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new t(E.fromJSON(e,n.content),r,o)},t.maxOpen=function(e,n){void 0===n&&(n=!0);for(var r=0,o=0,i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(var u=e.lastChild;u&&!u.isLeaf&&(n||!u.type.spec.isolating);u=u.lastChild)o++;return new t(e,r,o)},f(t,[{key:"size",get:function(){return this.content.size-this.openStart-this.openEnd}}])}();function M(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,u=t.maybeChild(o),s=t.findIndex(n),a=s.index,c=s.offset;if(i==e||u.isText){if(c!=n&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(o,u.copy(M(u.content,e-i-1,n-i-1)))}function T(t,e,n,r){var o=t.findIndex(e),i=o.index,u=o.offset,s=t.maybeChild(i);if(u==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var a=T(s.content,e-u-1,n,s);return a&&t.replaceChild(i,s.copy(a))}function O(t,e,n){if(n.openStart>t.depth)throw new B("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new B("Inconsistent open depths");return N(t,e,n,0)}function N(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var u=N(t,e,n,r+1);return i.copy(i.content.replaceChild(o,u))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var s=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(E.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return z(i,$(t,s.start,s.end,e,r))}var a=t.parent,c=a.content;return z(a,c.cut(0,t.parentOffset).append(n.content).append(c.cut(e.parentOffset)))}return z(i,j(t,e,r))}function R(t,e){if(!e.type.compatibleContent(t.type))throw new B("Cannot join "+e.type.name+" onto "+t.type.name)}function I(t,e,n){var r=t.node(n);return R(r,e.node(n)),r}function L(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function P(t,e,n,r){var o=(e||t).node(n),i=0,u=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(L(t.nodeAfter,r),i++));for(var s=i;s<u;s++)L(o.child(s),r);e&&e.depth==n&&e.textOffset&&L(e.nodeBefore,r)}function z(t,e){return t.type.checkContent(e),t.copy(e)}function $(t,e,n,r,o){var i=t.depth>o&&I(t,e,o+1),u=r.depth>o&&I(n,r,o+1),s=[];return P(null,t,o,s),i&&u&&e.index(o)==n.index(o)?(R(i,u),L(z(i,$(t,e,n,r,o+1)),s)):(i&&L(z(i,j(t,e,o+1)),s),P(e,n,o,s),u&&L(z(u,j(n,r,o+1)),s)),P(r,null,o,s),new E(s)}function j(t,e,n){var r=[];return P(null,t,n,r),t.depth>n&&L(z(I(t,e,n+1),j(t,e,n+1)),r),P(e,null,n,r),new E(r)}S.empty=new S(E.empty,0,0);var H=function(){function t(t,e,n){this.pos=t,this.path=e,this.parentOffset=n,this.depth=e.length/3-1}var e=t.prototype;return e.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},e.node=function(t){return this.path[3*this.resolveDepth(t)]},e.index=function(t){return this.path[3*this.resolveDepth(t)+1]},e.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},e.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},e.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},e.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},e.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},e.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},e.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return x.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,u=0;u<i.length;u++)!1!==i[u].type.spec.inclusive||r&&i[u].isInSet(r.marks)||(i=i[u--].removeFromSet(i));return i},e.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},e.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},e.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new W(this,t,n);return null},e.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},e.max=function(t){return t.pos>this.pos?t:this},e.min=function(t){return t.pos<this.pos?t:this},e.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},t.resolve=function(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");for(var r=[],o=0,i=n,u=e;;){var s=u.content.findIndex(i),a=s.index,c=s.offset,l=i-c;if(r.push(u,a,o+c),!l)break;if((u=u.child(a)).isText)break;i=l-1,o+=c+1}return new t(n,r,i)},t.resolveCached=function(e,n){var r=q.get(e);if(r)for(var o=0;o<r.elts.length;o++){var i=r.elts[o];if(i.pos==n)return i}else q.set(e,r=new V);var u=r.elts[r.i]=t.resolve(e,n);return r.i=(r.i+1)%_,u},f(t,[{key:"parent",get:function(){return this.node(this.depth)}},{key:"doc",get:function(){return this.node(0)}},{key:"textOffset",get:function(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r}},{key:"nodeBefore",get:function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}}])}(),V=function(){this.elts=[],this.i=0},_=12,q=new WeakMap,W=function(){return f(function(t,e,n){this.$from=t,this.$to=e,this.depth=n},[{key:"start",get:function(){return this.$from.before(this.depth+1)}},{key:"end",get:function(){return this.$to.after(this.depth+1)}},{key:"parent",get:function(){return this.$from.node(this.depth)}},{key:"startIndex",get:function(){return this.$from.index(this.depth)}},{key:"endIndex",get:function(){return this.$to.indexAfter(this.depth)}}])}(),K=Object.create(null),U=function(){function t(t,e,n,r){void 0===r&&(r=x.none),this.type=t,this.attrs=e,this.marks=r,this.content=n||E.empty}var e=t.prototype;return e.child=function(t){return this.content.child(t)},e.maybeChild=function(t){return this.content.maybeChild(t)},e.forEach=function(t){this.content.forEach(t)},e.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},e.descendants=function(t){this.nodesBetween(0,this.content.size,t)},e.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},e.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},e.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},e.hasMarkup=function(t,e,n){return this.type==t&&w(this.attrs,e||t.defaultAttrs||K)&&x.sameSet(this.marks,n||x.none)},e.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new t(this.type,this.attrs,e,this.marks)},e.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.content,e)},e.cut=function(t,e){return void 0===e&&(e=this.content.size),0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},e.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return S.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),u=r.start(i),s=r.node(i).content.cut(r.pos-u,o.pos-u);return new S(s,r.depth-i,o.depth-i)},e.replace=function(t,e,n){return O(this.resolve(t),this.resolve(e),n)},e.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},e.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},e.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},e.resolve=function(t){return H.resolveCached(this,t)},e.resolveNoCache=function(t){return H.resolve(this,t)},e.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,function(t){return n.isInSet(t.marks)&&(r=!0),!r}),r},e.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),G(this.marks,t)},e.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},e.canReplace=function(t,e,n,r,o){void 0===n&&(n=E.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),u=i&&i.matchFragment(this.content,e);if(!u||!u.validEnd)return!1;for(var s=r;s<o;s++)if(!this.type.allowsMarks(n.child(s).marks))return!1;return!0},e.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},e.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},e.check=function(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);for(var t=x.none,e=0;e<this.marks.length;e++){var n=this.marks[e];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!x.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map(function(t){return t.type.name}));this.content.forEach(function(t){return t.check()})},e.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(t){return t.toJSON()})),t},t.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=void 0;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=E.fromJSON(t,e.content),o=t.nodeType(e.type).create(e.attrs,r,n);return o.type.checkAttrs(o.attrs),o},f(t,[{key:"children",get:function(){return this.content.content}},{key:"nodeSize",get:function(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function(){return this.content.childCount}},{key:"textContent",get:function(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"firstChild",get:function(){return this.content.firstChild}},{key:"lastChild",get:function(){return this.content.lastChild}},{key:"isBlock",get:function(){return this.type.isBlock}},{key:"isTextblock",get:function(){return this.type.isTextblock}},{key:"inlineContent",get:function(){return this.type.inlineContent}},{key:"isInline",get:function(){return this.type.isInline}},{key:"isText",get:function(){return this.type.isText}},{key:"isLeaf",get:function(){return this.type.isLeaf}},{key:"isAtom",get:function(){return this.type.isAtom}}])}();U.prototype.text=void 0;var J=function(t){function e(e,n,r,o){var i;if(i=t.call(this,e,n,null,o)||this,!r)throw new RangeError("Empty text nodes are not allowed");return i.text=r,i}a(e,t);var n=e.prototype;return n.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):G(this.marks,JSON.stringify(this.text))},n.textBetween=function(t,e){return this.text.slice(t,e)},n.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},n.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},n.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},n.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},f(e,[{key:"textContent",get:function(){return this.text}},{key:"nodeSize",get:function(){return this.text.length}}])}(U);function G(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var Z=function(){function t(t){this.validEnd=t,this.next=[],this.wrapCache=[]}t.parse=function(e,n){var r=new Q(e,n);if(null==r.next)return t.empty;var o=X(r);r.next&&r.err("Unexpected trailing text");var i=it(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce(function(e,n){return e.concat(t(n,i))},[]);if("seq"!=e.type){if("star"==e.type){var u=n();return r(i,u),o(t(e.expr,u),u),[r(u)]}if("plus"==e.type){var s=n();return o(t(e.expr,i),s),o(t(e.expr,s),s),[r(s)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var a=i,c=0;c<e.min;c++){var l=n();o(t(e.expr,a),l),a=l}if(-1==e.max)o(t(e.expr,a),a);else for(var d=e.min;d<e.max;d++){var f=n();r(a,f),o(t(e.expr,a),f),a=f}return[r(a)]}if("name"==e.type)return[r(i,void 0,e.value)];throw new Error("Unknown expr type")}for(var h=0;;h++){var p=t(e.exprs[h],i);if(h==e.exprs.length-1)return p;o(p,i=n())}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach(function(t){return t.to=e})}}(o));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,u=[],s=0;s<o.next.length;s++){var a=o.next[s],c=a.type,l=a.next;u.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+u.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(i,r),i};var e=t.prototype;return e.matchType=function(t){for(var e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null},e.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},e.compatible=function(t){for(var e=0;e<this.next.length;e++)for(var n=0;n<t.next.length;n++)if(this.next[e].type==t.next[n].type)return!0;return!1},e.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,u){var s=i.matchFragment(t,n);if(s&&(!e||s.validEnd))return E.from(u.map(function(t){return t.createAndFill()}));for(var a=0;a<i.next.length;a++){var c=i.next[a],l=c.type,d=c.next;if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(d)){r.push(d);var f=o(d,u.concat(l));if(f)return f}}return null}(this,[])},e.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},e.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],u=r;u.type;u=u.via)i.push(u.type);return i.reverse()}for(var s=0;s<o.next.length;s++){var a=o.next[s],c=a.type,l=a.next;c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!l.validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}return null},e.edge=function(t){if(t>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return this.next[t]},e.toString=function(){var t=[];return function e(n){t.push(n);for(var r=0;r<n.next.length;r++)-1==t.indexOf(n.next[r].next)&&e(n.next[r].next)}(this),t.map(function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o++)r+=(o?", ":"")+e.next[o].type.name+"->"+t.indexOf(e.next[o].next);return r}).join("\n")},f(t,[{key:"inlineContent",get:function(){return 0!=this.next.length&&this.next[0].type.isInline}},{key:"defaultType",get:function(){for(var t=0;t<this.next.length;t++){var e=this.next[t].type;if(!e.isText&&!e.hasRequiredAttrs())return e}return null}},{key:"edgeCount",get:function(){return this.next.length}}])}();Z.empty=new Z(!0);var Q=function(){function t(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}var e=t.prototype;return e.eat=function(t){return this.next==t&&(this.pos++||!0)},e.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},f(t,[{key:"next",get:function(){return this.tokens[this.pos]}}])}();function X(t){var e=[];do{e.push(Y(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Y(t){var e=[];do{e.push(tt(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function tt(t){for(var e=function(t){if(t.eat("(")){var e=X(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var u=n[i];u.isInGroup(e)&&o.push(u)}return 0==o.length&&t.err("No node type or group '"+e+"' found"),o}(t,t.next).map(function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}});return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=nt(t,e)}return e}function et(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function nt(t,e){var n=et(t),r=n;return t.eat(",")&&(r="}"!=t.next?et(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function rt(t,e){return e-t}function ot(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var u=o[i],s=u.term,a=u.to;s||-1!=n.indexOf(a)||e(a)}}(e),n.sort(rt)}function it(t){var e=Object.create(null);return function n(r){var o=[];r.forEach(function(e){t[e].forEach(function(e){var n=e.term,r=e.to;if(n){for(var i,u=0;u<o.length;u++)o[u][0]==n&&(i=o[u][1]);ot(t,r).forEach(function(t){i||o.push([n,i=[]]),-1==i.indexOf(t)&&i.push(t)})}})});for(var i=e[r.join(",")]=new Z(r.indexOf(t.length-1)>-1),u=0;u<o.length;u++){var s=o[u][1].sort(rt);i.next.push({type:o[u][0],next:e[s.join(",")]||n(s)})}return i}(ot(t,0))}function ut(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function st(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function at(t,e,n,r){for(var o in e)if(!(o in t))throw new RangeError("Unsupported attribute "+o+" for "+n+" of type "+o);for(var i in t){var u=t[i];u.validate&&u.validate(e[i])}}function ct(t,e){var n=Object.create(null);if(e)for(var r in e)n[r]=new dt(t,r,e[r]);return n}var lt=function(){function t(t,e,n){this.name=t,this.schema=e,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=ct(t,n.attrs),this.defaultAttrs=ut(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}var e=t.prototype;return e.isInGroup=function(t){return this.groups.indexOf(t)>-1},e.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},e.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},e.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:st(this.attrs,t)},e.create=function(t,e,n){if(void 0===t&&(t=null),this.isText)throw new Error("NodeType.create can't construct text nodes");return new U(this,this.computeAttrs(t),E.from(e),x.setFrom(n))},e.createChecked=function(t,e,n){return void 0===t&&(t=null),e=E.from(e),this.checkContent(e),new U(this,this.computeAttrs(t),e,x.setFrom(n))},e.createAndFill=function(t,e,n){if(void 0===t&&(t=null),t=this.computeAttrs(t),(e=E.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e),i=o&&o.fillBefore(E.empty,!0);return i?new U(this,t,e.append(i),x.setFrom(n)):null},e.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},e.checkContent=function(t){if(!this.validContent(t))throw new RangeError("Invalid content for node "+this.name+": "+t.toString().slice(0,50))},e.checkAttrs=function(t){at(this.attrs,t,"node",this.name)},e.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},e.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},e.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:x.none:t},t.compile=function(e,n){var r=Object.create(null);e.forEach(function(e,o){return r[e]=new t(e,n,o)});var o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r},f(t,[{key:"isInline",get:function(){return!this.isBlock}},{key:"isTextblock",get:function(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function(){return this.contentMatch==Z.empty}},{key:"isAtom",get:function(){return this.isLeaf||!!this.spec.atom}},{key:"whitespace",get:function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}}])}(),dt=function(){return f(function(t,e,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(t,e,n){var r=n.split("|");return function(n){var o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError("Expected value of type "+r+" for attribute "+e+" on type "+t+", got "+o)}}(t,e,n.validate):n.validate},[{key:"isRequired",get:function(){return!this.hasDefault}}])}(),ft=function(){function t(t,e,n,r){this.name=t,this.rank=e,this.schema=n,this.spec=r,this.attrs=ct(t,r.attrs),this.excluded=null;var o=ut(this.attrs);this.instance=o?new x(this,o):null}var e=t.prototype;return e.create=function(t){return void 0===t&&(t=null),!t&&this.instance?this.instance:new x(this,st(this.attrs,t))},t.compile=function(e,n){var r=Object.create(null),o=0;return e.forEach(function(e,i){return r[e]=new t(e,o++,n,i)}),r},e.removeFromSet=function(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t},e.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},e.checkAttrs=function(t){at(this.attrs,t,"mark",this.name)},e.excludes=function(t){return this.excluded.indexOf(t)>-1},t}(),ht=function(){function t(t){var e=this;this.linebreakReplacement=null,this.cached=Object.create(null);var n=this.spec={};for(var r in t)n[r]=t[r];n.nodes=F.from(t.nodes),n.marks=F.from(t.marks||{}),this.nodes=lt.compile(this.spec.nodes,this),this.marks=ft.compile(this.spec.marks,this);var o=Object.create(null);for(var i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");var u=this.nodes[i],s=u.spec.content||"",a=u.spec.marks;if(u.contentMatch=o[s]||(o[s]=Z.parse(s,this.nodes)),u.inlineContent=u.contentMatch.inlineContent,u.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!u.isInline||!u.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=u}u.markSet="_"==a?null:a?pt(this,a.split(" ")):""!=a&&u.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],d=l.spec.excludes;l.excluded=null==d?[l]:""==d?[]:pt(this,d.split(" "))}this.nodeFromJSON=function(t){return U.fromJSON(e,t)},this.markFromJSON=function(t){return x.fromJSON(e,t)},this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}var e=t.prototype;return e.node=function(t,e,n,r){if(void 0===e&&(e=null),"string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof lt))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},e.text=function(t,e){var n=this.nodes.text;return new J(n,n.defaultAttrs,t,x.setFrom(e))},e.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},e.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e},t}();function pt(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],u=i;if(i)n.push(i);else for(var s in t.marks){var a=t.marks[s];("_"==o||a.spec.group&&a.spec.group.split(" ").indexOf(o)>-1)&&n.push(u=a)}if(!u)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}var mt=function(){function t(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[];var r=this.matchedStyles=[];e.forEach(function(t){if(function(t){return null!=t.tag}(t))n.tags.push(t);else if(function(t){return null!=t.style}(t)){var e=/[^=]*/.exec(t.style)[0];r.indexOf(e)<0&&r.push(e),n.styles.push(t)}}),this.normalizeLists=!this.tags.some(function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)})}var e=t.prototype;return e.parse=function(t,e){void 0===e&&(e={});var n=new Ct(this,e,!1);return n.addAll(t,x.none,e.from,e.to),n.finish()},e.parseSlice=function(t,e){void 0===e&&(e={});var n=new Ct(this,e,!0);return n.addAll(t,x.none,e.from,e.to),S.maxOpen(n.finish())},e.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(kt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i||void 0}return o}}},e.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o],u=i.style;if(!(0!=u.indexOf(t)||i.context&&!n.matchesContext(i.context)||u.length>t.length&&(61!=u.charCodeAt(t.length)||u.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s||void 0}return i}}},t.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach(function(t){n(t=Et(t)),t.mark||t.ignore||t.clearMark||(t.mark=e)})};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[e].spec.parseDOM;r&&r.forEach(function(t){n(t=Et(t)),t.node||t.ignore||t.mark||(t.node=e)})};for(var u in t.nodes)i(u);return e},t.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new t(e,t.schemaRules(e)))},t}(),Dt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},vt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},gt={ol:!0,ul:!0};function Ft(t,e,n){return null!=e?(e?1:0)|("full"===e?2:0):t&&"pre"==t.whitespace?3:-5&n}var yt=function(){function t(t,e,n,r,o,i){this.type=t,this.attrs=e,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=x.none,this.match=o||(4&i?null:t.contentMatch)}var e=t.prototype;return e.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(E.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},e.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];if(n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))){var r=n;n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=r.withText(r.text.slice(0,r.text.length-e[0].length))}}var o=E.from(this.content);return!t&&this.match&&(o=o.append(this.match.fillBefore(E.empty,!0))),this.type?this.type.create(this.attrs,o,this.marks):o},e.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Dt.hasOwnProperty(t.parentNode.nodeName.toLowerCase())},t}(),Ct=function(){function t(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.open=0,this.localPreserveWS=!1;var r,o=e.topNode,i=Ft(null,e.preserveWhitespace,0)|(n?4:0);r=o?new yt(o.type,o.attrs,x.none,!0,e.topMatch||o.type.contentMatch,i):new yt(n?null:t.schema.topNodeType,null,x.none,!0,null,i),this.nodes=[r],this.find=e.findPositions,this.needsBlock=!1}var e=t.prototype;return e.addDOM=function(t,e){3==t.nodeType?this.addTextNode(t,e):1==t.nodeType&&this.addElement(t,e)},e.addTextNode=function(t,e){var n=t.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,i=this.parser.schema;if("full"===o||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){for(var u=n.split(/\r?\n|\r/),s=0;s<u.length;s++)s&&this.insertNode(i.linebreakReplacement.create(),e,!0),u[s]&&this.insertNode(i.text(u[s]),e,!/\S/.test(u[s]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){var a=r.content[r.content.length-1],c=t.previousSibling;(!a||c&&"BR"==c.nodeName||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),e,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)},e.addElement=function(t,e,n){var r=this.localPreserveWS,o=this.top;("PRE"==t.tagName||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);var i,u=t.nodeName.toLowerCase();gt.hasOwnProperty(u)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&gt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var s=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,n));t:if(s?s.ignore:vt.hasOwnProperty(u))this.findInside(t),this.ignoreFallback(t,e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(t=s.skip);var a,c=this.needsBlock;if(Dt.hasOwnProperty(u))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),a=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}var l=s&&s.skip?e:this.readStyles(t,e);l&&this.addAll(t,l),a&&this.sync(o),this.needsBlock=c}else{var d=this.readStyles(t,e);d&&this.addElementByRule(t,s,d,!1===s.consuming?i:void 0)}this.localPreserveWS=r},e.leafFallback=function(t,e){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"),e)},e.ignoreFallback=function(t,e){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),e,!0)},e.readStyles=function(t,e){var n=this,r=t.style;if(r&&r.length)for(var o=0;o<this.parser.matchedStyles.length;o++){var i=this.parser.matchedStyles[o],u=r.getPropertyValue(i);if(u)for(var s,a=function(t){var r=n.parser.matchStyle(i,u,n,t);return r?r.ignore?{v:null}:(e=r.clearMark?e.filter(function(t){return!r.clearMark(t)}):e.concat(n.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming?(c=t,0):void(c=t=r)):(c=t,0)},c=void 0;0!==(s=a(c));)if(s)return s.v}return e},e.addElementByRule=function(t,e,n,r){var o,i,u=this;if(e.node)if((i=this.parser.schema.nodes[e.node]).isLeaf)this.insertNode(i.create(e.attrs),n,"BR"==t.nodeName)||this.leafFallback(t,n);else{var s=this.enter(i,e.attrs||null,n,e.preserveWhitespace);s&&(o=!0,n=s)}else{var a=this.parser.schema.marks[e.mark];n=n.concat(a.create(e.attrs))}var c=this.top;if(i&&i.isLeaf)this.findInside(t);else if(r)this.addElement(t,n,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(function(t){return u.insertNode(t,n,!1)});else{var l=t;"string"==typeof e.contentElement?l=t.querySelector(e.contentElement):"function"==typeof e.contentElement?l=e.contentElement(t):e.contentElement&&(l=e.contentElement),this.findAround(t,l,!0),this.addAll(l,n),this.findAround(t,l,!1)}o&&this.sync(c)&&this.open--},e.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,u=null==r?null:t.childNodes[r];i!=u;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i,e);this.findAtPoint(t,o)},e.findPlace=function(t,e,n){for(var r,o,i=this.open,u=0;i>=0;i--){var s=this.nodes[i],a=s.findWrapping(t);if(a&&(!r||r.length>a.length+u)&&(r=a,o=s,!a.length))break;if(s.solid){if(n)break;u+=2}}if(!r)return null;this.sync(o);for(var c=0;c<r.length;c++)e=this.enterInner(r[c],null,e,!1);return e},e.insertNode=function(t,e,n){if(t.isInline&&this.needsBlock&&!this.top.type){var r=this.textblockFromContext();r&&(e=this.enterInner(r,null,e))}var o=this.findPlace(t,e,n);if(o){this.closeExtra();var i=this.top;i.match&&(i.match=i.match.matchType(t.type));for(var u,s=x.none,a=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return y(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(o.concat(t.marks));!(u=a()).done;){var c=u.value;(i.type?i.type.allowsMarkType(c.type):At(c.type,t.type))&&(s=c.addToSet(s))}return i.content.push(t.mark(s)),!0}return!1},e.enter=function(t,e,n,r){var o=this.findPlace(t.create(e),n,!1);return o&&(o=this.enterInner(t,e,n,!0,r)),o},e.enterInner=function(t,e,n,r,o){void 0===r&&(r=!1),this.closeExtra();var i=this.top;i.match=i.match&&i.match.matchType(t);var u=Ft(t,o,i.options);4&i.options&&0==i.content.length&&(u|=4);var s=x.none;return n=n.filter(function(e){return!(i.type?i.type.allowsMarkType(e.type):At(e.type,t))||(s=e.addToSet(s),!1)}),this.nodes.push(new yt(t,e,s,r,null,u)),this.open++,n},e.closeExtra=function(t){void 0===t&&(t=!1);var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},e.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))},e.sync=function(t){for(var e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=1)}return!1},e.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},e.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},e.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++)null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)&&e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)},e.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},e.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),u=function(t,s){for(;t>=0;t--){var a=n[t];if(""==a){if(t==n.length-1||0==t)continue;for(;s>=i;s--)if(u(t-1,s))return!0;return!1}var c=s>0||0==s&&o?e.nodes[s].type:r&&s>=i?r.node(s-i).type:null;if(!c||c.name!=a&&!c.isInGroup(a))return!1;s--}return!0};return u(n.length-1,this.open)},e.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},f(t,[{key:"top",get:function(){return this.nodes[this.open]}},{key:"currentPos",get:function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t}}])}();function kt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Et(t){var e={};for(var n in t)e[n]=t[n];return e}function At(t,e){var n,r=e.schema.nodes,o=function(){var n=r[i];if(!n.allowsMarkType(t))return 0;var o=[],u=function(t){o.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),i=r.type,s=r.next;if(i==e)return!0;if(o.indexOf(s)<0&&u(s))return!0}};return u(n.contentMatch)?{v:!0}:void 0};for(var i in r)if(0!==(n=o())&&n)return n.v}var bt=function(){function t(t,e){this.nodes=t,this.marks=e}var e=t.prototype;return e.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=xt(e).createDocumentFragment());var o=n,i=[];return t.forEach(function(t){if(i.length||t.marks.length){for(var n=0,u=0;n<i.length&&u<t.marks.length;){var s=t.marks[u];if(r.marks[s.type.name]){if(!s.eq(i[n][0])||!1===s.type.spec.spanning)break;n++,u++}else u++}for(;n<i.length;)o=i.pop()[1];for(;u<t.marks.length;){var a=t.marks[u++],c=r.serializeMark(a,t.isInline,e);c&&(i.push([a,o]),o.appendChild(c.dom),o=c.contentDOM||c.dom)}}o.appendChild(r.serializeNodeInner(t,e))}),n},e.serializeNodeInner=function(t,e){var n=St(xt(e),this.nodes[t.type.name](t),null,t.attrs),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,o)}return r},e.serializeNode=function(t,e){void 0===e&&(e={});for(var n=this.serializeNodeInner(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},e.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&St(xt(n),r(t,e),null,t.attrs)},t.renderSpec=function(t,e,n,r){return void 0===n&&(n=null),St(t,e,n,r)},t.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new t(this.nodesFromSchema(e),this.marksFromSchema(e)))},t.nodesFromSchema=function(t){var e=wt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},t.marksFromSchema=function(t){return wt(t.marks)},t}();function wt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function xt(t){return t.document||window.document}var Bt=new WeakMap;function St(t,e,n,r){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var o,i=e[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=function(t){var e=Bt.get(t);return void 0===e&&Bt.set(t,e=function(t){var e=null;return function t(n){if(n&&"object"==typeof n)if(Array.isArray(n))if("string"==typeof n[0])e||(e=[]),e.push(n);else for(var r=0;r<n.length;r++)t(n[r]);else for(var o in n)t(n[o])}(t),e}(t)),e}(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");var u,s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));var a=n?t.createElementNS(n,i):t.createElement(i),c=e[1],l=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c))for(var d in l=2,c)if(null!=c[d]){var f=d.indexOf(" ");f>0?a.setAttributeNS(d.slice(0,f),d.slice(f+1),c[d]):"style"==d&&a.style?a.style.cssText=c[d]:a.setAttribute(d,c[d])}for(var h=l;h<e.length;h++){var p=e[h];if(0===p){if(h<e.length-1||h>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}var m=St(t,p,n,r),D=m.dom,v=m.contentDOM;if(a.appendChild(D),v){if(u)throw new RangeError("Multiple content holes");u=v}}return{dom:a,contentDOM:u}}var Mt=Math.pow(2,16);function Tt(t,e){return t+e*Mt}function Ot(t){return 65535&t}var Nt=function(){return f(function(t,e,n){this.pos=t,this.delInfo=e,this.recover=n},[{key:"deleted",get:function(){return(8&this.delInfo)>0}},{key:"deletedBefore",get:function(){return(5&this.delInfo)>0}},{key:"deletedAfter",get:function(){return(6&this.delInfo)>0}},{key:"deletedAcross",get:function(){return(4&this.delInfo)>0}}])}(),Rt=function(){function t(e,n){if(void 0===n&&(n=!1),this.ranges=e,this.inverted=n,!e.length&&t.empty)return t.empty}var e=t.prototype;return e.recover=function(t){var e=0,n=Ot(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/Mt}(t)},e.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},e.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},e._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,u=0;u<this.ranges.length;u+=3){var s=this.ranges[u]-(this.inverted?r:0);if(s>t)break;var a=this.ranges[u+o],c=this.ranges[u+i],l=s+a;if(t<=l){var d=s+r+((a?t==s?-1:t==l?1:e:e)<0?0:c);if(n)return d;var f=t==(e<0?s:l)?null:Tt(u/3,t-s),h=t==s?2:t==l?1:4;return(e<0?t!=s:t!=l)&&(h|=8),new Nt(d,h,f)}r+=c-a}return n?t+r:new Nt(t+r,0,null)},e.touches=function(t,e){for(var n=0,r=Ot(e),o=this.inverted?2:1,i=this.inverted?1:2,u=0;u<this.ranges.length;u+=3){var s=this.ranges[u]-(this.inverted?n:0);if(s>t)break;var a=this.ranges[u+o];if(t<=s+a&&u==3*r)return!0;n+=this.ranges[u+i]-a}return!1},e.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],u=i-(this.inverted?o:0),s=i+(this.inverted?0:o),a=this.ranges[r+e],c=this.ranges[r+n];t(u,u+a,s,s+c),o+=c-a}},e.invert=function(){return new t(this.ranges,!this.inverted)},e.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},t.offset=function(e){return 0==e?t.empty:new t(e<0?[0,-e,0]:[0,0,e])},t}();Rt.empty=new Rt([]);var It=function(){function t(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),this.mirror=e,this.from=n,this.to=r,this._maps=t||[],this.ownData=!(t||e)}var e=t.prototype;return e.slice=function(e,n){return void 0===e&&(e=0),void 0===n&&(n=this.maps.length),new t(this._maps,this.mirror,e,n)},e.appendMap=function(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),null!=e&&this.setMirror(this._maps.length-1,e)},e.appendMapping=function(t){for(var e=0,n=this._maps.length;e<t._maps.length;e++){var r=t.getMirror(e);this.appendMap(t._maps[e],null!=r&&r<e?n+r:void 0)}},e.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},e.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},e.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this._maps.length+t._maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t._maps[e].invert(),null!=r&&r>e?n-r-1:void 0)}},e.invert=function(){var e=new t;return e.appendMappingInverted(this),e},e.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this._maps[n].map(t,e);return t},e.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},e._map=function(t,e,n){for(var r=0,o=this.from;o<this.to;o++){var i=this._maps[o].mapResult(t,e);if(null!=i.recover){var u=this.getMirror(o);if(null!=u&&u>o&&u<this.to){o=u,t=this._maps[u].recover(i.recover);continue}}r|=i.delInfo,t=i.pos}return n?t:new Nt(t,r,null)},f(t,[{key:"maps",get:function(){return this._maps}}])}(),Lt=Object.create(null),Pt=function(){function t(){}var e=t.prototype;return e.getMap=function(){return Rt.empty},e.merge=function(t){return null},t.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=Lt[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},t.jsonID=function(t,e){if(t in Lt)throw new RangeError("Duplicate use of step JSON ID "+t);return Lt[t]=e,e.prototype.jsonID=t,e},t}(),zt=function(){function t(t,e){this.doc=t,this.failed=e}return t.ok=function(e){return new t(e,null)},t.fail=function(e){return new t(null,e)},t.fromReplace=function(e,n,r,o){try{return t.ok(e.replace(n,r,o))}catch(e){if(e instanceof B)return t.fail(e.message);throw e}},t}();function $t(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);i.content.size&&(i=i.copy($t(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return E.fromArray(r)}var jt=function(t){function e(e,n,r){var o;return(o=t.call(this)||this).from=e,o.to=n,o.mark=r,o}a(e,t);var n=e.prototype;return n.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new S($t(n.content,function(t,n){return t.isAtom&&n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t},o),n.openStart,n.openEnd);return zt.fromReplace(t,this.from,this.to,i)},n.invert=function(){return new Ht(this.from,this.to,this.mark)},n.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},n.merge=function(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null},n.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Pt);Pt.jsonID("addMark",jt);var Ht=function(t){function e(e,n,r){var o;return(o=t.call(this)||this).from=e,o.to=n,o.mark=r,o}a(e,t);var n=e.prototype;return n.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new S($t(n.content,function(t){return t.mark(e.mark.removeFromSet(t.marks))},t),n.openStart,n.openEnd);return zt.fromReplace(t,this.from,this.to,r)},n.invert=function(){return new jt(this.from,this.to,this.mark)},n.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},n.merge=function(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null},n.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Pt);Pt.jsonID("removeMark",Ht);var Vt=function(t){function e(e,n){var r;return(r=t.call(this)||this).pos=e,r.mark=n,r}a(e,t);var n=e.prototype;return n.apply=function(t){var e=t.nodeAt(this.pos);if(!e)return zt.fail("No node at mark step's position");var n=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return zt.fromReplace(t,this.pos,this.pos+1,new S(E.from(n),0,e.isLeaf?0:1))},n.invert=function(t){var n=t.nodeAt(this.pos);if(n){var r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(var o=0;o<n.marks.length;o++)if(!n.marks[o].isInSet(r))return new e(this.pos,n.marks[o]);return new e(this.pos,this.mark)}}return new _t(this.pos,this.mark)},n.map=function(t){var n=t.mapResult(this.pos,1);return n.deletedAfter?null:new e(n.pos,this.mark)},n.toJSON=function(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(n.pos,t.markFromJSON(n.mark))},e}(Pt);Pt.jsonID("addNodeMark",Vt);var _t=function(t){function e(e,n){var r;return(r=t.call(this)||this).pos=e,r.mark=n,r}a(e,t);var n=e.prototype;return n.apply=function(t){var e=t.nodeAt(this.pos);if(!e)return zt.fail("No node at mark step's position");var n=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return zt.fromReplace(t,this.pos,this.pos+1,new S(E.from(n),0,e.isLeaf?0:1))},n.invert=function(t){var e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new Vt(this.pos,this.mark):this},n.map=function(t){var n=t.mapResult(this.pos,1);return n.deletedAfter?null:new e(n.pos,this.mark)},n.toJSON=function(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(n.pos,t.markFromJSON(n.mark))},e}(Pt);Pt.jsonID("removeNodeMark",_t);var qt=function(t){function e(e,n,r,o){var i;return void 0===o&&(o=!1),(i=t.call(this)||this).from=e,i.to=n,i.slice=r,i.structure=o,i}a(e,t);var n=e.prototype;return n.apply=function(t){return this.structure&&Kt(t,this.from,this.to)?zt.fail("Structure replace would overwrite content"):zt.fromReplace(t,this.from,this.to,this.slice)},n.getMap=function(){return new Rt([this.from,this.to-this.from,this.slice.size])},n.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},n.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)},n.merge=function(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?S.empty:new S(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?S.empty:new S(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},n.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,S.fromJSON(t,n.slice),!!n.structure)},e}(Pt);Pt.jsonID("replace",qt);var Wt=function(t){function e(e,n,r,o,i,u,s){var a;return void 0===s&&(s=!1),(a=t.call(this)||this).from=e,a.to=n,a.gapFrom=r,a.gapTo=o,a.slice=i,a.insert=u,a.structure=s,a}a(e,t);var n=e.prototype;return n.apply=function(t){if(this.structure&&(Kt(t,this.from,this.gapFrom)||Kt(t,this.gapTo,this.to)))return zt.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return zt.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?zt.fromReplace(t,this.from,this.to,n):zt.fail("Content does not fit in gap")},n.getMap=function(){return new Rt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},n.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},n.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=this.from==this.gapFrom?n.pos:t.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},n.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,S.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(Pt);function Kt(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var u=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!u||u.isLeaf)return!0;u=u.firstChild,o--}return!1}function Ut(t,e,n,r,o){void 0===r&&(r=n.contentMatch),void 0===o&&(o=!0);for(var i=t.doc.nodeAt(e),u=[],s=e+1,a=0;a<i.childCount;a++){var c=i.child(a),l=s+c.nodeSize,d=r.matchType(c.type);if(d){r=d;for(var f=0;f<c.marks.length;f++)n.allowsMarkType(c.marks[f].type)||t.step(new Ht(s,l,c.marks[f]));if(o&&c.isText&&"pre"!=n.whitespace)for(var h=void 0,p=/\r?\n|\r/g,m=void 0;h=p.exec(c.text);)m||(m=new S(E.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),u.push(new qt(s+h.index,s+h.index+h[0].length,m))}else u.push(new qt(s,l,S.empty));s=l}if(!r.validEnd){var D=r.fillBefore(E.empty,!0);t.replace(s,s,new S(D,0,0))}for(var v=u.length-1;v>=0;v--)t.step(u[v])}function Jt(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Gt(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),n=t.depth,r=0,o=0;;--n){var i=t.$from.node(n),u=t.$from.index(n)+r,s=t.$to.indexAfter(n)-o;if(n<t.depth&&i.canReplace(u,s,e))return n;if(0==n||i.type.spec.isolating||!Jt(i,u,s))break;u&&(r=1),s<i.childCount&&(o=1)}return null}function Zt(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=t);var o=function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;var u=i.length?i[0]:e;return n.canReplaceWith(r,o,u)?i:null}(t,e),i=o&&function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.child(r),u=e.contentMatch.findWrapping(i.type);if(!u)return null;for(var s=(u.length?u[u.length-1]:e).contentMatch,a=r;s&&a<o;a++)s=s.matchType(n.child(a).type);return s&&s.validEnd?u:null}(r,e);return i?o.map(Qt).concat({type:e,attrs:n}).concat(i.map(Qt)):null}function Qt(t){return{type:t,attrs:null}}function Xt(t,e,n,r){e.forEach(function(o,i){if(o.isText)for(var u,s=/\r?\n|\r/g;u=s.exec(o.text);){var a=t.mapping.slice(r).map(n+1+i+u.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}})}function Yt(t,e,n,r){e.forEach(function(o,i){if(o.type==o.type.schema.linebreakReplacement){var u=t.mapping.slice(r).map(n+1+i);t.replaceWith(u,u+1,e.type.schema.text("\n"))}})}function te(t,e,n,r){void 0===n&&(n=1);var o=t.resolve(e),i=o.depth-n,u=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!u.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var s=o.depth-1,a=n-2;s>i;s--,a--){var c=o.node(s),l=o.index(s);if(c.type.spec.isolating)return!1;var d=c.content.cutByIndex(l,c.childCount),f=r&&r[a+1];f&&(d=d.replaceChild(0,f.type.create(f.attrs)));var h=r&&r[a]||c;if(!c.canReplace(l+1,c.childCount)||!h.type.validContent(d))return!1}var p=o.indexAfter(i),m=r&&r[0];return o.node(i).canReplaceWith(p,p,m?m.type:o.node(i+1).type)}function ee(t,e){var n=t.resolve(e),r=n.index();return ne(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function ne(t,e){return!(!t||!e||t.isLeaf||!function(t,e){e.content.size||t.type.compatibleContent(e.type);for(var n=t.contentMatchAt(t.childCount),r=t.type.schema.linebreakReplacement,o=0;o<e.childCount;o++){var i=e.child(o),u=i.type==r?t.type.schema.nodes.text:i.type;if(!(n=n.matchType(u)))return!1;if(!t.type.allowsMarks(i.marks))return!1}return n.validEnd}(t,e))}function re(t,e,n){void 0===n&&(n=-1);for(var r=t.resolve(e),o=r.depth;;o--){var i=void 0,u=void 0,s=r.index(o);if(o==r.depth?(i=r.nodeBefore,u=r.nodeAfter):n>0?(i=r.node(o+1),s++,u=r.node(o).maybeChild(s)):(i=r.node(o).maybeChild(s-1),u=r.node(o+1)),i&&!i.isTextblock&&ne(i,u)&&r.node(o).canReplace(s,s+1))return e;if(0==o)break;e=n<0?r.before(o):r.after(o)}}function oe(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var u=1;u<=(0==n.openStart&&n.size?2:1);u++)for(var s=r.depth;s>=0;s--){var a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,c=r.index(s)+(a>0?1:0),l=r.node(s),d=!1;if(1==u)d=l.canReplace(c,c,o);else{var f=l.contentMatchAt(c).findWrapping(o.firstChild.type);d=f&&l.canReplaceWith(c,c,f[0])}if(d)return 0==a?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function ie(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=S.empty),e==n&&!r.size)return null;var o=t.resolve(e),i=t.resolve(n);return ue(o,i,r)?new qt(e,n,r):new se(o,i,r).fit()}function ue(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}Pt.jsonID("replaceAround",Wt);var se=function(){function t(t,e,n){this.$from=t,this.$to=e,this.unplaced=n,this.frontier=[],this.placed=E.empty;for(var r=0;r<=t.depth;r++){var o=t.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(r))})}for(var i=t.depth;i>0;i--)this.placed=E.from(t.node(i).copy(this.placed))}var e=t.prototype;return e.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;for(var i=this.placed,u=r.depth,s=o.depth;u&&s&&1==i.childCount;)i=i.firstChild.content,u--,s--;var a=new S(i,u,s);return e>-1?new Wt(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new qt(r.pos,o.pos,a):null},e.findFittable=function(){for(var t=this.unplaced.openStart,e=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<t;n++){var o=e.firstChild;if(e.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){t=n;break}e=o.content}for(var i=1;i<=2;i++)for(var u=1==i?t:this.unplaced.openStart;u>=0;u--)for(var s=null,a=(u?(s=le(this.unplaced.content,u-1).firstChild).content:this.unplaced.content).firstChild,c=this.depth;c>=0;c--){var l=this.frontier[c],d=l.type,f=l.match,h=void 0,p=null;if(1==i&&(a?f.matchType(a.type)||(p=f.fillBefore(E.from(a),!1)):s&&d.compatibleContent(s.type)))return{sliceDepth:u,frontierDepth:c,parent:s,inject:p};if(2==i&&a&&(h=f.findWrapping(a.type)))return{sliceDepth:u,frontierDepth:c,parent:s,wrap:h};if(s&&f.matchType(s.type))break}},e.openMore=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=le(e,n);return!(!o.childCount||o.firstChild.isLeaf||(this.unplaced=new S(e,n+1,Math.max(r,o.size+n>=e.size-r?n+1:0)),0))},e.dropNode=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=le(e,n);if(o.childCount<=1&&n>0){var i=e.size-n<=n+o.size;this.unplaced=new S(ae(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new S(ae(e,n,1),n,r)},e.placeNodes=function(t){for(var e=t.sliceDepth,n=t.frontierDepth,r=t.parent,o=t.inject,i=t.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var u=0;u<i.length;u++)this.openFrontierNode(i[u]);var s=this.unplaced,a=r?r.content:s.content,c=s.openStart-e,l=0,d=[],f=this.frontier[n],h=f.match,p=f.type;if(o){for(var m=0;m<o.childCount;m++)d.push(o.child(m));h=h.matchFragment(o)}for(var D=a.size+e-(s.content.size-s.openEnd);l<a.childCount;){var v=a.child(l),g=h.matchType(v.type);if(!g)break;(++l>1||0==c||v.content.size)&&(h=g,d.push(de(v.mark(p.allowedMarks(v.marks)),1==l?c:0,l==a.childCount?D:-1)))}var F=l==a.childCount;F||(D=-1),this.placed=ce(this.placed,n,E.from(d)),this.frontier[n].match=h,F&&D<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var y=0,C=a;y<D;y++){var k=C.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),C=k.content}this.unplaced=F?0==e?S.empty:new S(ae(s.content,e-1,1),e-1,D<0?s.openEnd:e-1):new S(ae(s.content,e,l),s.openStart,s.openEnd)},e.mustMoveInline=function(){if(!this.$to.parent.isTextblock)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!fe(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},e.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);e>=0;e--){var n=this.frontier[e],r=n.match,o=n.type,i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),u=fe(t,e,o,r,i);if(u){for(var s=e-1;s>=0;s--){var a=this.frontier[s],c=a.match,l=fe(t,s,a.type,c,!0);if(!l||l.childCount)continue t}return{depth:e,fit:u,move:i?t.doc.resolve(t.after(e+1)):t}}}},e.close=function(t){var e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=ce(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t},e.openFrontierNode=function(t,e,n){void 0===e&&(e=null);var r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=ce(this.placed,this.depth,E.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})},e.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(E.empty,!0);t.childCount&&(this.placed=ce(this.placed,this.frontier.length,t))},f(t,[{key:"depth",get:function(){return this.frontier.length-1}}])}();function ae(t,e,n){return 0==e?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(ae(t.firstChild.content,e-1,n)))}function ce(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(ce(t.lastChild.content,e-1,n)))}function le(t,e){for(var n=0;n<e;n++)t=t.firstChild.content;return t}function de(t,e,n){if(e<=0)return t;var r=t.content;return e>1&&(r=r.replaceChild(0,de(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(E.empty,!0)))),t.copy(r)}function fe(t,e,n,r,o){var i=t.node(e),u=o?t.indexAfter(e):t.index(e);if(u==i.childCount&&!n.compatibleContent(i.type))return null;var s=r.fillBefore(i.content,!0,u);return s&&!function(t,e,n){for(var r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,u)?s:null}function he(t){return t.spec.defining||t.spec.definingForContent}function pe(t,e,n,r,o){if(e<n){var i=t.firstChild;t=t.replaceChild(0,i.copy(pe(i.content,e+1,n,r,i)))}if(e>r){var u=o.contentMatchAt(0),s=u.fillBefore(t).append(t);t=s.append(u.matchFragment(s).fillBefore(E.empty,!0))}return t}function me(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(o==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==o-1)&&n.push(r)}return n}var De=function(t){function e(e,n,r){var o;return(o=t.call(this)||this).pos=e,o.attr=n,o.value=r,o}a(e,t);var n=e.prototype;return n.apply=function(t){var e=t.nodeAt(this.pos);if(!e)return zt.fail("No node at attribute step's position");var n=Object.create(null);for(var r in e.attrs)n[r]=e.attrs[r];n[this.attr]=this.value;var o=e.type.create(n,null,e.marks);return zt.fromReplace(t,this.pos,this.pos+1,new S(E.from(o),0,e.isLeaf?0:1))},n.getMap=function(){return Rt.empty},n.invert=function(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])},n.map=function(t){var n=t.mapResult(this.pos,1);return n.deletedAfter?null:new e(n.pos,this.attr,this.value)},n.toJSON=function(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}},e.fromJSON=function(t,n){if("number"!=typeof n.pos||"string"!=typeof n.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new e(n.pos,n.attr,n.value)},e}(Pt);Pt.jsonID("attr",De);var ve=function(t){function e(e,n){var r;return(r=t.call(this)||this).attr=e,r.value=n,r}a(e,t);var n=e.prototype;return n.apply=function(t){var e=Object.create(null);for(var n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;var r=t.type.create(e,t.content,t.marks);return zt.ok(r)},n.getMap=function(){return Rt.empty},n.invert=function(t){return new e(this.attr,t.attrs[this.attr])},n.map=function(t){return this},n.toJSON=function(){return{stepType:"docAttr",attr:this.attr,value:this.value}},e.fromJSON=function(t,n){if("string"!=typeof n.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new e(n.attr,n.value)},e}(Pt);Pt.jsonID("docAttr",ve);var ge=Error;((ge=function t(e){var n=Error.call(this,e);return n.__proto__=t.prototype,n}).prototype=Object.create(Error.prototype)).constructor=ge,ge.prototype.name="TransformError";var Fe=function(){function t(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new It}var e=t.prototype;return e.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new ge(e.failed);return this},e.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},e.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},e.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=S.empty);var r=ie(this.doc,t,e,n);return r&&this.step(r),this},e.replaceWith=function(t,e,n){return this.replace(t,e,new S(E.from(n),0,0))},e.delete=function(t,e){return this.replace(t,e,S.empty)},e.insert=function(t,e){return this.replaceWith(t,t,e)},e.replaceRange=function(t,e,n){return function(t,e,n,r){if(!r.size)return t.deleteRange(e,n);var o=t.doc.resolve(e),i=t.doc.resolve(n);if(ue(o,i,r))return t.step(new qt(e,n,r));var u=me(o,i);0==u[u.length-1]&&u.pop();var s=-(o.depth+1);u.unshift(s);for(var a=o.depth,c=o.pos-1;a>0;a--,c--){var l=o.node(a).type.spec;if(l.defining||l.definingAsContext||l.isolating)break;u.indexOf(a)>-1?s=a:o.before(a)==c&&u.splice(1,0,-a)}for(var d=u.indexOf(s),f=[],h=r.openStart,p=r.content,m=0;;m++){var D=p.firstChild;if(f.push(D),m==r.openStart)break;p=D.content}for(var v=h-1;v>=0;v--){var g=f[v],F=he(g.type);if(F&&!g.sameMarkup(o.node(Math.abs(s)-1)))h=v;else if(F||!g.type.isTextblock)break}for(var y=r.openStart;y>=0;y--){var C=(y+h+1)%(r.openStart+1),k=f[C];if(k)for(var E=0;E<u.length;E++){var A=u[(E+d)%u.length],b=!0;A<0&&(b=!1,A=-A);var w=o.node(A-1),x=o.index(A-1);if(w.canReplaceWith(x,x,k.type,k.marks))return t.replace(o.before(A),b?i.after(A):n,new S(pe(r.content,0,r.openStart,C),C,r.openEnd))}}for(var B=t.steps.length,M=u.length-1;M>=0&&(t.replace(e,n,r),!(t.steps.length>B));M--){var T=u[M];T<0||(e=o.before(T),n=i.after(T))}}(this,t,e,n),this},e.replaceRangeWith=function(t,e,n){return function(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){var o=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var u=r.depth-1;u>=0;u--){var s=r.indexAfter(u);if(r.node(u).canReplaceWith(s,s,n))return r.after(u+1);if(s<r.node(u).childCount)return null}return null}(t.doc,e,r.type);null!=o&&(e=n=o)}t.replaceRange(e,n,new S(E.from(r),0,0))}(this,t,e,n),this},e.deleteRange=function(t,e){return function(t,e,n){for(var r=t.doc.resolve(e),o=t.doc.resolve(n),i=me(r,o),u=0;u<i.length;u++){var s=i[u],a=u==i.length-1;if(a&&0==s||r.node(s).type.contentMatch.validEnd)return t.delete(r.start(s),o.end(s));if(s>0&&(a||r.node(s-1).canReplace(r.index(s-1),o.indexAfter(s-1))))return t.delete(r.before(s),o.after(s))}for(var c=1;c<=r.depth&&c<=o.depth;c++)if(e-r.start(c)==r.depth-c&&n>r.end(c)&&o.end(c)-n!=o.depth-c&&r.start(c-1)==o.start(c-1)&&r.node(c-1).canReplace(r.index(c-1),o.index(c-1)))return t.delete(r.before(c),n);t.delete(e,n)}(this,t,e),this},e.lift=function(t,e){return function(t,e,n){for(var r=e.$from,o=e.$to,i=e.depth,u=r.before(i+1),s=o.after(i+1),a=u,c=s,l=E.empty,d=0,f=i,h=!1;f>n;f--)h||r.index(f)>0?(h=!0,l=E.from(r.node(f).copy(l)),d++):a--;for(var p=E.empty,m=0,D=i,v=!1;D>n;D--)v||o.after(D+1)<o.end(D)?(v=!0,p=E.from(o.node(D).copy(p)),m++):c++;t.step(new Wt(a,c,u,s,new S(l.append(p),d,m),l.size-d,!0))}(this,t,e),this},e.join=function(t,e){return void 0===e&&(e=1),function(t,e,n){var r=null,o=t.doc.type.schema.linebreakReplacement,i=t.doc.resolve(e-n),u=i.node().type;if(o&&u.inlineContent){var s="pre"==u.whitespace,a=!!u.contentMatch.matchType(o);s&&!a?r=!1:!s&&a&&(r=!0)}var c=t.steps.length;if(!1===r){var l=t.doc.resolve(e+n);Yt(t,l.node(),l.before(),c)}u.inlineContent&&Ut(t,e+n-1,u,i.node().contentMatchAt(i.index()),null==r);var d=t.mapping.slice(c),f=d.map(e-n);if(t.step(new qt(f,d.map(e+n,-1),S.empty,!0)),!0===r){var h=t.doc.resolve(f);Xt(t,h.node(),h.before(),t.steps.length)}}(this,t,e),this},e.wrap=function(t,e){return function(t,e,n){for(var r=E.empty,o=n.length-1;o>=0;o--){if(r.size){var i=n[o].type.contentMatch.matchFragment(r);if(!i||!i.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=E.from(n[o].type.create(n[o].attrs,r))}var u=e.start,s=e.end;t.step(new Wt(u,s,u,s,new S(r,0,0),n.length,!0))}(this,t,e),this},e.setBlockType=function(t,e,n,r){return void 0===e&&(e=t),void 0===r&&(r=null),function(t,e,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=t.steps.length;t.doc.nodesBetween(e,n,function(e,n){var u="function"==typeof o?o(e):o;if(e.isTextblock&&!e.hasMarkup(r,u)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(t.doc,t.mapping.slice(i).map(n),r)){var s=null;if(r.schema.linebreakReplacement){var a="pre"==r.whitespace,c=!!r.contentMatch.matchType(r.schema.linebreakReplacement);a&&!c?s=!1:!a&&c&&(s=!0)}!1===s&&Yt(t,e,n,i),Ut(t,t.mapping.slice(i).map(n,1),r,void 0,null===s);var l=t.mapping.slice(i),d=l.map(n,1),f=l.map(n+e.nodeSize,1);return t.step(new Wt(d,f,d+1,f-1,new S(E.from(r.create(u,null,e.marks)),0,0),1,!0)),!0===s&&Xt(t,e,n,i),!1}})}(this,t,e,n,r),this},e.setNodeMarkup=function(t,e,n,r){return void 0===n&&(n=null),function(t,e,n,r,o){var i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);var u=n.create(r,null,o||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,u);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Wt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new S(E.from(u),0,0),1,!0))}(this,t,e,n,r),this},e.setNodeAttribute=function(t,e,n){return this.step(new De(t,e,n)),this},e.setDocAttribute=function(t,e){return this.step(new ve(t,e)),this},e.addNodeMark=function(t,e){return this.step(new Vt(t,e)),this},e.removeNodeMark=function(t,e){var n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(e instanceof x)e.isInSet(n.marks)&&this.step(new _t(t,e));else{for(var r,o=n.marks,i=[];r=e.isInSet(o);)i.push(new _t(t,r)),o=r.removeFromSet(o);for(var u=i.length-1;u>=0;u--)this.step(i[u])}return this},e.split=function(t,e,n){return void 0===e&&(e=1),function(t,e,n,r){void 0===n&&(n=1);for(var o=t.doc.resolve(e),i=E.empty,u=E.empty,s=o.depth,a=o.depth-n,c=n-1;s>a;s--,c--){i=E.from(o.node(s).copy(i));var l=r&&r[c];u=E.from(l?l.type.create(l.attrs,u):o.node(s).copy(u))}t.step(new qt(e,e,new S(i.append(u),n,n),!0))}(this,t,e,n),this},e.addMark=function(t,e,n){return function(t,e,n,r){var o,i,u=[],s=[];t.doc.nodesBetween(e,n,function(t,a,c){if(t.isInline){var l=t.marks;if(!r.isInSet(l)&&c.type.allowsMarkType(r.type)){for(var d=Math.max(a,e),f=Math.min(a+t.nodeSize,n),h=r.addToSet(l),p=0;p<l.length;p++)l[p].isInSet(h)||(o&&o.to==d&&o.mark.eq(l[p])?o.to=f:u.push(o=new Ht(d,f,l[p])));i&&i.to==d?i.to=f:s.push(i=new jt(d,f,r))}}}),u.forEach(function(e){return t.step(e)}),s.forEach(function(e){return t.step(e)})}(this,t,e,n),this},e.removeMark=function(t,e,n){return function(t,e,n,r){var o=[],i=0;t.doc.nodesBetween(e,n,function(t,u){if(t.isInline){i++;var s=null;if(r instanceof ft)for(var a,c=t.marks;a=r.isInSet(c);)(s||(s=[])).push(a),c=a.removeFromSet(c);else r?r.isInSet(t.marks)&&(s=[r]):s=t.marks;if(s&&s.length)for(var l=Math.min(u+t.nodeSize,n),d=0;d<s.length;d++){for(var f=s[d],h=void 0,p=0;p<o.length;p++){var m=o[p];m.step==i-1&&f.eq(o[p].style)&&(h=m)}h?(h.to=l,h.step=i):o.push({style:f,from:Math.max(u,e),to:l,step:i})}}}),o.forEach(function(e){return t.step(new Ht(e.from,e.to,e.style))})}(this,t,e,n),this},e.clearIncompatible=function(t,e,n){return Ut(this,t,e,n),this},f(t,[{key:"before",get:function(){return this.docs.length?this.docs[0]:this.doc}},{key:"docChanged",get:function(){return this.steps.length>0}}])}(),ye=Object.create(null),Ce=function(){function t(t,e,n){this.$anchor=t,this.$head=e,this.ranges=n||[new ke(t.min(e),t.max(e))]}var e=t.prototype;return e.content=function(){return this.$from.doc.slice(this.from,this.to,!0)},e.replace=function(t,e){void 0===e&&(e=S.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,u=this.ranges,s=0;s<u.length;s++){var a=u[s],c=a.$from,l=a.$to,d=t.mapping.slice(i);t.replaceRange(d.map(c.pos),d.map(l.pos),s?S.empty:e),0==s&&Oe(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},e.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],u=i.$from,s=i.$to,a=t.mapping.slice(n),c=a.map(u.pos),l=a.map(s.pos);o?t.deleteRange(c,l):(t.replaceRangeWith(c,l,e),Oe(t,n,e.isInline?-1:1))}},t.findFrom=function(t,e,n){void 0===n&&(n=!1);var r=t.parent.inlineContent?new be(t):Te(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Te(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Te(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}return null},t.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Se(t.node(0))},t.atStart=function(t){return Te(t,t,0,0,1)||new Se(t)},t.atEnd=function(t){return Te(t,t,t.content.size,t.childCount,-1)||new Se(t)},t.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=ye[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},t.jsonID=function(t,e){if(t in ye)throw new RangeError("Duplicate use of selection JSON ID "+t);return ye[t]=e,e.prototype.jsonID=t,e},e.getBookmark=function(){return be.between(this.$anchor,this.$head).getBookmark()},f(t,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}}])}();Ce.prototype.visible=!0;var ke=function(t,e){this.$from=t,this.$to=e},Ee=!1;function Ae(t){Ee||t.parent.inlineContent||(Ee=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}var be=function(t){function e(e,n){return void 0===n&&(n=e),Ae(e),Ae(n),t.call(this,e,n)||this}a(e,t);var n=e.prototype;return n.map=function(t,n){var r=t.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ce.near(r);var o=t.resolve(n.map(this.anchor));return new e(o.parent.inlineContent?o:r,r)},n.replace=function(e,n){if(void 0===n&&(n=S.empty),t.prototype.replace.call(this,e,n),n==S.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},n.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},n.getBookmark=function(){return new we(this.anchor,this.head)},n.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(t,n,r){var o=t.pos-n.pos;if(r&&!o||(r=o>=0?1:-1),!n.parent.inlineContent){var i=Ce.findFrom(n,r,!0)||Ce.findFrom(n,-r,!0);if(!i)return Ce.near(n,r);n=i.$head}return t.parent.inlineContent||(0==o||(t=(Ce.findFrom(t,-r,!0)||Ce.findFrom(t,r,!0)).$anchor).pos<n.pos!=o<0)&&(t=n),new e(t,n)},f(e,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}}])}(Ce);Ce.jsonID("text",be);var we=function(){function t(t,e){this.anchor=t,this.head=e}var e=t.prototype;return e.map=function(e){return new t(e.map(this.anchor),e.map(this.head))},e.resolve=function(t){return be.between(t.resolve(this.anchor),t.resolve(this.head))},t}(),xe=function(t){function e(e){var n,r=e.nodeAfter,o=e.node(0).resolve(e.pos+r.nodeSize);return(n=t.call(this,e,o)||this).node=r,n}a(e,t);var n=e.prototype;return n.map=function(t,n){var r=n.mapResult(this.anchor),o=r.deleted,i=r.pos,u=t.resolve(i);return o?Ce.near(u):new e(u)},n.content=function(){return new S(E.from(this.node),0,0)},n.eq=function(t){return t instanceof e&&t.anchor==this.anchor},n.toJSON=function(){return{type:"node",anchor:this.anchor}},n.getBookmark=function(){return new Be(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,n){return new e(t.resolve(n))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(Ce);xe.prototype.visible=!1,Ce.jsonID("node",xe);var Be=function(){function t(t){this.anchor=t}var e=t.prototype;return e.map=function(e){var n=e.mapResult(this.anchor),r=n.deleted,o=n.pos;return r?new we(o,o):new t(o)},e.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&xe.isSelectable(n)?new xe(e):Ce.near(e)},t}(),Se=function(t){function e(e){return t.call(this,e.resolve(0),e.resolve(e.content.size))||this}a(e,t);var n=e.prototype;return n.replace=function(e,n){if(void 0===n&&(n=S.empty),n==S.empty){e.delete(0,e.doc.content.size);var r=Ce.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},n.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},n.map=function(t){return new e(t)},n.eq=function(t){return t instanceof e},n.getBookmark=function(){return Me},e}(Ce);Ce.jsonID("all",Se);var Me={map:function(){return this},resolve:function(t){return new Se(t)}};function Te(t,e,n,r,o,i){if(void 0===i&&(i=!1),e.inlineContent)return be.create(t,n);for(var u=r-(o>0?0:1);o>0?u<e.childCount:u>=0;u+=o){var s=e.child(u);if(s.isAtom){if(!i&&xe.isSelectable(s))return xe.create(t,n-(o<0?s.nodeSize:0))}else{var a=Te(t,s,n+o,o<0?s.childCount:0,o,i);if(a)return a}n+=s.nodeSize*o}return null}function Oe(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];(i instanceof qt||i instanceof Wt)&&(t.mapping.maps[r].forEach(function(t,e,n,r){null==o&&(o=r)}),t.setSelection(Ce.near(t.doc.resolve(o),n)))}}var Ne=function(t){function e(e){var n;return(n=t.call(this,e.doc)||this).curSelectionFor=0,n.updated=0,n.meta=Object.create(null),n.time=Date.now(),n.curSelection=e.selection,n.storedMarks=e.storedMarks,n}a(e,t);var n=e.prototype;return n.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this},n.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},n.ensureMarks=function(t){return x.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},n.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},n.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},n.setTime=function(t){return this.time=t,this},n.replaceSelection=function(t){return this.selection.replace(this,t),this},n.replaceSelectionWith=function(t,e){void 0===e&&(e=!0);var n=this.selection;return e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||x.none))),n.replaceWith(this,t),this},n.deleteSelection=function(){return this.selection.replace(this),this},n.insertText=function(t,e,n){var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(null==n&&(n=e),!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.selection.to!=e+t.length||this.setSelection(Ce.near(this.selection.$to)),this},n.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},n.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.scrollIntoView=function(){return this.updated|=4,this},f(e,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"selectionSet",get:function(){return(1&this.updated)>0}},{key:"storedMarksSet",get:function(){return(2&this.updated)>0}},{key:"isGeneric",get:function(){for(var t in this.meta)return!1;return!0}},{key:"scrolledIntoView",get:function(){return(4&this.updated)>0}}])}(Fe);function Re(t,e){return e&&t?t.bind(e):t}var Ie=function(t,e,n){this.name=t,this.init=Re(e.init,n),this.apply=Re(e.apply,n)},Le=[new Ie("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Ie("selection",{init:function(t,e){return t.selection||Ce.atStart(e.doc)},apply:function(t){return t.selection}}),new Ie("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Ie("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Pe=function(t,e){var n=this;this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Le.slice(),e&&e.forEach(function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Ie(t.key,t.spec.state,t))})},ze=function(){function t(t){this.config=t}var e=t.prototype;return e.apply=function(t){return this.applyTransaction(t).state},e.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},e.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var u=this.config.plugins[i];if(u.spec.appendTransaction){var s=r?r[i].n:0,a=r?r[i].state:this,c=s<e.length&&u.spec.appendTransaction.call(u,s?e.slice(s):e,a,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},e.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new t(this.config),r=this.config.fields,o=0;o<r.length;o++){var i=r[o];n[i.name]=i.apply(e,this[i.name],this,n)}return n},t.create=function(e){for(var n=new Pe(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new t(n),o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(e,r);return r},e.reconfigure=function(e){for(var n=new Pe(this.schema,e.plugins),r=n.fields,o=new t(n),i=0;i<r.length;i++){var u=r[i].name;o[u]=this.hasOwnProperty(u)?this[u]:r[i].init(e,o)}return o},e.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(function(t){return t.toJSON()})),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},t.fromJSON=function(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var o=new Pe(e.schema,e.plugins),i=new t(o);return o.fields.forEach(function(t){if("doc"==t.name)i.doc=U.fromJSON(e.schema,n.doc);else if("selection"==t.name)i.selection=Ce.fromJSON(i.doc,n.selection);else if("storedMarks"==t.name)n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(var o in r){var u=r[o],s=u.spec.state;if(u.key==t.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(n,o))return void(i[t.name]=s.fromJSON.call(u,e,n[o],i))}i[t.name]=t.init(e,i)}}),i},f(t,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"tr",get:function(){return new Ne(this)}}])}();function $e(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=$e(o,e,{})),n[r]=o}return n}var je=function(){function t(t){this.spec=t,this.props={},t.props&&$e(t.props,this,this.props),this.key=t.key?t.key.key:Ve("plugin")}return t.prototype.getState=function(t){return t[this.key]},t}(),He=Object.create(null);function Ve(t){return t in He?t+"$"+ ++He[t]:(He[t]=0,t+"$")}var _e=function(){function t(t){void 0===t&&(t="key"),this.key=Ve(t)}var e=t.prototype;return e.get=function(t){return t.config.pluginsByKey[this.key]},e.getState=function(t){return t[this.key]},t}(),qe=function(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)};function We(t,e){var n=t.selection.$cursor;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}var Ke=function(t,e,n){var r=We(t,n);if(!r)return!1;var o=Ze(r);if(!o){var i=r.blockRange(),u=i&&Gt(i);return null!=u&&(e&&e(t.tr.lift(i,u).scrollIntoView()),!0)}var s=o.nodeBefore;if(sn(t,o,e,-1))return!0;if(0==r.parent.content.size&&(Je(s,"end")||xe.isSelectable(s)))for(var a=r.depth;;a--){var c=ie(t.doc,r.before(a),r.after(a),S.empty);if(c&&c.slice.size<c.to-c.from){if(e){var l=t.tr.step(c);l.setSelection(Je(s,"end")?Ce.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):xe.create(l.doc,o.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}if(1==a||r.node(a-1).childCount>1)break}return!(!s.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),0))};function Ue(t,e,n){for(var r=e.nodeBefore,o=e.pos-1;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;var i=r.lastChild;if(!i)return!1;r=i}for(var u=e.nodeAfter,s=e.pos+1;!u.isTextblock;s++){if(u.type.spec.isolating)return!1;var a=u.firstChild;if(!a)return!1;u=a}var c=ie(t.doc,o,s,S.empty);if(!c||c.from!=o||c instanceof qt&&c.slice.size>=s-o)return!1;if(n){var l=t.tr.step(c);l.setSelection(be.create(l.doc,o)),n(l.scrollIntoView())}return!0}function Je(t,e,n){void 0===n&&(n=!1);for(var r=t;r;r="start"==e?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}var Ge=function(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):o.parentOffset>0)return!1;i=Ze(o)}var u=i&&i.nodeBefore;return!(!u||!xe.isSelectable(u)||(e&&e(t.tr.setSelection(xe.create(t.doc,i.pos-u.nodeSize)).scrollIntoView()),0))};function Ze(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Qe(t,e){var n=t.selection.$cursor;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}var Xe=function(t,e,n){var r=Qe(t,n);if(!r)return!1;var o=tn(r);if(!o)return!1;var i=o.nodeAfter;if(sn(t,o,e,1))return!0;if(0==r.parent.content.size&&(Je(i,"start")||xe.isSelectable(i))){var u=ie(t.doc,r.before(),r.after(),S.empty);if(u&&u.slice.size<u.to-u.from){if(e){var s=t.tr.step(u);s.setSelection(Je(i,"start")?Ce.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):xe.create(s.doc,s.mapping.map(o.pos))),e(s.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),0))},Ye=function(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):o.parentOffset<o.parent.content.size)return!1;i=tn(o)}var u=i&&i.nodeAfter;return!(!u||!xe.isSelectable(u)||(e&&e(t.tr.setSelection(xe.create(t.doc,i.pos)).scrollIntoView()),0))};function tn(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}var en=function(t,e){var n=t.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o)||(e&&e(t.tr.insertText("\n").scrollIntoView()),0))};function nn(t){for(var e=0;e<t.edgeCount;e++){var n=t.edge(e).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}var rn=function(t,e){var n=t.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),u=r.indexAfter(-1),s=nn(i.contentMatchAt(u));if(!s||!i.canReplaceWith(u,u,s))return!1;if(e){var a=r.after(),c=t.tr.replaceWith(a,a,s.createAndFill());c.setSelection(Ce.near(c.doc.resolve(a),1)),e(c.scrollIntoView())}return!0},on=function(t,e){var n=t.selection,r=n.$from,o=n.$to;if(n instanceof Se||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=nn(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){var u=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=t.tr.insert(u,i.createAndFill());s.setSelection(be.create(s.doc,u+1)),e(s.scrollIntoView())}return!0},un=function(t,e){var n=t.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(te(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&Gt(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)};function sn(t,e,n,r){var o,i,u=e.nodeBefore,s=e.nodeAfter,a=u.type.spec.isolating||s.type.spec.isolating;if(!a&&function(t,e,n){var r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!o.isTextblock&&!ee(t.doc,e.pos)||(n&&n(t.tr.join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;var c=!a&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(i=u.contentMatchAt(u.childCount)).findWrapping(s.type))&&i.matchType(o[0]||s.type).validEnd){if(n){for(var l=e.pos+s.nodeSize,d=E.empty,f=o.length-1;f>=0;f--)d=E.from(o[f].create(null,d));d=E.from(u.copy(d));var h=t.tr.step(new Wt(e.pos-1,l,e.pos,l,new S(d,1,0),o.length,!0)),p=h.doc.resolve(l+2*o.length);p.nodeAfter&&p.nodeAfter.type==u.type&&ee(h.doc,p.pos)&&h.join(p.pos),n(h.scrollIntoView())}return!0}var m=s.type.spec.isolating||r>0&&a?null:Ce.findFrom(e,1),D=m&&m.$from.blockRange(m.$to),v=D&&Gt(D);if(null!=v&&v>=e.depth)return n&&n(t.tr.lift(D,v).scrollIntoView()),!0;if(c&&Je(s,"start",!0)&&Je(u,"end")){for(var g=u,F=[];F.push(g),!g.isTextblock;)g=g.lastChild;for(var y=s,C=1;!y.isTextblock;y=y.firstChild)C++;if(g.canReplace(g.childCount,g.childCount,y.content)){if(n){for(var k=E.empty,A=F.length-1;A>=0;A--)k=E.from(F[A].copy(k));n(t.tr.step(new Wt(e.pos-F.length,e.pos+s.nodeSize,e.pos+C,e.pos+s.nodeSize-C,new S(k,F.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function an(t){return function(e,n){for(var r=e.selection,o=t<0?r.$from:r.$to,i=o.depth;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(e.tr.setSelection(be.create(e.doc,t<0?o.start(i):o.end(i)))),!0)}}var cn=an(-1),ln=an(1);function dn(t,e){return void 0===e&&(e=null),function(n,r){for(var o=!1,i=0;i<n.selection.ranges.length&&!o;i++){var u=n.selection.ranges[i],s=u.$from.pos,a=u.$to.pos;n.doc.nodesBetween(s,a,function(r,i){if(o)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)o=!0;else{var u=n.doc.resolve(i),s=u.index();o=u.parent.canReplaceWith(s,s+1,t)}})}if(!o)return!1;if(r){for(var c=n.tr,l=0;l<n.selection.ranges.length;l++){var d=n.selection.ranges[l],f=d.$from.pos,h=d.$to.pos;c.setBlockType(f,h,t,e)}r(c.scrollIntoView())}return!0}}function fn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}var hn=fn(qe,Ke,Ge),pn=fn(qe,Xe,Ye),mn={Enter:fn(en,on,un,function(t,e){var n=t.selection,r=n.$from;n.$to;if(t.selection instanceof xe&&t.selection.node.isBlock)return!(!r.parentOffset||!te(t.doc,r.pos)||(e&&e(t.tr.split(r.pos).scrollIntoView()),0));if(!r.depth)return!1;for(var o,i,u=[],s=!1,a=!1,c=r.depth;;c--){if(r.node(c).isBlock){s=r.end(c)==r.pos+(r.depth-c),a=r.start(c)==r.pos-(r.depth-c),i=nn(r.node(c-1).contentMatchAt(r.indexAfter(c-1)));u.unshift(s&&i?{type:i}:null),o=c;break}if(1==c)return!1;u.unshift(null)}var l=t.tr;(t.selection instanceof be||t.selection instanceof Se)&&l.deleteSelection();var d=l.mapping.map(r.pos),f=te(l.doc,d,u.length,u);if(f||(u[0]=i?{type:i}:null,f=te(l.doc,d,u.length,u)),!f)return!1;if(l.split(d,u.length,u),!s&&a&&r.node(o).type!=i){var h=l.mapping.map(r.before(o)),p=l.doc.resolve(h);i&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,i)&&l.setNodeMarkup(l.mapping.map(r.before(o)),i)}return e&&e(l.scrollIntoView()),!0}),"Mod-Enter":rn,Backspace:hn,"Mod-Backspace":hn,"Shift-Backspace":hn,Delete:pn,"Mod-Delete":pn,"Mod-a":function(t,e){return e&&e(t.tr.setSelection(new Se(t.doc))),!0}},Dn={"Ctrl-h":mn.Backspace,"Alt-Backspace":mn["Mod-Backspace"],"Ctrl-d":mn.Delete,"Ctrl-Alt-Backspace":mn["Mod-Delete"],"Alt-Delete":mn["Mod-Delete"],"Alt-d":mn["Mod-Delete"],"Ctrl-a":cn,"Ctrl-e":ln};for(var vn in mn)Dn[vn]=mn[vn];function gn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Fn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Fn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();var yn=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Cn=function(t){var e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e},kn=null,En=function(t,e,n){var r=kn||(kn=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},An=function(t,e,n,r){return n&&(wn(t,e,n,r,-1)||wn(t,e,n,r,1))},bn=/^(img|br|input|textarea|hr)$/i;function wn(t,e,n,r,o){for(var i;;){if(t==n&&e==r)return!0;if(e==(o<0?0:xn(t))){var u=t.parentNode;if(!u||1!=u.nodeType||Bn(t)||bn.test(t.nodeName)||"false"==t.contentEditable)return!1;e=yn(t)+(o<0?0:1),t=u}else{if(1!=t.nodeType)return!1;var s=t.childNodes[e+(o<0?-1:0)];if(1==s.nodeType&&"false"==s.contentEditable){if(!(null===(i=s.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;e+=o}else t=s,e=o<0?xn(t):0}}}function xn(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Bn(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Sn=function(t){return t.focusNode&&An(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Mn(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}var Tn="undefined"!=typeof navigator?navigator:null,On="undefined"!=typeof document?document:null,Nn=Tn&&Tn.userAgent||"",Rn=/Edge\/(\d+)/.exec(Nn),In=/MSIE \d/.exec(Nn),Ln=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Nn),Pn=!!(In||Ln||Rn),zn=In?document.documentMode:Ln?+Ln[1]:Rn?+Rn[1]:0,$n=!Pn&&/gecko\/(\d+)/i.test(Nn);$n&&(/Firefox\/(\d+)/.exec(Nn)||[0,0])[1];var jn=!Pn&&/Chrome\/(\d+)/.exec(Nn),Hn=!!jn,Vn=jn?+jn[1]:0,_n=!Pn&&!!Tn&&/Apple Computer/.test(Tn.vendor),qn=_n&&(/Mobile\/\w+/.test(Nn)||!!Tn&&Tn.maxTouchPoints>2),Wn=qn||!!Tn&&/Mac/.test(Tn.platform),Kn=!!Tn&&/Win/.test(Tn.platform),Un=/Android \d/.test(Nn),Jn=!!On&&"webkitFontSmoothing"in On.documentElement.style,Gn=Jn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Zn(t){var e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Qn(t,e){return"number"==typeof t?t:t[e]}function Xn(t){var e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Yn(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,u=n||t.dom;u;)if(1==u.nodeType){var s=u,a=s==i.body,c=a?Zn(i):Xn(s),l=0,d=0;if(e.top<c.top+Qn(r,"top")?d=-(c.top-e.top+Qn(o,"top")):e.bottom>c.bottom-Qn(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Qn(o,"top")-c.top:e.bottom-c.bottom+Qn(o,"bottom")),e.left<c.left+Qn(r,"left")?l=-(c.left-e.left+Qn(o,"left")):e.right>c.right-Qn(r,"right")&&(l=e.right-c.right+Qn(o,"right")),l||d)if(a)i.defaultView.scrollBy(l,d);else{var f=s.scrollLeft,h=s.scrollTop;d&&(s.scrollTop+=d),l&&(s.scrollLeft+=l);var p=s.scrollLeft-f,m=s.scrollTop-h;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}var D=a?"fixed":getComputedStyle(u).position;if(/^(fixed|sticky)$/.test(D))break;u="absolute"==D?u.offsetParent:Cn(u)}else u=Cn(u)}function tr(t){for(var e=[],n=t.ownerDocument,r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Cn(r));return e}function er(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,u=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=u&&(o.scrollLeft=u)}}var nr=null;function rr(t,e){for(var n,r,o,i,u=2e8,s=0,a=e.top,c=e.top,l=t.firstChild,d=0;l;l=l.nextSibling,d++){var f=void 0;if(1==l.nodeType)f=l.getClientRects();else{if(3!=l.nodeType)continue;f=En(l).getClientRects()}for(var h=0;h<f.length;h++){var p=f[h];if(p.top<=a&&p.bottom>=c){a=Math.max(p.bottom,a),c=Math.min(p.top,c);var m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<u){n=l,u=m,r=m&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==l.nodeType&&m&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!o&&p.left<=e.left&&p.right>=e.left&&(o=l,i={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!n&&o&&(n=o,r=i,u=0),n&&3==n.nodeType?function(t,e){for(var n,r=t.nodeValue.length,o=document.createRange(),i=0;i<r;i++){o.setEnd(t,i+1),o.setStart(t,i);var u=ar(o,1);if(u.top!=u.bottom&&or(e,u)){n={node:t,offset:i+(e.left>=(u.left+u.right)/2?1:0)};break}}return o.detach(),n||{node:t,offset:0}}(n,r):!n||u&&1==n.nodeType?{node:t,offset:s}:rr(n,r)}function or(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function ir(t,e,n){var r=t.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var u=t.childNodes[i];if(1==u.nodeType)for(var s=u.getClientRects(),a=0;a<s.length;a++){var c=s[a];if(or(e,c))return ir(u,e,c)}if((i=(i+1)%r)==o)break}return t}function ur(t,e){var n,r=t.dom.ownerDocument,o=0,i=function(t,e,n){if(t.caretPositionFromPoint)try{var r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(xn(r.offsetNode),r.offset)}}catch(t){}if(t.caretRangeFromPoint){var o=t.caretRangeFromPoint(e,n);if(o)return{node:o.startContainer,offset:Math.min(xn(o.startContainer),o.startOffset)}}}(r,e.left,e.top);i&&(n=i.node,o=i.offset);var u,s=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top);if(!s||!t.dom.contains(1!=s.nodeType?s.parentNode:s)){var a=t.dom.getBoundingClientRect();if(!or(e,a))return null;if(!(s=ir(t.dom,e,a)))return null}if(_n)for(var c=s;n&&c;c=Cn(c))c.draggable&&(n=void 0);if(s=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(s,e),n){if($n&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length))<n.childNodes.length){var l,d=n.childNodes[o];"IMG"==d.nodeName&&(l=d.getBoundingClientRect()).right<=e.left&&l.bottom>e.top&&o++}var f;Jn&&o&&1==n.nodeType&&1==(f=n.childNodes[o-1]).nodeType&&"false"==f.contentEditable&&f.getBoundingClientRect().top>=e.top&&o--,n==t.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&e.top>n.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(u=function(t,e,n,r){for(var o=-1,i=e,u=!1;i!=t.dom;){var s=t.docView.nearestDesc(i,!0),a=void 0;if(!s)return null;if(1==s.dom.nodeType&&(s.node.isBlock&&s.parent||!s.contentDOM)&&((a=s.dom.getBoundingClientRect()).width||a.height)&&(s.node.isBlock&&s.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(s.dom.nodeName)&&(!u&&a.left>r.left||a.top>r.top?o=s.posBefore:(!u&&a.right<r.left||a.bottom<r.top)&&(o=s.posAfter),u=!0),!s.contentDOM&&o<0&&!s.node.isText))return(s.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?s.posBefore:s.posAfter;i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}(t,n,o,e))}null==u&&(u=function(t,e,n){var r=rr(e,n),o=r.node,i=r.offset,u=-1;if(1==o.nodeType&&!o.firstChild){var s=o.getBoundingClientRect();u=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(o,i,u)}(t,s,e));var h=t.docView.nearestDesc(s,!0);return{pos:u,inside:h?h.posAtStart-h.border:-1}}function sr(t){return t.top<t.bottom||t.left<t.right}function ar(t,e){var n=t.getClientRects();if(n.length){var r=n[e<0?0:n.length-1];if(sr(r))return r}return Array.prototype.find.call(n,sr)||t.getBoundingClientRect()}var cr=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function lr(t,e,n){var r=t.docView.domFromPos(e,n<0?-1:1),o=r.node,i=r.offset,u=r.atom,s=Jn||$n;if(3==o.nodeType){if(!s||!cr.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,l=n<0?1:-1;return n<0&&!i?(c++,l=-1):n>=0&&i==o.nodeValue.length?(a--,l=1):n<0?a--:c++,dr(ar(En(o,a,c),l),l<0)}var d=ar(En(o,i,i),n);if($n&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=ar(En(o,i-1,i-1),-1);if(f.top==d.top){var h=ar(En(o,i,i+1),-1);if(h.top!=d.top)return dr(h,h.left<f.left)}}return d}if(!t.state.doc.resolve(e-(u||0)).parent.inlineContent){if(null==u&&i&&(n<0||i==xn(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return fr(p.getBoundingClientRect(),!1)}if(null==u&&i<xn(o)){var m=o.childNodes[i];if(1==m.nodeType)return fr(m.getBoundingClientRect(),!0)}return fr(o.getBoundingClientRect(),n>=0)}if(null==u&&i&&(n<0||i==xn(o))){var D=o.childNodes[i-1],v=3==D.nodeType?En(D,xn(D)-(s?0:1)):1!=D.nodeType||"BR"==D.nodeName&&D.nextSibling?null:D;if(v)return dr(ar(v,1),!1)}if(null==u&&i<xn(o)){for(var g=o.childNodes[i];g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;var F=g?3==g.nodeType?En(g,0,s?0:1):1==g.nodeType?g:null:null;if(F)return dr(ar(F,-1),!0)}return dr(ar(3==o.nodeType?En(o):o,-n),n>=0)}function dr(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function fr(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function hr(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}var pr=/[\u0590-\u08ac]/,mr=null,Dr=null,vr=!1;var gr=function(){function t(t,e,n,r){this.parent=t,this.children=e,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}var e=t.prototype;return e.matchesWidget=function(t){return!1},e.matchesMark=function(t){return!1},e.matchesNode=function(t,e,n){return!1},e.matchesHack=function(t){return!1},e.parseRule=function(){return null},e.stopEvent=function(t){return!1},e.destroy=function(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},e.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},e.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,u;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(u=i.pmViewDesc)||u.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(u):this.posAtEnd}var s;if(t==this.dom&&this.contentDOM)s=e>yn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var a=t;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(null==s&&e==t.childNodes.length)for(var c=t;;c=c.parentNode){if(c==this.dom){s=!0;break}if(c.nextSibling)break}}return(null==s?n>0:s)?this.posAtEnd:this.posAtStart},e.nearestDesc=function(t,e){void 0===e&&(e=!1);for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r),i=void 0;if(o&&(!e||o.node)){if(!n||!(i=o.nodeDOM)||(1==i.nodeType?i.contains(1==t.nodeType?t:t.parentNode):i==t))return o;n=!1}}},e.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},e.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1},e.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)for(var i=0;i<r.children.length;i++){var u=r.children[i];if(u.size){r=u;break}}return r}if(t<o)return r.descAt(t-n-r.border);n=o}},e.domFromPos=function(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};for(var n,r=0,o=0,i=0;r<this.children.length;r++){var u=this.children[r],s=i+u.size;if(s>t||u instanceof br){o=t-i;break}i=s}if(o)return this.children[r].domFromPos(o-this.children[r].border,e);for(;r&&!(n=this.children[r-1]).size&&n instanceof Fr&&n.side>=0;r--);if(e<=0){for(var a,c=!0;(a=r?this.children[r-1]:null)&&a.dom.parentNode!=this.contentDOM;r--,c=!1);return a&&e&&c&&!a.border&&!a.domAtom?a.domFromPos(a.size,e):{node:this.contentDOM,offset:a?yn(a.dom)+1:0}}for(var l,d=!0;(l=r<this.children.length?this.children[r]:null)&&l.dom.parentNode!=this.contentDOM;r++,d=!1);return l&&d&&!l.border&&!l.domAtom?l.domFromPos(0,e):{node:this.contentDOM,offset:l?yn(l.dom):this.contentDOM.childNodes.length}},e.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,u=0;;u++){var s=this.children[u],a=i+s.size;if(-1==r&&t<=a){var c=i+s.border;if(t>=c&&e<=a-s.border&&s.node&&s.contentDOM&&this.contentDOM.contains(s.contentDOM))return s.parseRange(t,e,c);t=i;for(var l=u;l>0;l--){var d=this.children[l-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){r=yn(d.dom)+1;break}t-=d.size}-1==r&&(r=0)}if(r>-1&&(a>e||u==this.children.length-1)){e=a;for(var f=u+1;f<this.children.length;f++){var h=this.children[f];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){o=yn(h.dom);break}e+=h.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},e.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},e.domAfterPos=function(t){var e=this.domFromPos(t,0),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},e.setSelection=function(t,e,n,r){void 0===r&&(r=!1);for(var o=Math.min(t,e),i=Math.max(t,e),u=0,s=0;u<this.children.length;u++){var a=this.children[u],c=s+a.size;if(o>s&&i<c)return a.setSelection(t-s-a.border,e-s-a.border,n,r);s=c}var l=this.domFromPos(t,t?-1:1),d=e==t?l:this.domFromPos(e,e?-1:1),f=n.root.getSelection(),h=n.domSelectionRange(),p=!1;if(($n||_n)&&t==e){var m=l,D=m.node,v=m.offset;if(3==D.nodeType){if((p=!(!v||"\n"!=D.nodeValue[v-1]))&&v==D.nodeValue.length)for(var g,F=D;F;F=F.parentNode){if(g=F.nextSibling){"BR"==g.nodeName&&(l=d={node:g.parentNode,offset:yn(g)+1});break}var y=F.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var C=D.childNodes[v-1];p=C&&("BR"==C.nodeName||"false"==C.contentEditable)}}if($n&&h.focusNode&&h.focusNode!=d.node&&1==h.focusNode.nodeType){var k=h.focusNode.childNodes[h.focusOffset];k&&"false"==k.contentEditable&&(r=!0)}if(r||p&&_n||!An(l.node,l.offset,h.anchorNode,h.anchorOffset)||!An(d.node,d.offset,h.focusNode,h.focusOffset)){var E=!1;if((f.extend||t==e)&&(!p||!$n)){f.collapse(l.node,l.offset);try{t!=e&&f.extend(d.node,d.offset),E=!0}catch(t){}}if(!E){if(t>e){var A=l;l=d,d=A}var b=document.createRange();b.setEnd(d.node,d.offset),b.setStart(l.node,l.offset),f.removeAllRanges(),f.addRange(b)}}},e.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},e.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var u=n+o.border,s=i-o.border;if(t>=u&&e<=s)return this.dirty=t==n||e==i?2:1,void(t!=u||e!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-u,e-u):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2},e.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},e.isText=function(t){return!1},f(t,[{key:"size",get:function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t}},{key:"border",get:function(){return 0}},{key:"posBefore",get:function(){return this.parent.posBeforeChild(this)}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}},{key:"posAfter",get:function(){return this.posBefore+this.size}},{key:"posAtEnd",get:function(){return this.posAtStart+this.size-2*this.border}},{key:"contentLost",get:function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}},{key:"domAtom",get:function(){return!1}},{key:"ignoreForCoords",get:function(){return!1}},{key:"ignoreForSelection",get:function(){return!1}}])}(),Fr=function(t){function e(e,n,r,o){var i,u,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,function(){return u?u.parent?u.parent.posBeforeChild(u):void 0:o})),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}return(i=t.call(this,e,[],s,null)||this).widget=n,i.widget=n,u=i,i}a(e,t);var n=e.prototype;return n.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},n.parseRule=function(){return{ignore:!0}},n.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},n.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},n.destroy=function(){this.widget.type.destroy(this.dom),t.prototype.destroy.call(this)},f(e,[{key:"domAtom",get:function(){return!0}},{key:"ignoreForSelection",get:function(){return!!this.widget.type.spec.relaxedSide}},{key:"side",get:function(){return this.widget.type.side}}])}(gr),yr=function(t){function e(e,n,r,o){var i;return(i=t.call(this,e,[],n,null)||this).textDOM=r,i.text=o,i}a(e,t);var n=e.prototype;return n.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},n.domFromPos=function(t){return{node:this.textDOM,offset:t}},n.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},f(e,[{key:"size",get:function(){return this.text.length}}])}(gr),Cr=function(t){function e(e,n,r,o,i){var u;return(u=t.call(this,e,[],r,o)||this).mark=n,u.spec=i,u}a(e,t),e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],u=i&&i(n,o,r);return u&&u.dom||(u=bt.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new e(t,n,u.dom,u.contentDOM||u.dom,u)};var n=e.prototype;return n.parseRule=function(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},n.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},n.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},n.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,u=this.size;n<u&&(i=zr(i,n,u,r)),t>0&&(i=zr(i,0,t,r));for(var s=0;s<i.length;s++)i[s].parent=o;return o.children=i,o},n.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},n.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e}(gr),kr=function(t){function e(e,n,r,o,i,u,s,a,c){var l;return(l=t.call(this,e,[],i,u)||this).node=n,l.outerDeco=r,l.innerDeco=o,l.nodeDOM=s,l}a(e,t),e.create=function(t,n,r,o,i,u){var s,a=i.nodeViews[n.type.name],c=a&&a(n,i,function(){return s?s.parent?s.parent.posBeforeChild(s):void 0:u},r,o),l=c&&c.dom,d=c&&c.contentDOM;if(n.isText)if(l){if(3!=l.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else l=document.createTextNode(n.text);else if(!l){var f=bt.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs);l=f.dom,d=f.contentDOM}d||n.isText||"BR"==l.nodeName||(l.hasAttribute("contenteditable")||(l.contentEditable="false"),n.type.spec.draggable&&(l.draggable=!0));var h=l;return l=Nr(l,r,n),c?s=new wr(t,n,r,o,l,d||null,h,c,i,u+1):n.isText?new Ar(t,n,r,o,l,h,i):new e(t,n,r,o,l,d||null,h,i,u+1)};var n=e.prototype;return n.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(var n=this.children.length-1;n>=0;n--){var r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=function(){return E.empty})}else e.contentElement=this.contentDOM;else e.getContent=function(){return t.node.content};return e},n.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Rr(e,this.outerDeco)&&n.eq(this.innerDeco)},n.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=t.composing?this.localCompositionInfo(t,e):null,u=i&&i.pos>-1?i:null,s=i&&i.pos<0,a=new Lr(this,u&&u.node,t);!function(t,e,n,r){var o=e.locals(t),i=0;if(0!=o.length)for(var u=0,s=[],a=null,c=0;;){for(var l=void 0,d=void 0;u<o.length&&o[u].to==i;){var f=o[u++];f.widget&&(l?(d||(d=[l])).push(f):l=f)}if(l)if(d){d.sort(Pr);for(var h=0;h<d.length;h++)n(d[h],c,!!a)}else n(l,c,!!a);var p=void 0,m=void 0;if(a)m=-1,p=a,a=null;else{if(!(c<t.childCount))break;m=c,p=t.child(c++)}for(var D=0;D<s.length;D++)s[D].to<=i&&s.splice(D--,1);for(;u<o.length&&o[u].from<=i&&o[u].to>i;)s.push(o[u++]);var v=i+p.nodeSize;if(p.isText){var g=v;u<o.length&&o[u].from<g&&(g=o[u].from);for(var F=0;F<s.length;F++)s[F].to<g&&(g=s[F].to);g<v&&(a=p.cut(g-i),p=p.cut(0,g-i),v=g,m=-1)}else for(;u<o.length&&o[u].to<v;)u++;r(p,p.isInline&&!p.isLeaf?s.filter(function(t){return!t.inline}):s.slice(),e.forChild(i,p),m),i=v}else for(var y=0;y<t.childCount;y++){var C=t.child(y);r(C,o,e.forChild(i,C),y),i+=C.nodeSize}}(this.node,this.innerDeco,function(e,i,u){e.spec.marks?a.syncToMarks(e.spec.marks,r,t,i):e.type.side>=0&&!u&&a.syncToMarks(i==n.node.childCount?x.none:n.node.child(i).marks,r,t,i),a.placeWidget(e,t,o)},function(e,n,u,c){var l;a.syncToMarks(e.marks,r,t,c),a.findNodeMatch(e,n,u,c)||s&&t.state.selection.from>o&&t.state.selection.to<o+e.nodeSize&&(l=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(e,n,u,l,t)||a.updateNextNode(e,n,u,t,c,o)||a.addNode(e,n,u,t,o),o+=e.nodeSize}),a.syncToMarks([],r,t,0),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(u&&this.protectLocalComposition(t,u),xr(this.contentDOM,this.children,t),qn&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))},n.localCompositionInfo=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(t.state.selection instanceof be)||r<e||o>e+this.node.content.size)return null;var i=t.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){var u=i.nodeValue,s=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var u=t.child(o++),s=i;if(i+=u.nodeSize,u.isText){for(var a=u.text;o<t.childCount;){var c=t.child(o++);if(i+=c.nodeSize,!c.isText)break;a+=c.text}if(i>=n){if(i>=r&&a.slice(r-e.length-s,r-s)==e)return r-e.length;var l=s<r?a.lastIndexOf(e,r-s-1):-1;if(l>=0&&l+e.length+s>=n)return s+l;if(n==r&&a.length>=r+e.length-s&&a.slice(r-s,r-s+e.length)==e)return r}}}return-1}(this.node.content,u,r-e,o-e);return s<0?null:{node:i,pos:s,text:u}}return{node:i,pos:-1,text:""}},n.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}var u=new yr(this,i,n,o);t.input.compositionNodes.push(u),this.children=zr(this.children,r,r+o.length,t,u)}},n.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,n,r),0))},n.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},n.updateOuterDeco=function(t){if(!Rr(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Tr(this.dom,this.nodeDOM,Mr(this.outerDeco,this.node,e),Mr(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}},n.selectNode=function(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))},n.deselectNode=function(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))},f(e,[{key:"size",get:function(){return this.node.nodeSize}},{key:"border",get:function(){return this.node.isLeaf?0:1}},{key:"domAtom",get:function(){return this.node.isAtom}}])}(gr);function Er(t,e,n,r,o){Nr(r,e,t);var i=new kr(void 0,t,e,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}var Ar=function(t){function e(e,n,r,o,i,u,s){return t.call(this,e,n,r,o,i,null,u,s,0)||this}a(e,t);var n=e.prototype;return n.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},n.update=function(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,0))},n.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},n.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},n.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},n.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},n.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},n.markDirty=function(e,n){t.prototype.markDirty.call(this,e,n),this.dom==this.nodeDOM||0!=e&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.isText=function(t){return this.node.text==t},f(e,[{key:"domAtom",get:function(){return!1}}])}(kr),br=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.parseRule=function(){return{ignore:!0}},n.matchesHack=function(t){return 0==this.dirty&&this.dom.nodeName==t},f(e,[{key:"domAtom",get:function(){return!0}},{key:"ignoreForCoords",get:function(){return"IMG"==this.dom.nodeName}}])}(gr),wr=function(t){function e(e,n,r,o,i,u,s,a,c,l){var d;return(d=t.call(this,e,n,r,o,i,u,s,c,l)||this).spec=a,d}a(e,t);var n=e.prototype;return n.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){var i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},n.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},n.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},n.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r.root):t.prototype.setSelection.call(this,e,n,r,o)},n.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},n.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},n.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(kr);function xr(t,e,n){for(var r=t.firstChild,o=!1,i=0;i<e.length;i++){var u=e[i],s=u.dom;if(s.parentNode==t){for(;s!=r;)r=Ir(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(s,r);if(u instanceof Cr){var a=r?r.previousSibling:t.lastChild;xr(u.contentDOM,u.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=Ir(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}var Br=function(t){t&&(this.nodeName=t)};Br.prototype=Object.create(null);var Sr=[new Br];function Mr(t,e,n){if(0==t.length)return Sr;for(var r=n?Sr[0]:new Br,o=[r],i=0;i<t.length;i++){var u=t[i].type.attrs;if(u)for(var s in u.nodeName&&o.push(r=new Br(u.nodeName)),u){var a=u[s];null!=a&&(n&&1==o.length&&o.push(r=new Br(e.isInline?"span":"div")),"class"==s?r.class=(r.class?r.class+" ":"")+a:"style"==s?r.style=(r.style?r.style+";":"")+a:"nodeName"!=s&&(r[s]=a))}}return o}function Tr(t,e,n,r){if(n==Sr&&r==Sr)return e;for(var o=e,i=0;i<r.length;i++){var u=r[i],s=n[i];if(i){var a=void 0;s&&s.nodeName==u.nodeName&&o!=t&&(a=o.parentNode)&&a.nodeName.toLowerCase()==u.nodeName||((a=document.createElement(u.nodeName)).pmIsDeco=!0,a.appendChild(o),s=Sr[0]),o=a}Or(o,s||Sr[0],u)}return o}function Or(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" ").filter(Boolean):[],u=n.class?n.class.split(" ").filter(Boolean):[],s=0;s<i.length;s++)-1==u.indexOf(i[s])&&t.classList.remove(i[s]);for(var a=0;a<u.length;a++)-1==i.indexOf(u[a])&&t.classList.add(u[a]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style)for(var c,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;c=l.exec(e.style);)t.style.removeProperty(c[1]);n.style&&(t.style.cssText+=n.style)}}function Nr(t,e,n){return Tr(t,t,Sr,Mr(e,n,1!=t.nodeType))}function Rr(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Ir(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var Lr=function(){function t(t,e,n){this.lock=e,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(t,e){var n=e,r=n.children.length,o=t.childCount,i=new Map,u=[];t:for(;o>0;){for(var s=void 0;;)if(r){var a=n.children[r-1];if(!(a instanceof Cr)){s=a,r--;break}n=a,r=a.children.length}else{if(n==e)break t;r=n.parent.children.indexOf(n),n=n.parent}var c=s.node;if(c){if(c!=t.child(o-1))break;--o,i.set(s,o),u.push(s)}}return{index:o,matched:i,matches:u.reverse()}}(t.node.content,t)}var e=t.prototype;return e.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},e.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},e.syncToMarks=function(t,e,n,r){for(var o=0,i=this.stack.length>>1,u=Math.min(i,t.length);o<u&&(o==i-1?this.top:this.stack[o+1<<1]).matchesMark(t[o])&&!1!==t[o].type.spec.spanning;)o++;for(;o<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);var s=-1,a=this.top.children.length;r<this.preMatch.index&&(a=Math.min(this.index+3,a));for(var c=this.index;c<a;c++){var l=this.top.children[c];if(l.matchesMark(t[i])&&!this.isLocked(l.dom)){s=c;break}}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var d=Cr.create(this.top,t[i],e,n);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,i++}},e.findNodeMatch=function(t,e,n,r){var o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,n))i=this.top.children.indexOf(o,this.index);else for(var u=this.index,s=Math.min(this.top.children.length,u+5);u<s;u++){var a=this.top.children[u];if(a.matchesNode(t,e,n)&&!this.preMatch.matched.has(a)){i=u;break}}return!(i<0||(this.destroyBetween(this.index,i),this.index++,0))},e.updateNodeAt=function(t,e,n,r,o){var i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(t,e,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)},e.findIndexWithChild=function(t){for(;;){var e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){var n=t.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}t=e}},e.updateNextNode=function(t,e,n,r,o,i){for(var u=this.index;u<this.top.children.length;u++){var s=this.top.children[u];if(s instanceof kr){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var c=s.dom,l=void 0,d=this.isLocked(c)&&!(t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&3!=s.dirty&&Rr(e,s.outerDeco));if(!d&&s.update(t,e,n,r))return this.destroyBetween(this.index,u),s.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(l=this.recreateWrapper(s,t,e,n,r,i)))return this.destroyBetween(this.index,u),this.top.children[this.index]=l,l.contentDOM&&(l.dirty=2,l.updateChildren(r,i+1),l.dirty=0),this.changed=!0,this.index++,!0;break}}return!1},e.recreateWrapper=function(t,e,n,r,o,i){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!Rr(n,t.outerDeco)||!r.eq(t.innerDeco))return null;var u=kr.create(this.top,e,n,r,o,i);if(u.contentDOM){u.children=t.children,t.children=[];for(var s,a=gn(u.children);!(s=a()).done;)s.value.parent=u}return t.destroy(),u},e.addNode=function(t,e,n,r,o){var i=kr.create(this.top,t,e,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0},e.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){var o=new Fr(this.top,t,e,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},e.addTextblockHacks=function(){for(var t=this.top.children[this.index-1],e=this.top;t instanceof Cr;)t=(e=t).children[e.children.length-1];(!t||!(t instanceof Ar)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((_n||Hn)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))},e.addHackNode=function(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{var n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");var r=new br(this.top,[],n,null);e!=this.top?e.children.push(r):e.children.splice(this.index++,0,r),this.changed=!0}},e.isLocked=function(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))},t}();function Pr(t,e){return t.type.side-e.type.side}function zr(t,e,n,r,o){for(var i=[],u=0,s=0;u<t.length;u++){var a=t[u],c=s,l=s+=a.size;c>=n||l<=e?i.push(a):(c<e&&i.push(a.slice(0,e-c,r)),o&&(i.push(o),o=void 0),l>n&&i.push(a.slice(n-c,a.size,r)))}return i}function $r(t,e){void 0===e&&(e=null);var n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;var o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,u=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(u<0)return null;var s,a,c=r.resolve(u);if(Sn(n)){for(s=u;o&&!o.node;)o=o.parent;var l=o.node;if(o&&l.isAtom&&xe.isSelectable(l)&&o.parent&&(!l.isInline||!function(t,e,n){for(var r=0==e,o=e==xn(t);r||o;){if(t==n)return!0;var i=yn(t);if(!(t=t.parentNode))return!1;r=r&&0==i,o=o&&i==xn(t)}}(n.focusNode,n.focusOffset,o.dom))){var d=o.posBefore;a=new xe(u==d?c:r.resolve(d))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){for(var f=u,h=u,p=0;p<n.rangeCount;p++){var m=n.getRangeAt(p);f=Math.min(f,t.docView.posFromDOM(m.startContainer,m.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(f<0)return null;var D=h==t.state.selection.anchor?[h,f]:[f,h];s=D[0],u=D[1],c=r.resolve(u)}else s=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(s<0)return null}var v=r.resolve(s);return a||(a=Jr(t,v,c,"pointer"==e||t.state.selection.head<c.pos&&!i?1:-1)),a}function jr(t){return t.editable?t.hasFocus():Zr(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Hr(t,e){void 0===e&&(e=!1);var n=t.state.selection;if(Kr(t,n),jr(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Hn){var r=t.domSelectionRange(),o=t.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&An(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.domSelection();if(e){var n=t.cursorWrapper.dom,r="IMG"==n.nodeName;r?e.collapse(n.parentNode,yn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&Pn&&zn<=11&&(n.disabled=!0,n.disabled=!1)}}(t);else{var i,u,s=n.anchor,a=n.head;!Vr||n instanceof be||(n.$from.parent.inlineContent||(i=_r(t,n.from)),n.empty||n.$from.parent.inlineContent||(u=_r(t,n.to))),t.docView.setSelection(s,a,t,e),Vr&&(i&&Wr(i),u&&Wr(u)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);var n=t.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(function(){jr(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}var Vr=_n||Hn&&Vn<63;function _r(t,e){var n=t.docView.domFromPos(e,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,u=o?r.childNodes[o-1]:null;if(_n&&i&&"false"==i.contentEditable)return qr(i);if(!(i&&"false"!=i.contentEditable||u&&"false"!=u.contentEditable)){if(i)return qr(i);if(u)return qr(u)}}function qr(t){return t.contentEditable="true",_n&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Wr(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Kr(t,e){if(e instanceof xe){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Ur(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Ur(t)}function Ur(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Jr(t,e,n,r){return t.someProp("createSelectionBetween",function(r){return r(t,e,n)})||be.between(e,n,r)}function Gr(t){return!(t.editable&&!t.hasFocus())&&Zr(t)}function Zr(t){var e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function Qr(t,e){var n=t.selection,r=n.$anchor,o=n.$head,i=e>0?r.max(o):r.min(o),u=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return u&&Ce.findFrom(u,e)}function Xr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Yr(t,e,n){var r=t.state.selection;if(!(r instanceof be)){if(r instanceof xe&&r.node.isInline)return Xr(t,new be(e>0?r.$to:r.$from));var o=Qr(t.state,e);return!!o&&Xr(t,o)}if(n.indexOf("s")>-1){var i=r.$head,u=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!u||u.isText||!u.isLeaf)return!1;var s=t.state.doc.resolve(i.pos+u.nodeSize*(e<0?-1:1));return Xr(t,new be(r.$anchor,s))}if(!r.empty)return!1;if(t.endOfTextblock(e>0?"forward":"backward")){var a=Qr(t.state,e);return!!(a&&a instanceof xe)&&Xr(t,a)}if(!(Wn&&n.indexOf("m")>-1)){var c,l=r.$head,d=l.textOffset?null:e<0?l.nodeBefore:l.nodeAfter;if(!d||d.isText)return!1;var f=e<0?l.pos-d.nodeSize:l.pos;return!!(d.isAtom||(c=t.docView.descAt(f))&&!c.contentDOM)&&(xe.isSelectable(d)?Xr(t,new xe(e<0?t.state.doc.resolve(l.pos-d.nodeSize):l)):!!Jn&&Xr(t,new be(t.state.doc.resolve(e<0?f:f+d.nodeSize))))}}function to(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function eo(t,e){var n=t.pmViewDesc;return n&&0==n.size&&(e<0||t.nextSibling||"BR"!=t.nodeName)}function no(t,e){return e<0?function(t){var e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,u=!1;for($n&&1==n.nodeType&&r<to(n)&&eo(n.childNodes[r],-1)&&(u=!0);;)if(r>0){if(1!=n.nodeType)break;var s=n.childNodes[r-1];if(eo(s,-1))o=n,i=--r;else{if(3!=s.nodeType)break;r=(n=s).nodeValue.length}}else{if(ro(n))break;for(var a=n.previousSibling;a&&eo(a,-1);)o=n.parentNode,i=yn(a),a=a.previousSibling;if(a)r=to(n=a);else{if((n=n.parentNode)==t.dom)break;r=0}}u?oo(t,n,r):o&&oo(t,o,i)}}(t):function(t){var e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,u=to(n);;)if(r<u){if(1!=n.nodeType)break;if(!eo(n.childNodes[r],1))break;o=n,i=++r}else{if(ro(n))break;for(var s=n.nextSibling;s&&eo(s,1);)o=s.parentNode,i=yn(s)+1,s=s.nextSibling;if(s)r=0,u=to(n=s);else{if((n=n.parentNode)==t.dom)break;r=u=0}}o&&oo(t,o,i)}}(t)}function ro(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function oo(t,e,n){var r,o;3!=e.nodeType&&((o=function(t,e){for(;t&&e==t.childNodes.length&&!Bn(t);)e=yn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){var n=t.childNodes[e];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=n,e=0}}(e,n))?(e=o,n=0):(r=function(t,e){for(;t&&!e&&!Bn(t);)e=yn(t),t=t.parentNode;for(;t&&e;){var n=t.childNodes[e-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=(t=n).childNodes.length}}(e,n))&&(e=r,n=r.nodeValue.length));var i=t.domSelection();if(i){if(Sn(i)){var u=document.createRange();u.setEnd(e,n),u.setStart(e,n),i.removeAllRanges(),i.addRange(u)}else i.extend&&i.extend(e,n);t.domObserver.setCurSelection();var s=t.state;setTimeout(function(){t.state==s&&Hr(t)},50)}}function io(t,e){var n=t.state.doc.resolve(e);if(!Hn&&!Kn&&n.parent.inlineContent){var r=t.coordsAtPos(e);if(e>n.start()){var o=t.coordsAtPos(e-1),i=(o.top+o.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(o.left-r.left)>1)return o.left<r.left?"ltr":"rtl"}if(e<n.end()){var u=t.coordsAtPos(e+1),s=(u.top+u.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(u.left-r.left)>1)return u.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(t.dom).direction?"rtl":"ltr"}function uo(t,e,n){var r=t.state.selection;if(r instanceof be&&!r.empty||n.indexOf("s")>-1)return!1;if(Wn&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var u=Qr(t.state,e);if(u&&u instanceof xe)return Xr(t,u)}if(!o.parent.inlineContent){var s=e<0?o:i,a=r instanceof Se?Ce.near(s,e):Ce.findFrom(s,e);return!!a&&Xr(t,a)}return!1}function so(t,e){if(!(t.state.selection instanceof be))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var u=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(u&&!u.isText){var s=t.state.tr;return e<0?s.delete(r.pos-u.nodeSize,r.pos):s.delete(r.pos,r.pos+u.nodeSize),t.dispatch(s),!0}return!1}function ao(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function co(t,e){t.someProp("transformCopied",function(n){e=n(e,t)});for(var n=[],r=e,o=r.content,i=r.openStart,u=r.openEnd;i>1&&u>1&&1==o.childCount&&1==o.firstChild.childCount;){i--,u--;var s=o.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),o=s.content}var a=t.someProp("clipboardSerializer")||bt.fromSchema(t.state.schema),c=yo(),l=c.createElement("div");l.appendChild(a.serializeFragment(o,{document:c}));for(var d,f=l.firstChild,h=0;f&&1==f.nodeType&&(d=go[f.nodeName.toLowerCase()]);){for(var p=d.length-1;p>=0;p--){for(var m=c.createElement(d[p]);l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),h++}f=l.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",i+" "+u+(h?" -"+h:"")+" "+JSON.stringify(n)),{dom:l,text:t.someProp("clipboardTextSerializer",function(n){return n(e,t)})||e.content.textBetween(0,e.content.size,"\n\n"),slice:e}}function lo(t,e,n,r,o){var i,u,s=o.parent.type.spec.code;if(!n&&!e)return null;var a=!!e&&(r||s||!n);if(a){if(t.someProp("transformPastedText",function(n){e=n(e,s||r,t)}),s)return u=new S(E.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0),t.someProp("transformPasted",function(e){u=e(u,t,!0)}),u;var c=t.someProp("clipboardTextParser",function(n){return n(e,o,r,t)});if(c)u=c;else{var l=o.marks(),d=t.state.schema,f=bt.fromSchema(d);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(function(t){var e=i.appendChild(document.createElement("p"));t&&e.appendChild(f.serializeNode(d.text(t,l)))})}}else t.someProp("transformPastedHTML",function(e){n=e(n,t)}),i=function(t){var e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=yo().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(t);if((n=o&&go[o[1].toLowerCase()])&&(t=n.map(function(t){return"<"+t+">"}).join("")+t+n.map(function(t){return"</"+t+">"}).reverse().join("")),r.innerHTML=function(t){var e=window.trustedTypes;return e?(Co||(Co=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:function(t){return t}})),Co.createHTML(t)):t}(t),n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),Jn&&function(t){for(var e=t.querySelectorAll(Hn?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<e.length;n++){var r=e[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(i);var h=i&&i.querySelector("[data-pm-slice]"),p=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(p&&p[3])for(var m=+p[3];m>0;m--){for(var D=i.firstChild;D&&1!=D.nodeType;)D=D.nextSibling;if(!D)break;i=D}if(!u){var v=t.someProp("clipboardParser")||t.someProp("domParser")||mt.fromSchema(t.state.schema);u=v.parseSlice(i,{preserveWhitespace:!(!a&&!p),context:o,ruleFromNode:function(t){return"BR"!=t.nodeName||t.nextSibling||!t.parentNode||fo.test(t.parentNode.nodeName)?null:{ignore:!0}}})}if(p)u=function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var o=t.content,i=t.openStart,u=t.openEnd,s=n.length-2;s>=0;s-=2){var a=r.nodes[n[s]];if(!a||a.hasRequiredAttrs())break;o=E.from(a.create(n[s+1],o)),i++,u++}return new S(o,i,u)}(vo(u,+p[1],+p[2]),p[4]);else if(u=S.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n,r=function(){var n,r=e.node(o).contentMatchAt(e.index(o)),i=[];if(t.forEach(function(t){if(i){var e,o=r.findWrapping(t.type);if(!o)return i=null;if(e=i.length&&n.length&&po(o,n,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=mo(i[i.length-1],n.length));var u=ho(t,o);i.push(u),r=r.matchType(u.type),n=o}}}),i)return{v:E.from(i)}},o=e.depth;o>=0;o--)if(n=r())return n.v;return t}(u.content,o),!0),u.openStart||u.openEnd){for(var g=0,F=0,y=u.content.firstChild;g<u.openStart&&!y.type.spec.isolating;g++,y=y.firstChild);for(var C=u.content.lastChild;F<u.openEnd&&!C.type.spec.isolating;F++,C=C.lastChild);u=vo(u,g,F)}return t.someProp("transformPasted",function(e){u=e(u,t,a)}),u}var fo=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function ho(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,E.from(t));return t}function po(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){var i=po(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(E.from(ho(n,t,o+1))))}}function mo(t,e){if(0==e)return t;var n=t.content.replaceChild(t.childCount-1,mo(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(E.empty,!0);return t.copy(n.append(r))}function Do(t,e,n,r,o,i){var u=e<0?t.firstChild:t.lastChild,s=u.content;return t.childCount>1&&(i=0),o<r-1&&(s=Do(s,e,n,r,o+1,i)),o>=n&&(s=e<0?u.contentMatchAt(0).fillBefore(s,i<=o).append(s):s.append(u.contentMatchAt(u.childCount).fillBefore(E.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,u.copy(s))}function vo(t,e,n){return e<t.openStart&&(t=new S(Do(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new S(Do(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}var go={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Fo=null;function yo(){return Fo||(Fo=document.implementation.createHTMLDocument("title"))}var Co=null,ko={},Eo={},Ao={touchstart:!0,touchmove:!0},bo=function(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null};function wo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function xo(t){t.someProp("handleDOMEvents",function(e){for(var n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=function(e){return Bo(t,e)})})}function Bo(t,e){return t.someProp("handleDOMEvents",function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function So(t){return{left:t.clientX,top:t.clientY}}function Mo(t,e,n,r,o){if(-1==r)return!1;for(var i,u=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,function(e){return r>u.depth?e(t,n,u.nodeAfter,u.before(r),o,!0):e(t,n,u.node(r),u.before(r),o,!1)}))return{v:!0}},a=u.depth+1;a>0;a--)if(i=s(a))return i.v;return!1}function To(t,e,n){if(t.focused||t.focus(),!t.state.selection.eq(e)){var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}}function Oo(t,e,n,r){return Mo(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",function(n){return n(t,e,r)})}function No(t,e,n,r){return Mo(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",function(n){return n(t,e,r)})||function(t,e,n){if(0!=n.button)return!1;var r=t.state.doc;if(-1==e)return!!r.inlineContent&&(To(t,be.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(e),i=o.depth+1;i>0;i--){var u=i>o.depth?o.nodeAfter:o.node(i),s=o.before(i);if(u.inlineContent)To(t,be.create(r,s+1,s+1+u.content.size),"pointer");else{if(!xe.isSelectable(u))continue;To(t,xe.create(r,s),"pointer")}return!0}}(t,n,r)}function Ro(t){return Ho(t)}Eo.keydown=function(t,e){var n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!Po(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!Un||!Hn||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!qn||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",function(e){return e(t,n)})||function(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);if(8==n||Wn&&72==n&&"c"==r)return so(t,-1)||no(t,-1);if(46==n&&!e.shiftKey||Wn&&68==n&&"c"==r)return so(t,1)||no(t,1);if(13==n||27==n)return!0;if(37==n||Wn&&66==n&&"c"==r){var o=37==n?"ltr"==io(t,t.state.selection.from)?-1:1:-1;return Yr(t,o,r)||no(t,o)}if(39==n||Wn&&70==n&&"c"==r){var i=39==n?"ltr"==io(t,t.state.selection.from)?1:-1:1;return Yr(t,i,r)||no(t,i)}return 38==n||Wn&&80==n&&"c"==r?uo(t,-1,r)||no(t,-1):40==n||Wn&&78==n&&"c"==r?function(t){if(!_n||t.state.selection.$head.parentOffset>0)return!1;var e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;ao(t,o,"true"),setTimeout(function(){return ao(t,o,"false")},20)}return!1}(t)||uo(t,1,r)||no(t,1):r==(Wn?"m":"c")&&(66==n||73==n||89==n||90==n)}(t,n)?n.preventDefault():wo(t,"key");else{var r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(function(){t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",function(e){return e(t,Mn(13,"Enter"))}),t.input.lastIOSEnter=0)},200)}},Eo.keyup=function(t,e){16==e.keyCode&&(t.input.shiftKey=!1)},Eo.keypress=function(t,e){var n=e;if(!(Po(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Wn&&n.metaKey))if(t.someProp("handleKeyPress",function(e){return e(t,n)}))n.preventDefault();else{var r=t.state.selection;if(!(r instanceof be&&r.$from.sameParent(r.$to))){var o=String.fromCharCode(n.charCode),i=function(){return t.state.tr.insertText(o).scrollIntoView()};/[\r\n]/.test(o)||t.someProp("handleTextInput",function(e){return e(t,r.$from.pos,r.$to.pos,o,i)})||t.dispatch(i()),n.preventDefault()}}};var Io=Wn?"metaKey":"ctrlKey";ko.mousedown=function(t,e){var n=e;t.input.shiftKey=n.shiftKey;var r=Ro(t),o=Date.now(),i="singleClick";o-t.input.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[Io]&&t.input.lastClick.button==n.button&&("singleClick"==t.input.lastClick.type?i="doubleClick":"doubleClick"==t.input.lastClick.type&&(i="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};var u=t.posAtCoords(So(n));u&&("singleClick"==i?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Lo(t,u,n,!!r)):("doubleClick"==i?Oo:No)(t,u.pos,u.inside,n)?n.preventDefault():wo(t,"pointer"))};var Lo=function(){function t(t,e,n,r){var o,i,u=this;if(this.view=t,this.pos=e,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Io],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{var s=t.state.doc.resolve(e.pos);o=s.parent,i=s.depth?s.before():0}var a=r?null:n.target,c=a?t.docView.nearestDesc(a,!0):null;this.target=c&&1==c.nodeDOM.nodeType?c.nodeDOM:null;var l=t.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof xe&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!$n||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){u.view.input.mouseDown==u&&u.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),wo(t,"pointer")}var e=t.prototype;return e.done=function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return Hr(t.view)}),this.view.input.mouseDown=null},e.up=function(t){if(this.done(),this.view.dom.contains(t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(So(t))),this.updateAllowDefault(t),this.allowDefault||!e?wo(this.view,"pointer"):function(t,e,n,r,o){return Mo(t,"handleClickOn",e,n,r)||t.someProp("handleClick",function(n){return n(t,e,r)})||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof xe&&(n=o.node);for(var i=t.state.doc.resolve(e),u=i.depth+1;u>0;u--){var s=u>i.depth?i.nodeAfter:i.node(u);if(xe.isSelectable(s)){r=n&&o.$from.depth>0&&u>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(u);break}}return null!=r&&(To(t,xe.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&xe.isSelectable(r))&&(To(t,new xe(n),"pointer"),!0)}(t,n))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||_n&&this.mightDrag&&!this.mightDrag.node.isAtom||Hn&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(To(this.view,Ce.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):wo(this.view,"pointer")}},e.move=function(t){this.updateAllowDefault(t),wo(this.view,"pointer"),0==t.buttons&&this.done()},e.updateAllowDefault=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)},t}();function Po(t,e){return!!t.composing||!!(_n&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}ko.touchstart=function(t){t.input.lastTouch=Date.now(),Ro(t),wo(t,"pointer")},ko.touchmove=function(t){t.input.lastTouch=Date.now(),wo(t,"pointer")},ko.contextmenu=function(t){return Ro(t)};var zo=Un?5e3:-1;function $o(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(function(){return Ho(t)},e))}function jo(t){var e;for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=((e=document.createEvent("Event")).initEvent("event",!0,!0),e.timeStamp));t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Ho(t,e){if(void 0===e&&(e=!1),!(Un&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),jo(t),e||t.docView&&t.docView.dirty){var n=$r(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):!t.markCursor&&!e||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.updateState(t.state):t.dispatch(t.state.tr.deleteSelection()),!0}return!1}}Eo.compositionstart=Eo.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$to;if(e.selection instanceof be&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(function(t){return!1===t.type.spec.inclusive})||Hn&&Kn&&function(t){var e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n||1!=n.nodeType||r>=n.childNodes.length)return!1;var o=n.childNodes[r];return 1==o.nodeType&&"false"==o.contentEditable}(t)))t.markCursor=t.state.storedMarks||n.marks(),Ho(t,!0),t.markCursor=null;else if(Ho(t,!e.selection.empty),$n&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.domSelectionRange(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var u=i<0?o.lastChild:o.childNodes[i-1];if(!u)break;if(3==u.nodeType){var s=t.domSelection();s&&s.collapse(u,u.nodeValue.length);break}o=u,i=-1}t.input.composing=!0}$o(t,zo)},Eo.compositionend=function(t,e){t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(function(){return t.domObserver.flush()}),t.input.compositionID++,$o(t,20))};var Vo=Pn&&zn<15||qn&&Gn<604;function _o(t,e,n,r,o){var i=lo(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",function(e){return e(t,o,i||S.empty)}))return!0;if(!i)return!1;var u=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(i),s=u?t.state.tr.replaceSelectionWith(u,r):t.state.tr.replaceSelection(i);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qo(t){var e=t.getData("text/plain")||t.getData("Text");if(e)return e;var n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}ko.copy=Eo.cut=function(t,e){var n=e,r=t.state.selection,o="cut"==n.type;if(!r.empty){var i=Vo?null:n.clipboardData,u=co(t,r.content()),s=u.dom,a=u.text;i?(n.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",a)):function(t,e){if(t.dom.parentNode){var n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}}(t,s),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Eo.paste=function(t,e){var n=e;if(!t.composing||Un){var r=Vo?null:n.clipboardData,o=t.input.shiftKey&&45!=t.input.lastKeyCode;r&&_o(t,qo(r),r.getData("text/html"),o,n)?n.preventDefault():function(t,e){if(t.dom.parentNode){var n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();var o=t.input.shiftKey&&45!=t.input.lastKeyCode;setTimeout(function(){t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?_o(t,r.value,null,o,e):_o(t,r.textContent,r.innerHTML,o,e)},50)}}(t,n)}};var Wo=function(t,e,n){this.slice=t,this.move=e,this.node=n},Ko=Wn?"altKey":"ctrlKey";function Uo(t,e){var n=t.someProp("dragCopies",function(t){return!t(e)});return null!=n?n:!e[Ko]}for(var Jo in ko.dragstart=function(t,e){var n=e,r=t.input.mouseDown;if(r&&r.done(),n.dataTransfer){var o,i=t.state.selection,u=i.empty?null:t.posAtCoords(So(n));if(u&&u.pos>=i.from&&u.pos<=(i instanceof xe?i.to-1:i.to));else if(r&&r.mightDrag)o=xe.create(t.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){var s=t.docView.nearestDesc(n.target,!0);s&&s.node.type.spec.draggable&&s!=t.docView&&(o=xe.create(t.state.doc,s.posBefore))}var a=co(t,(o||t.state.selection).content()),c=a.dom,l=a.text,d=a.slice;(!n.dataTransfer.files.length||!Hn||Vn>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Vo?"Text":"text/html",c.innerHTML),n.dataTransfer.effectAllowed="copyMove",Vo||n.dataTransfer.setData("text/plain",l),t.dragging=new Wo(d,Uo(t,n),o)}},ko.dragend=function(t){var e=t.dragging;window.setTimeout(function(){t.dragging==e&&(t.dragging=null)},50)},Eo.dragover=Eo.dragenter=function(t,e){return e.preventDefault()},Eo.drop=function(t,e){try{!function(t,e,n){if(e.dataTransfer){var r=t.posAtCoords(So(e));if(r){var o=t.state.doc.resolve(r.pos),i=n&&n.slice;i?t.someProp("transformPasted",function(e){i=e(i,t,!1)}):i=lo(t,qo(e.dataTransfer),Vo?null:e.dataTransfer.getData("text/html"),!1,o);var u=!(!n||!Uo(t,e));if(t.someProp("handleDrop",function(n){return n(t,e,i||S.empty,u)}))e.preventDefault();else if(i){e.preventDefault();var s=i?oe(t.state.doc,o.pos,i):o.pos;null==s&&(s=o.pos);var a=t.state.tr;if(u){var c=n.node;c?c.replace(a):a.deleteSelection()}var l=a.mapping.map(s),d=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=a.doc;if(d?a.replaceRangeWith(l,l,i.content.firstChild):a.replaceRange(l,l,i),!a.doc.eq(f)){var h=a.doc.resolve(l);if(d&&xe.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))a.setSelection(new xe(h));else{var p=a.mapping.map(s);a.mapping.maps[a.mapping.maps.length-1].forEach(function(t,e,n,r){return p=r}),a.setSelection(Jr(t,h,a.doc.resolve(p)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))}}}}}(t,e,t.dragging)}finally{t.dragging=null}},ko.focus=function(t){t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Hr(t)},20))},ko.blur=function(t,e){var n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},ko.beforeinput=function(t,e){if(Hn&&Un&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();var n=t.input.domChangeCount;setTimeout(function(){if(t.input.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",function(e){return e(t,Mn(8,"Backspace"))}))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}},50)}},Eo)ko[Jo]=Eo[Jo];function Go(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var Zo=function(){function t(t,e){this.toDOM=t,this.spec=e||ei,this.side=this.spec.side||0}var e=t.prototype;return e.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new Yo(i-n,i-n,this)},e.valid=function(){return!0},e.eq=function(e){return this==e||e instanceof t&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Go(this.spec,e.spec))},e.destroy=function(t){this.spec.destroy&&this.spec.destroy(t)},t}(),Qo=function(){function t(t,e){this.attrs=t,this.spec=e||ei}var e=t.prototype;return e.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new Yo(o,i,this)},e.valid=function(t,e){return e.from<e.to},e.eq=function(e){return this==e||e instanceof t&&Go(this.attrs,e.attrs)&&Go(this.spec,e.spec)},t.is=function(e){return e.type instanceof t},e.destroy=function(){},t}(),Xo=function(){function t(t,e){this.attrs=t,this.spec=e||ei}var e=t.prototype;return e.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new Yo(o.pos-n,i.pos-n,this)},e.valid=function(t,e){var n,r=t.content.findIndex(e.from),o=r.index,i=r.offset;return i==e.from&&!(n=t.child(o)).isText&&i+n.nodeSize==e.to},e.eq=function(e){return this==e||e instanceof t&&Go(this.attrs,e.attrs)&&Go(this.spec,e.spec)},e.destroy=function(){},t}(),Yo=function(){function t(t,e,n){this.from=t,this.to=e,this.type=n}var e=t.prototype;return e.copy=function(e,n){return new t(e,n,this.type)},e.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},e.map=function(t,e,n){return this.type.map(t,this,e,n)},t.widget=function(e,n,r){return new t(e,e,new Zo(n,r))},t.inline=function(e,n,r,o){return new t(e,n,new Qo(r,o))},t.node=function(e,n,r,o){return new t(e,n,new Xo(r,o))},f(t,[{key:"spec",get:function(){return this.type.spec}},{key:"inline",get:function(){return this.type instanceof Qo}},{key:"widget",get:function(){return this.type instanceof Zo}}])}(),ti=[],ei={},ni=function(){function t(t,e){this.local=t.length?t:ti,this.children=e.length?e:ti}t.create=function(t,e){return e.length?ci(e,t,0,ei):ri};var e=t.prototype;return e.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},e.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var u=this.local[i];u.from<=e&&u.to>=t&&(!o||o(u.spec))&&n.push(u.copy(u.from+r,u.to+r))}for(var s=0;s<this.children.length;s+=3)if(this.children[s]<e&&this.children[s+1]>t){var a=this.children[s]+1;this.children[s+2].findInner(t-a,e-a,n,r+a,o)}},e.map=function(t,e,n){return this==ri||0==t.maps.length?this:this.mapInner(t,e,0,0,n||ei)},e.mapInner=function(e,n,r,o,i){for(var u,s=0;s<this.local.length;s++){var a=this.local[s].map(e,r,o);a&&a.type.valid(n,a)?(u||(u=[])).push(a):i.onRemove&&i.onRemove(this.local[s].spec)}return this.children.length?ii(this.children,u||[],e,n,r,o,i):u?new t(u.sort(li),ti):ri},e.add=function(e,n){return n.length?this==ri?t.create(e,n):this.addInner(e,n,0):this},e.addInner=function(e,n,r){var o,i=this,u=0;e.forEach(function(t,e){var s,a=e+r;if(s=si(n,t,a)){for(o||(o=i.children.slice());u<o.length&&o[u]<e;)u+=3;o[u]==e?o[u+2]=o[u+2].addInner(t,s,a+1):o.splice(u,0,e,e+t.nodeSize,ci(s,t,a+1,ei)),u+=3}});for(var s=ui(u?ai(n):n,-r),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new t(s.length?this.local.concat(s).sort(li):this.local,o||this.children)},e.remove=function(t){return 0==t.length||this==ri?this:this.removeInner(t,0)},e.removeInner=function(e,n){for(var r=this.children,o=this.local,i=0;i<r.length;i+=3){for(var u,s=void 0,a=r[i]+n,c=r[i+1]+n,l=0;l<e.length;l++)(u=e[l])&&u.from>a&&u.to<c&&(e[l]=null,(s||(s=[])).push(u));if(s){r==this.children&&(r=this.children.slice());var d=r[i+2].removeInner(s,a+1);d!=ri?r[i+2]=d:(r.splice(i,3),i-=3)}}if(o.length)for(var f,h=0;h<e.length;h++)if(f=e[h])for(var p=0;p<o.length;p++)o[p].eq(f,n)&&(o==this.local&&(o=this.local.slice()),o.splice(p--,1));return r==this.children&&o==this.local?this:o.length||r.length?new t(o,r):ri},e.forChild=function(e,n){if(this==ri)return this;if(n.isLeaf)return t.empty;for(var r,o,i=0;i<this.children.length;i+=3)if(this.children[i]>=e){this.children[i]==e&&(r=this.children[i+2]);break}for(var u=e+1,s=u+n.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>u&&c.type instanceof Qo){var l=Math.max(u,c.from)-u,d=Math.min(s,c.to)-u;l<d&&(o||(o=[])).push(c.copy(l,d))}}if(o){var f=new t(o.sort(li),ti);return r?new oi([f,r]):f}return r||ri},e.eq=function(e){if(this==e)return!0;if(!(e instanceof t)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(var r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0},e.locals=function(t){return di(this.localsInner(t))},e.localsInner=function(t){if(this==ri)return ti;if(t.inlineContent||!this.local.some(Qo.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Qo||e.push(this.local[n]);return e},e.forEachSet=function(t){t(this)},t}();ni.empty=new ni([],[]),ni.removeOverlap=di;var ri=ni.empty,oi=function(){function t(t){this.members=t}var e=t.prototype;return e.map=function(e,n){var r=this.members.map(function(t){return t.map(e,n,ei)});return t.from(r)},e.forChild=function(e,n){if(n.isLeaf)return ni.empty;for(var r=[],o=0;o<this.members.length;o++){var i=this.members[o].forChild(e,n);i!=ri&&(i instanceof t?r=r.concat(i.members):r.push(i))}return t.from(r)},e.eq=function(e){if(!(e instanceof t)||e.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0},e.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?di(n?e:e.sort(li)):ti},t.from=function(e){switch(e.length){case 0:return ri;case 1:return e[0];default:return new t(e.every(function(t){return t instanceof ni})?e:e.reduce(function(t,e){return t.concat(e instanceof ni?e:e.members)},[]))}},e.forEachSet=function(t){for(var e=0;e<this.members.length;e++)this.members[e].forEachSet(t)},t}();function ii(t,e,n,r,o,i,u){for(var s=t.slice(),a=function(t){var e=0;n.maps[c].forEach(function(n,r,o,i){for(var u=i-o-(r-n),a=0;a<s.length;a+=3){var c=s[a+1];if(!(c<0||n>c+t-e)){var l=s[a]+t-e;r>=l?s[a+1]=n<=l?-2:-1:n>=t&&u&&(s[a]+=u,s[a+1]+=u)}}e+=u}),t=n.maps[c].map(t,-1),l=t},c=0,l=i;c<n.maps.length;c++)a(l);for(var d=!1,f=0;f<s.length;f+=3)if(s[f+1]<0){if(-2==s[f+1]){d=!0,s[f+1]=-1;continue}var h=n.map(t[f]+i),p=h-o;if(p<0||p>=r.content.size){d=!0;continue}var m=n.map(t[f+1]+i,-1)-o,D=r.content.findIndex(p),v=D.index,g=D.offset,F=r.maybeChild(v);if(F&&g==p&&g+F.nodeSize==m){var y=s[f+2].mapInner(n,F,h+1,t[f]+i+1,u);y!=ri?(s[f]=p,s[f+1]=m,s[f+2]=y):(s[f+1]=-2,d=!0)}else d=!0}if(d){var C=function(t,e,n,r,o,i,u){function s(t,e){for(var i=0;i<t.local.length;i++){var a=t.local[i].map(r,o,e);a?n.push(a):u.onRemove&&u.onRemove(t.local[i].spec)}for(var c=0;c<t.children.length;c+=3)s(t.children[c+2],t.children[c]+e+1)}for(var a=0;a<t.length;a+=3)-1==t[a+1]&&s(t[a+2],e[a]+i+1);return n}(s,t,e,n,o,i,u),k=ci(C,r,0,u);e=k.local;for(var E=0;E<s.length;E+=3)s[E+1]<0&&(s.splice(E,3),E-=3);for(var A=0,b=0;A<k.children.length;A+=3){for(var w=k.children[A];b<s.length&&s[b]<w;)b+=3;s.splice(b,0,k.children[A],k.children[A+1],k.children[A+2])}}return new ni(e.sort(li),s)}function ui(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new Yo(o.from+e,o.to+e,o.type))}return n}function si(t,e,n){if(e.isLeaf)return null;for(var r,o=n+e.nodeSize,i=null,u=0;u<t.length;u++)(r=t[u])&&r.from>n&&r.to<o&&((i||(i=[])).push(r),t[u]=null);return i}function ai(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function ci(t,e,n,r){var o=[],i=!1;e.forEach(function(e,u){var s=si(t,e,u+n);if(s){i=!0;var a=ci(s,e,n+u+1,r);a!=ri&&o.push(u,u+e.nodeSize,a)}});for(var u=ui(i?ai(t):t,-n).sort(li),s=0;s<u.length;s++)u[s].type.valid(e,u[s])||(r.onRemove&&r.onRemove(u[s].spec),u.splice(s--,1));return u.length||o.length?new ni(u,o):ri}function li(t,e){return t.from-e.from||t.to-e.to}function di(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),fi(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),fi(e,o+1,i.copy(r.to,i.to)))}}return e}function fi(t,e,n){for(;e<t.length&&li(n,t[e])>0;)e++;t.splice(e,0,n)}function hi(t){var e=[];return t.someProp("decorations",function(n){var r=n(t.state);r&&r!=ri&&e.push(r)}),t.cursorWrapper&&e.push(ni.create(t.state.doc,[t.cursorWrapper.deco])),oi.from(e)}var pi={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},mi=Pn&&zn<=11,Di=function(){function t(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}var e=t.prototype;return e.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},e.clear=function(){this.anchorNode=this.focusNode=null},e.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset},t}(),vi=function(){function t(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Di,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(function(e){for(var r=0;r<e.length;r++)n.queue.push(e[r]);Pn&&zn<=11&&e.some(function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length})?n.flushSoon():_n&&t.composing&&e.some(function(t){return"childList"==t.type&&"TR"==t.target.nodeName})?(t.input.badSafariComposition=!0,n.flushSoon()):n.flush()}),mi&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}var e=t.prototype;return e.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){t.flushingSoon=-1,t.flush()},20))},e.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},e.start=function(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,pi)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},e.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(function(){return t.flush()},20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},e.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},e.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},e.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return t.suppressingSelectionUpdates=!1},50)},e.onSelectionChange=function(){if(Gr(this.view)){if(this.suppressingSelectionUpdates)return Hr(this.view);if(Pn&&zn<=11&&!this.view.state.selection.empty){var t=this.view.domSelectionRange();if(t.focusNode&&An(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},e.setCurSelection=function(){this.currentSelection.set(this.view.domSelectionRange())},e.ignoreSelectionChange=function(t){if(!t.focusNode)return!0;for(var e,n=new Set,r=t.focusNode;r;r=Cn(r))n.add(r);for(var o=t.anchorNode;o;o=Cn(o))if(n.has(o)){e=o;break}var i=e&&this.view.docView.nearestDesc(e);return i&&i.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},e.pendingRecords=function(){if(this.observer)for(var t,e=gn(this.observer.takeRecords());!(t=e()).done;){var n=t.value;this.queue.push(n)}return this.queue},e.flush=function(){var t=this.view;if(t.docView&&!(this.flushingSoon>-1)){var e=this.pendingRecords();e.length&&(this.queue=[]);var n=t.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Gr(t)&&!this.ignoreSelectionChange(n),o=-1,i=-1,u=!1,s=[];if(t.editable)for(var a=0;a<e.length;a++){var c=this.registerMutation(e[a],s);c&&(o=o<0?c.from:Math.min(c.from,o),i=i<0?c.to:Math.max(c.to,i),c.typeOver&&(u=!0))}if($n&&s.length){var l=s.filter(function(t){return"BR"==t.nodeName});if(2==l.length){var d=l[0],f=l[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else for(var h,p=this.currentSelection.focusNode,m=gn(l);!(h=m()).done;){var D=h.value,v=D.parentNode;!v||"LI"!=v.nodeName||p&&Ci(t,p)==v||D.remove()}}else if((Hn||_n)&&s.some(function(t){return"BR"==t.nodeName})&&(8==t.input.lastKeyCode||46==t.input.lastKeyCode))for(var g,F=gn(s);!(g=F()).done;){var y=g.value;if("BR"==y.nodeName&&y.parentNode){var C=y.nextSibling;C&&1==C.nodeType&&"false"==C.contentEditable&&y.parentNode.removeChild(y)}}var k=null;o<0&&r&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Sn(n)&&(k=$r(t))&&k.eq(Ce.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Hr(t),this.currentSelection.set(n),t.scrollToSelection()):(o>-1||r)&&(o>-1&&(t.docView.markDirty(o,i),function(t){if(!gi.has(t)&&(gi.set(t,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace))){if(t.requiresGeckoHackNode=$n,Fi)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Fi=!0}}(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,function(t,e){for(var n,r,o=t.domSelectionRange(),i=o.focusNode,u=o.focusOffset,s=gn(e);!(r=s()).done;){var a=r.value;if("TR"==(null===(n=a.parentNode)||void 0===n?void 0:n.nodeName)){for(var c=a.nextSibling;c&&"TD"!=c.nodeName&&"TH"!=c.nodeName;)c=c.nextSibling;if(c){for(var l=c;;){var d=l.firstChild;if(!d||1!=d.nodeType||"false"==d.contentEditable||/^(BR|IMG)$/.test(d.nodeName))break;l=d}l.insertBefore(a,l.firstChild),i==a&&t.domSelection().collapse(a,u)}else a.parentNode.removeChild(a)}}}(t,s)),this.handleDOMChange(o,i,u,s),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Hr(t),this.currentSelection.set(n))}},e.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(var r=0;r<t.addedNodes.length;r++){var o=t.addedNodes[r];e.push(o),3==o.nodeType&&(this.lastChangedTextNode=o)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};var i=t.previousSibling,u=t.nextSibling;if(Pn&&zn<=11&&t.addedNodes.length)for(var s=0;s<t.addedNodes.length;s++){var a=t.addedNodes[s],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(i=c),(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(u=l)}var d=i&&i.parentNode==t.target?yn(i)+1:0,f=n.localPosFromDOM(t.target,d,-1),h=u&&u.parentNode==t.target?yn(u):t.target.childNodes.length;return{from:f,to:n.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})},t}(),gi=new WeakMap,Fi=!1;function yi(t,e){var n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,u=t.domAtPos(t.state.selection.anchor);if(An(u.node,u.offset,o,i)){var s=[o,i,n,r];n=s[0],r=s[1],o=s[2],i=s[3]}return{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function Ci(t,e){for(var n=e.parentNode;n&&n!=t.dom;n=n.parentNode){var r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function ki(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(_n&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||_n&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}var Ei=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Ai(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Jr(t,e.resolve(n.anchor),e.resolve(n.head))}function bi(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function wi(t){if(2!=t.length)return!1;var e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}var xi=function(){function t(t,e){var n=this;this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new bo,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Oi),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Mi(this),Si(this),this.nodeViews=Ti(this),this.docView=Er(this.state.doc,Bi(this),hi(this),this.dom,this),this.domObserver=new vi(this,function(t,e,r,o){return function(t,e,n,r,o){var i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){var u=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,s=$r(t,u);if(s&&!t.state.selection.eq(s)){if(Hn&&Un&&13===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",function(e){return e(t,Mn(13,"Enter"))}))return;var a=t.state.tr.setSelection(s);"pointer"==u?a.setMeta("pointer",!0):"key"==u&&a.scrollIntoView(),i&&a.setMeta("composition",i),t.dispatch(a)}}else{var c=t.state.doc.resolve(e),l=c.sharedDepth(n);e=c.before(l+1),n=t.state.doc.resolve(n).after(l+1);var d,f,h=t.state.selection,p=function(t,e,n){var r,o=t.docView.parseRange(e,n),i=o.node,u=o.fromOffset,s=o.toOffset,a=o.from,c=o.to,l=t.domSelectionRange(),d=l.anchorNode;if(d&&t.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:l.anchorOffset}],Sn(l)||r.push({node:l.focusNode,offset:l.focusOffset})),Hn&&8===t.input.lastKeyCode)for(var f=s;f>u;f--){var h=i.childNodes[f-1],p=h.pmViewDesc;if("BR"==h.nodeName&&!p){s=f;break}if(!p||p.size)break}var m=t.state.doc,D=t.someProp("domParser")||mt.fromSchema(t.state.schema),v=m.resolve(a),g=null,F=D.parse(i,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:u,to:s,preserveWhitespace:"pre"!=v.parent.type.whitespace||"full",findPositions:r,ruleFromNode:ki,context:v});if(r&&null!=r[0].pos){var y=r[0].pos,C=r[1]&&r[1].pos;null==C&&(C=y),g={anchor:y+a,head:C+a}}return{doc:F,sel:g,from:a,to:c}}(t,e,n),m=t.state.doc,D=m.slice(p.from,p.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(d=t.state.selection.to,f="end"):(d=t.state.selection.from,f="start"),t.input.lastKeyCode=null;var v=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var u=t.findDiffEnd(e,n+t.size,n+e.size),s=u.a,a=u.b;if("end"==o&&(r-=s+Math.max(0,i-Math.min(s,a))-i),s<i&&t.size<e.size){var c=r<=i&&r>=s?i-r:0;(i-=c)&&i<e.size&&wi(e.textBetween(i-1,i+1))&&(i+=c?1:-1),a=i+(a-s),s=i}else if(a<i){var l=r<=i&&r>=a?i-r:0;(i-=l)&&i<t.size&&wi(t.textBetween(i-1,i+1))&&(i+=l?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(D.content,p.doc.content,p.from,d,f);if(v&&t.input.domChangeCount++,(qn&&t.input.lastIOSEnter>Date.now()-225||Un)&&o.some(function(t){return 1==t.nodeType&&!Ei.test(t.nodeName)})&&(!v||v.endA>=v.endB)&&t.someProp("handleKeyDown",function(e){return e(t,Mn(13,"Enter"))}))t.input.lastIOSEnter=0;else{if(!v){if(!(r&&h instanceof be&&!h.empty&&h.$head.sameParent(h.$anchor))||t.composing||p.sel&&p.sel.anchor!=p.sel.head){if(p.sel){var g=Ai(t,t.state.doc,p.sel);if(g&&!g.eq(t.state.selection)){var F=t.state.tr.setSelection(g);i&&F.setMeta("composition",i),t.dispatch(F)}}return}v={start:h.from,endA:h.to,endB:h.to}}t.state.selection.from<t.state.selection.to&&v.start==v.endB&&t.state.selection instanceof be&&(v.start>t.state.selection.from&&v.start<=t.state.selection.from+2&&t.state.selection.from>=p.from?v.start=t.state.selection.from:v.endA<t.state.selection.to&&v.endA>=t.state.selection.to-2&&t.state.selection.to<=p.to&&(v.endB+=t.state.selection.to-v.endA,v.endA=t.state.selection.to)),Pn&&zn<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>p.from&&" "==p.doc.textBetween(v.start-p.from-1,v.start-p.from+1)&&(v.start--,v.endA--,v.endB--);var y=p.doc.resolveNoCache(v.start-p.from),C=p.doc.resolveNoCache(v.endB-p.from),k=m.resolve(v.start),A=y.sameParent(C)&&y.parent.inlineContent&&k.end()>=v.endA;if((qn&&t.input.lastIOSEnter>Date.now()-225&&(!A||o.some(function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))||!A&&y.pos<p.doc.content.size&&(!y.sameParent(C)||!y.parent.inlineContent)&&y.pos<C.pos&&!/\S/.test(p.doc.textBetween(y.pos,C.pos,"","")))&&t.someProp("handleKeyDown",function(e){return e(t,Mn(13,"Enter"))}))t.input.lastIOSEnter=0;else if(t.state.selection.anchor>v.start&&function(t,e,n,r,o){if(n-e<=o.pos-r.pos||bi(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(!r.parent.isTextblock){var u=i.nodeAfter;return null!=u&&n==e+u.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(bi(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||bi(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(m,v.start,v.endA,y,C)&&t.someProp("handleKeyDown",function(e){return e(t,Mn(8,"Backspace"))}))Un&&Hn&&t.domObserver.suppressSelectionUpdates();else{Hn&&v.endB==v.start&&(t.input.lastChromeDelete=Date.now()),Un&&!A&&y.start()!=C.start()&&0==C.parentOffset&&y.depth==C.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==v.endA&&(v.endB-=2,C=p.doc.resolveNoCache(v.endB-p.from),setTimeout(function(){t.someProp("handleKeyDown",function(e){return e(t,Mn(13,"Enter"))})},20));var b,w=v.start,x=v.endA,B=function(e){var n=e||t.state.tr.replace(w,x,p.doc.slice(v.start-p.from,v.endB-p.from));if(p.sel){var r=Ai(t,n.doc,p.sel);r&&!(Hn&&t.composing&&r.empty&&(v.start!=v.endB||t.input.lastChromeDelete<Date.now()-100)&&(r.head==w||r.head==n.mapping.map(x)-1)||Pn&&r.empty&&r.head==w)&&n.setSelection(r)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(A)if(y.pos==C.pos){Pn&&zn<=11&&0==y.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(function(){return Hr(t)},20));var S=B(t.state.tr.delete(w,x)),M=m.resolve(v.start).marksAcross(m.resolve(v.endA));M&&S.ensureMarks(M),t.dispatch(S)}else if(v.endA==v.endB&&(b=function(t,e){for(var n,r,o,i=t.firstChild.marks,u=e.firstChild.marks,s=i,a=u,c=0;c<u.length;c++)s=u[c].removeFromSet(s);for(var l=0;l<i.length;l++)a=i[l].removeFromSet(a);if(1==s.length&&0==a.length)r=s[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=s.length||1!=a.length)return null;r=a[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var d=[],f=0;f<e.childCount;f++)d.push(o(e.child(f)));if(E.from(d).eq(t))return{mark:r,type:n}}(y.parent.content.cut(y.parentOffset,C.parentOffset),k.parent.content.cut(k.parentOffset,v.endA-k.start())))){var T=B(t.state.tr);"add"==b.type?T.addMark(w,x,b.mark):T.removeMark(w,x,b.mark),t.dispatch(T)}else if(y.parent.child(y.index()).isText&&y.index()==C.index()-(C.textOffset?0:1)){var O=y.parent.textBetween(y.parentOffset,C.parentOffset),N=function(){return B(t.state.tr.insertText(O,w,x))};t.someProp("handleTextInput",function(e){return e(t,w,x,O,N)})||t.dispatch(N())}else t.dispatch(B());else t.dispatch(B())}}}}(n,t,e,r,o)}),this.domObserver.start(),function(t){var e=function(){var e=ko[n];t.dom.addEventListener(n,t.input.eventHandlers[n]=function(n){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,n)||Bo(t,n)||!t.editable&&n.type in Eo||e(t,n)},Ao[n]?{passive:!0}:void 0)};for(var n in ko)e();_n&&t.dom.addEventListener("input",function(){return null}),xo(t)}(this),this.updatePluginViews()}var e=t.prototype;return e.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&xo(this);var e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Oi),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)},e.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},e.updateState=function(t){this.updateStateInner(t,this._props)},e.updateStateInner=function(t,e){var n,r=this.state,o=!1,i=!1;t.storedMarks&&this.composing&&(jo(this),i=!0),this.state=t;var u=r.plugins!=t.plugins||this._props.plugins!=e.plugins;if(u||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){var s=Ti(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0)}(u||e.handleDOMEvents!=this._props.handleDOMEvents)&&xo(this),this.editable=Mi(this),Si(this);var a=hi(this),c=Bi(this),l=r.plugins==t.plugins||r.doc.eq(t.doc)?t.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",d=o||!this.docView.matchesNode(t.doc,c,a);!d&&t.selection.eq(r.selection)||(i=!0);var f,h,p,m,D,v,g,F,y,C,k="preserve"==l&&i&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,u=o+1;u<Math.min(innerHeight,r.bottom);u+=5){var s=t.root.elementFromPoint(i,u);if(s&&s!=t.dom&&t.dom.contains(s)){var a=s.getBoundingClientRect();if(a.top>=o-20){e=s,n=a.top;break}}}return{refDOM:e,refTop:n,stack:tr(t.dom)}}(this);if(i){this.domObserver.stop();var E=d&&(Pn||Hn)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&(m=r.selection,D=t.selection,v=Math.min(m.$anchor.sharedDepth(m.head),D.$anchor.sharedDepth(D.head)),m.$anchor.start(v)!=D.$anchor.start(v));if(d){var A=Hn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(t){var e=t.domSelectionRange();if(!e.focusNode)return null;var n=function(t,e){for(;;){if(3==t.nodeType&&e)return t;if(1==t.nodeType&&e>0){if("false"==t.contentEditable)return null;e=xn(t=t.childNodes[e-1])}else{if(!t.parentNode||Bn(t))return null;e=yn(t),t=t.parentNode}}}(e.focusNode,e.focusOffset),r=function(t,e){for(;;){if(3==t.nodeType&&e<t.nodeValue.length)return t;if(1==t.nodeType&&e<t.childNodes.length){if("false"==t.contentEditable)return null;t=t.childNodes[e],e=0}else{if(!t.parentNode||Bn(t))return null;e=yn(t)+1,t=t.parentNode}}}(e.focusNode,e.focusOffset);if(n&&r&&n!=r){var o=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!o||!o.isText(r.nodeValue))return r;if(t.input.compositionNode==r){var u=n.pmViewDesc;if(u&&u.isText(n.nodeValue))return r}}return n||r}(this)),!o&&this.docView.update(t.doc,c,a,this)||(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Er(t.doc,c,a,this.dom,this)),!A||this.trackWrites&&this.dom.contains(this.trackWrites)||(E=!0)}E||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(f=this,h=f.docView.domFromPos(f.state.selection.anchor,0),p=f.domSelectionRange(),An(h.node,h.offset,p.anchorNode,p.anchorOffset)))?Hr(this,E):(Kr(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==l?this.dom.scrollTop=0:"to selection"==l?this.scrollToSelection():k&&(F=(g=k).refDOM,y=g.refTop,er(g.stack,0==(C=F?F.getBoundingClientRect().top:0)?0:C-y))},e.scrollToSelection=function(){var t=this,e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",function(e){return e(t)}));else if(this.state.selection instanceof xe){var n=this.docView.domAfterPos(this.state.selection.from);1==n.nodeType&&Yn(this,n.getBoundingClientRect(),e)}else Yn(this,this.coordsAtPos(this.state.selection.head,1),e)},e.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},e.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var o=this.directPlugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var u=this.state.plugins[i];u.spec.view&&this.pluginViews.push(u.spec.view(this))}}},e.updateDraggedNode=function(t,e){var n=t.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{var o=n.from+(this.state.doc.content.size-e.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(r=o)}this.dragging=new Wo(t.slice,t.move,r<0?void 0:xe.create(this.state.doc,r))},e.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;for(var o=0;o<this.directPlugins.length;o++){var i=this.directPlugins[o].props[t];if(null!=i&&(n=e?e(i):i))return n}var u=this.state.plugins;if(u)for(var s=0;s<u.length;s++){var a=u[s].props[t];if(null!=a&&(n=e?e(a):a))return n}},e.hasFocus=function(){if(Pn){var t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom},e.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(nr)return t.focus(nr);var e=tr(t);t.focus(null==nr?{get preventScroll(){return nr={preventScroll:!0},!0}}:void 0),nr||(nr=!1,er(e,0))}(this.dom),Hr(this),this.domObserver.start()},e.updateRoot=function(){this._root=null},e.posAtCoords=function(t){return ur(this,t)},e.coordsAtPos=function(t,e){return void 0===e&&(e=1),lr(this,t,e)},e.domAtPos=function(t,e){return void 0===e&&(e=0),this.docView.domFromPos(t,e)},e.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},e.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},e.endOfTextblock=function(t,e){return function(t,e,n){return mr==e&&Dr==n?vr:(mr=e,Dr=n,vr="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$from:r.$to;return hr(t,e,function(){for(var e=t.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.contentDOM||r.dom;break}e=r.dom.parentNode}for(var i=lr(t,o.pos,1),u=e.firstChild;u;u=u.nextSibling){var s=void 0;if(1==u.nodeType)s=u.getClientRects();else{if(3!=u.nodeType)continue;s=En(u,0,u.nodeValue.length).getClientRects()}for(var a=0;a<s.length;a++){var c=s[a];if(c.bottom>c.top+1&&("up"==n?i.top-c.top>2*(c.bottom-i.top):c.bottom-i.bottom>2*(i.bottom-c.top)))return!1}}return!0})}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,u=o==r.parent.content.size,s=t.domSelection();return s?pr.test(r.parent.textContent)&&s.modify?hr(t,e,function(){var e=t.domSelectionRange(),o=e.focusNode,i=e.focusOffset,u=e.anchorNode,a=e.anchorOffset,c=s.caretBidiLevel;s.modify("move",n,"character");var l=r.depth?t.docView.domAfterPos(r.before()):t.dom,d=t.domSelectionRange(),f=d.focusNode,h=d.focusOffset,p=f&&!l.contains(1==f.nodeType?f:f.parentNode)||o==f&&i==h;try{s.collapse(u,a),o&&(o!=u||i!=a)&&s.extend&&s.extend(o,i)}catch(t){}return null!=c&&(s.caretBidiLevel=c),p}):"left"==n||"backward"==n?i:u:r.pos==r.start()||r.pos==r.end()}(t,e,n))}(this,e||this.state,t)},e.pasteHTML=function(t,e){return _o(this,"",t,!1,e||new ClipboardEvent("paste"))},e.pasteText=function(t,e){return _o(this,t,null,!0,e||new ClipboardEvent("paste"))},e.serializeForClipboard=function(t){return co(this,t)},e.destroy=function(){this.docView&&(function(t){for(var e in t.domObserver.stop(),t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],hi(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,kn=null)},e.dispatchEvent=function(t){return function(t,e){Bo(t,e)||!ko[e.type]||!t.editable&&e.type in Eo||ko[e.type](t,e)}(this,t)},e.domSelectionRange=function(){var t=this.domSelection();return t?_n&&11===this.root.nodeType&&function(t){for(var e=t.activeElement;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(t,e){if(e.getComposedRanges){var n=e.getComposedRanges(t.root)[0];if(n)return yi(t,n)}var r;function o(t){t.preventDefault(),t.stopImmediatePropagation(),r=t.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",o,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",o,!0),r?yi(t,r):null}(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}},e.domSelection=function(){return this.root.getSelection()},f(t,[{key:"composing",get:function(){return this.input.composing}},{key:"props",get:function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props}},{key:"root",get:function(){var t=this,e=this._root;if(null==e)for(var n,r=function(e){if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return e.ownerDocument.getSelection()}),{v:t._root=e}},o=this.dom.parentNode;o;o=o.parentNode)if(n=r(o))return n.v;return e||document}},{key:"isDestroyed",get:function(){return null==this.docView}}])}();function Bi(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:"style"==r?e.style=(e.style?e.style+";":"")+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Yo.node(0,t.state.doc.content.size,e)]}function Si(t){if(t.markCursor){var e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Yo.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Mi(t){return!t.someProp("editable",function(e){return!1===e(t.state)})}function Ti(t){var e=Object.create(null);function n(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Oi(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}xi.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};for(var Ni={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ri={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ii="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Li="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Pi=0;Pi<10;Pi++)Ni[48+Pi]=Ni[96+Pi]=String(Pi);for(Pi=1;Pi<=24;Pi++)Ni[Pi+111]="F"+Pi;for(Pi=65;Pi<=90;Pi++)Ni[Pi]=String.fromCharCode(Pi+32),Ri[Pi]=String.fromCharCode(Pi);for(var zi in Ni)Ri.hasOwnProperty(zi)||(Ri[zi]=Ni[zi]);var $i="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),ji="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function Hi(t){var e,n,r,o,i=t.split(/-(?!$)/),u=i[i.length-1];"Space"==u&&(u=" ");for(var s=0;s<i.length-1;s++){var a=i[s];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);$i?o=!0:n=!0}}return e&&(u="Alt-"+u),n&&(u="Ctrl-"+u),o&&(u="Meta-"+u),r&&(u="Shift-"+u),u}function Vi(t,e,n){return void 0===n&&(n=!0),e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function _i(t){var e=function(t){var e=Object.create(null);for(var n in t)e[Hi(n)]=t[n];return e}(t);return function(t,n){var r,o=function(t){var e=!(Ii&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Li&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Ri:Ni)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),i=e[Vi(o,n)];if(i&&i(t.state,t.dispatch,t))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){var u=e[Vi(o,n,!1)];if(u&&u(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(ji&&n.ctrlKey&&n.altKey)&&(r=Ni[n.keyCode])&&r!=o){var s=e[Vi(r,n)];if(s&&s(t.state,t.dispatch,t))return!0}}return!1}}var qi=Object.defineProperty,Wi=function(t,e){for(var n in e)qi(t,n,{get:e[n],enumerable:!0})};function Ki(t){var e=t.state,n=t.transaction,r=n.selection,o=n.doc,i=n.storedMarks;return h({},e,{apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}})}var Ui=function(){function t(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}var e=t.prototype;return e.createChain=function(t,e){var n=this;void 0===e&&(e=!0);var r=this.rawCommands,o=this.editor,i=this.state,u=o.view,s=[],a=!!t,c=t||i.tr,l=h({},Object.fromEntries(Object.entries(r).map(function(t){var r=t[0],o=t[1];return[r,function(){var t=n.buildProps(c,e),r=o.apply(void 0,arguments)(t);return s.push(r),l}]})),{run:function(){return a||!e||c.getMeta("preventDispatch")||n.hasCustomState||u.dispatch(c),s.every(function(t){return!0===t})}});return l},e.createCan=function(t){var e=this,n=this.rawCommands,r=this.state,o=!1,i=t||r.tr,u=this.buildProps(i,o),s=Object.fromEntries(Object.entries(n).map(function(t){var e=t[0],n=t[1];return[e,function(){return n.apply(void 0,arguments)(h({},u,{dispatch:void 0}))}]}));return h({},s,{chain:function(){return e.createChain(i,o)}})},e.buildProps=function(t,e){var n=this;void 0===e&&(e=!0);var r=this.rawCommands,o=this.editor,i=this.state,u=o.view,s={tr:t,editor:o,view:u,state:Ki({state:i,transaction:t}),dispatch:e?function(){}:void 0,chain:function(){return n.createChain(t,e)},can:function(){return n.createCan(t)},get commands(){return Object.fromEntries(Object.entries(r).map(function(t){var e=t[0],n=t[1];return[e,function(){return n.apply(void 0,arguments)(s)}]}))}};return s},f(t,[{key:"hasCustomState",get:function(){return!!this.customState}},{key:"state",get:function(){return this.customState||this.editor.state}},{key:"commands",get:function(){var t=this,e=this.rawCommands,n=this.editor,r=this.state,o=n.view,i=r.tr,u=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(function(e){var n=e[0],r=e[1];return[n,function(){var e=r.apply(void 0,arguments)(u);return i.getMeta("preventDispatch")||t.hasCustomState||o.dispatch(i),e}]}))}},{key:"chain",get:function(){var t=this;return function(){return t.createChain()}}},{key:"can",get:function(){var t=this;return function(){return t.createCan()}}}])}(),Ji={};Wi(Ji,{blur:function(){return Gi},clearContent:function(){return Zi},clearNodes:function(){return Qi},command:function(){return Xi},createParagraphNear:function(){return Yi},cut:function(){return tu},deleteCurrentNode:function(){return eu},deleteNode:function(){return ru},deleteRange:function(){return ou},deleteSelection:function(){return iu},enter:function(){return uu},exitCode:function(){return su},extendMarkRange:function(){return pu},first:function(){return mu},focus:function(){return Cu},forEach:function(){return ku},insertContent:function(){return Eu},insertContentAt:function(){return xu},joinBackward:function(){return Mu},joinDown:function(){return Su},joinForward:function(){return Tu},joinItemBackward:function(){return Ou},joinItemForward:function(){return Nu},joinTextblockBackward:function(){return Ru},joinTextblockForward:function(){return Iu},joinUp:function(){return Bu},keyboardShortcut:function(){return Pu},lift:function(){return $u},liftEmptyBlock:function(){return ju},liftListItem:function(){return Hu},newlineInCode:function(){return Vu},resetAttributes:function(){return Wu},scrollIntoView:function(){return Ku},selectAll:function(){return Uu},selectNodeBackward:function(){return Ju},selectNodeForward:function(){return Gu},selectParentNode:function(){return Zu},selectTextblockEnd:function(){return Qu},selectTextblockStart:function(){return Xu},setContent:function(){return ts},setMark:function(){return Is},setMeta:function(){return Ls},setNode:function(){return Ps},setNodeSelection:function(){return zs},setTextDirection:function(){return $s},setTextSelection:function(){return js},sinkListItem:function(){return Hs},splitBlock:function(){return _s},splitListItem:function(){return qs},toggleList:function(){return Us},toggleMark:function(){return Js},toggleNode:function(){return Gs},toggleWrap:function(){return Zs},undoInputRule:function(){return Qs},unsetAllMarks:function(){return Xs},unsetMark:function(){return Ys},unsetTextDirection:function(){return ta},updateAttributes:function(){return ea},wrapIn:function(){return na},wrapInList:function(){return ra}});var Gi=function(){return function(t){var e=t.editor,n=t.view;return requestAnimationFrame(function(){var t;e.isDestroyed||(n.dom.blur(),null==(t=null==window?void 0:window.getSelection())||t.removeAllRanges())}),!0}},Zi=function(t){return void 0===t&&(t=!0),function(e){return e.commands.setContent("",{emitUpdate:t})}},Qi=function(){return function(t){var e=t.state,n=t.tr,r=t.dispatch,o=n.selection.ranges;return!r||(o.forEach(function(t){var r=t.$from,o=t.$to;e.doc.nodesBetween(r.pos,o.pos,function(t,e){if(!t.type.isText){var r=n.doc,o=n.mapping,i=r.resolve(o.map(e)),u=r.resolve(o.map(e+t.nodeSize)),s=i.blockRange(u);if(s){var a=Gt(s);if(t.type.isTextblock){var c=i.parent.contentMatchAt(i.index()).defaultType;n.setNodeMarkup(s.start,c)}(a||0===a)&&n.lift(s,a)}}})}),!0)}},Xi=function(t){return function(e){return t(e)}},Yi=function(){return function(t){var e=t.state,n=t.dispatch;return on(e,n)}},tu=function(t,e){return function(n){var r=n.editor,o=n.tr,i=r.state.doc.slice(t.from,t.to);o.deleteRange(t.from,t.to);var u=o.mapping.map(e);return o.insert(u,i.content),o.setSelection(new be(o.doc.resolve(Math.max(u-1,0)))),!0}},eu=function(){return function(t){var e=t.tr,n=t.dispatch,r=e.selection.$anchor.node();if(r.content.size>0)return!1;for(var o=e.selection.$anchor,i=o.depth;i>0;i-=1)if(o.node(i).type===r.type){if(n){var u=o.before(i),s=o.after(i);e.delete(u,s).scrollIntoView()}return!0}return!1}};function nu(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error("There is no node type named '"+t+"'. Maybe you forgot to add the extension?");return e.nodes[t]}return t}var ru=function(t){return function(e){for(var n=e.tr,r=e.state,o=e.dispatch,i=nu(t,r.schema),u=n.selection.$anchor,s=u.depth;s>0;s-=1)if(u.node(s).type===i){if(o){var a=u.before(s),c=u.after(s);n.delete(a,c).scrollIntoView()}return!0}return!1}},ou=function(t){return function(e){var n=e.tr,r=e.dispatch,o=t.from,i=t.to;return r&&n.delete(o,i),!0}},iu=function(){return function(t){var e=t.state,n=t.dispatch;return qe(e,n)}},uu=function(){return function(t){return t.commands.keyboardShortcut("Enter")}},su=function(){return function(t){var e=t.state,n=t.dispatch;return rn(e,n)}};function au(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function cu(t,e,n){void 0===n&&(n={strict:!0});var r=Object.keys(e);return!r.length||r.every(function(r){return n.strict?e[r]===t[r]:au(e[r])?e[r].test(t[r]):e[r]===t[r]})}function lu(t,e,n){return void 0===n&&(n={}),t.find(function(t){return t.type===e&&cu(Object.fromEntries(Object.keys(n).map(function(e){return[e,t.attrs[e]]})),n)})}function du(t,e,n){return void 0===n&&(n={}),!!lu(t,e,n)}function fu(t,e,n){var r;if(t&&e){var o=t.parent.childAfter(t.parentOffset);if(o.node&&o.node.marks.some(function(t){return t.type===e})||(o=t.parent.childBefore(t.parentOffset)),o.node&&o.node.marks.some(function(t){return t.type===e})&&(n=n||(null==(r=o.node.marks[0])?void 0:r.attrs),lu([].concat(o.node.marks),e,n))){for(var i=o.index,u=t.start()+o.offset,s=i+1,a=u+o.node.nodeSize;i>0&&du([].concat(t.parent.child(i-1).marks),e,n);)i-=1,u-=t.parent.child(i).nodeSize;for(;s<t.parent.childCount&&du([].concat(t.parent.child(s).marks),e,n);)a+=t.parent.child(s).nodeSize,s+=1;return{from:u,to:a}}}}function hu(t,e){if("string"==typeof t){if(!e.marks[t])throw Error("There is no mark type named '"+t+"'. Maybe you forgot to add the extension?");return e.marks[t]}return t}var pu=function(t,e){return void 0===e&&(e={}),function(n){var r=n.tr,o=n.state,i=n.dispatch,u=hu(t,o.schema),s=r.doc,a=r.selection,c=a.$from,l=a.from,d=a.to;if(i){var f=fu(c,u,e);if(f&&f.from<=l&&f.to>=d){var h=be.create(s,f.from,f.to);r.setSelection(h)}}return!0}},mu=function(t){return function(e){for(var n="function"==typeof t?t(e):t,r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1}};function Du(t){return t instanceof be}function vu(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),Math.min(Math.max(t,e),n)}function gu(t,e){if(void 0===e&&(e=null),!e)return null;var n=Ce.atStart(t),r=Ce.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;var o=n.from,i=r.to;return"all"===e?be.create(t,vu(0,o,i),vu(t.content.size,o,i)):be.create(t,vu(e,o,i),vu(e,o,i))}function Fu(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function yu(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Cu=function(t,e){return void 0===t&&(t=null),void 0===e&&(e={}),function(n){var r=n.editor,o=n.view,i=n.tr,u=n.dispatch;e=h({scrollIntoView:!0},e);var s=function(){(yu()||Fu())&&o.dom.focus(),"undefined"==typeof navigator||!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||yu()||Fu()||o.dom.focus({preventScroll:!0}),requestAnimationFrame(function(){r.isDestroyed||(o.focus(),(null==e?void 0:e.scrollIntoView)&&r.commands.scrollIntoView())})};if(o.hasFocus()&&null===t||!1===t)return!0;if(u&&null===t&&!Du(r.state.selection))return s(),!0;var a=gu(i.doc,t)||r.state.selection,c=r.state.selection.eq(a);return u&&(c||i.setSelection(a),c&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0}},ku=function(t,e){return function(n){return t.every(function(t,r){return e(t,h({},n,{index:r}))})}},Eu=function(t,e){return function(n){var r=n.tr;return n.commands.insertContentAt({from:r.selection.from,to:r.selection.to},t,e)}},Au=function(t){for(var e=t.childNodes,n=e.length-1;n>=0;n-=1){var r=e[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):1===r.nodeType&&Au(r)}return t};function bu(t){if("undefined"==typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");var e="<body>"+t+"</body>",n=(new window.DOMParser).parseFromString(e,"text/html").body;return Au(n)}function wu(t,e,n){if(t instanceof U||t instanceof E)return t;n=h({slice:!0,parseOptions:{}},n);var r="string"==typeof t;if("object"==typeof t&&null!==t)try{if(Array.isArray(t)&&t.length>0)return E.fromArray(t.map(function(t){return e.nodeFromJSON(t)}));var o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),wu("",e,n)}if(r){if(n.errorOnInvalidContent){var i=!1,u="",s=new ht({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:function(t){return i=!0,u="string"==typeof t?t:t.outerHTML,null}}]}})});if(n.slice?mt.fromSchema(s).parseSlice(bu(t),n.parseOptions):mt.fromSchema(s).parse(bu(t),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error("Invalid element found: "+u)})}var a=mt.fromSchema(e);return n.slice?a.parseSlice(bu(t),n.parseOptions).content:a.parse(bu(t),n.parseOptions)}return wu("",e,n)}var xu=function(t,e,n){return function(r){var o,i=r.tr,u=r.dispatch,s=r.editor;if(u){var a;n=h({parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},n);var c=function(t){s.emit("contentError",{editor:s,error:t,disableCollaboration:function(){"collaboration"in s.storage&&"object"==typeof s.storage.collaboration&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},l=h({preserveWhitespace:"full"},n.parseOptions);if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{wu(e,s.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(t){c(t)}try{a=wu(e,s.schema,{parseOptions:l,errorOnInvalidContent:null!=(o=n.errorOnInvalidContent)?o:s.options.enableContentCheck})}catch(t){return c(t),!1}var d,f="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},p=f.from,m=f.to,D=!0,v=!0;if(("type"in a?[a]:a).forEach(function(t){t.check(),D=!!D&&t.isText&&0===t.marks.length,v=!!v&&t.isBlock}),p===m&&v){var g=i.doc.resolve(p).parent;g.isTextblock&&!g.type.spec.code&&!g.childCount&&(p-=1,m+=1)}if(D){if(Array.isArray(e))d=e.map(function(t){return t.text||""}).join("");else if(e instanceof E){var F="";e.forEach(function(t){t.text&&(F+=t.text)}),d=F}else d="object"==typeof e&&e&&e.text?e.text:e;i.insertText(d,p,m)}else{d=a;var y=i.doc.resolve(p),C=y.node(),k=0===y.parentOffset,A=C.isText||C.isTextblock,b=C.content.size>0;k&&A&&b&&(p=Math.max(0,p-1)),i.replaceWith(p,m,d)}n.updateSelection&&function(t,e){var n=t.steps.length-1;if(!(n<e)){var r=t.steps[n];if(r instanceof qt||r instanceof Wt){var o=t.mapping.maps[n],i=0;o.forEach(function(t,e,n,r){0===i&&(i=r)}),t.setSelection(Ce.near(t.doc.resolve(i),-1))}}}(i,i.steps.length-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:p,text:d}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:p,text:d})}return!0}},Bu=function(){return function(t){return function(t,e){var n,r=t.selection,o=r instanceof xe;if(o){if(r.node.isTextblock||!ee(t.doc,r.from))return!1;n=r.from}else if(null==(n=re(t.doc,r.from,-1)))return!1;if(e){var i=t.tr.join(n);o&&i.setSelection(xe.create(i.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0}(t.state,t.dispatch)}},Su=function(){return function(t){return function(t,e){var n,r=t.selection;if(r instanceof xe){if(r.node.isTextblock||!ee(t.doc,r.to))return!1;n=r.to}else if(null==(n=re(t.doc,r.to,1)))return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0}(t.state,t.dispatch)}},Mu=function(){return function(t){var e=t.state,n=t.dispatch;return Ke(e,n)}},Tu=function(){return function(t){var e=t.state,n=t.dispatch;return Xe(e,n)}},Ou=function(){return function(t){var e=t.state,n=t.dispatch,r=t.tr;try{var o=re(e.doc,e.selection.$from.pos,-1);return null!=o&&(r.join(o,2),n&&n(r),!0)}catch(t){return!1}}},Nu=function(){return function(t){var e=t.state,n=t.dispatch,r=t.tr;try{var o=re(e.doc,e.selection.$from.pos,1);return null!=o&&(r.join(o,2),n&&n(r),!0)}catch(t){return!1}}},Ru=function(){return function(t){return function(t,e){var n=We(t,void 0);if(!n)return!1;var r=Ze(n);return!!r&&Ue(t,r,e)}(t.state,t.dispatch)}},Iu=function(){return function(t){return function(t,e){var n=Qe(t,void 0);if(!n)return!1;var r=tn(n);return!!r&&Ue(t,r,e)}(t.state,t.dispatch)}};function Lu(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var Pu=function(t){return function(e){var n=e.editor,r=e.view,o=e.tr,i=e.dispatch,u=function(t){var e,n,r,o,i=t.split(/-(?!$)/),u=i[i.length-1];"Space"===u&&(u=" ");for(var s=0;s<i.length-1;s+=1){var a=i[s];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);yu()||Lu()?o=!0:n=!0}}return e&&(u="Alt-"+u),n&&(u="Ctrl-"+u),o&&(u="Meta-"+u),r&&(u="Shift-"+u),u}(t).split(/-(?!$)/),s=u.find(function(t){return!["Alt","Ctrl","Meta","Shift"].includes(t)}),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:u.includes("Alt"),ctrlKey:u.includes("Ctrl"),metaKey:u.includes("Meta"),shiftKey:u.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(function(){r.someProp("handleKeyDown",function(t){return t(r,a)})});return null==c||c.steps.forEach(function(t){var e=t.map(o.mapping);e&&i&&o.maybeStep(e)}),!0}};function zu(t,e,n){void 0===n&&(n={});var r=t.selection,o=r.from,i=r.to,u=r.empty,s=e?nu(e,t.schema):null,a=[];t.doc.nodesBetween(o,i,function(t,e){if(!t.isText){var n=Math.max(o,e),r=Math.min(i,e+t.nodeSize);a.push({node:t,from:n,to:r})}});var c=i-o,l=a.filter(function(t){return!s||s.name===t.node.type.name}).filter(function(t){return cu(t.node.attrs,n,{strict:!1})});return u?!!l.length:l.reduce(function(t,e){return t+e.to-e.from},0)>=c}var $u=function(t,e){return void 0===e&&(e={}),function(n){var r=n.state,o=n.dispatch;return!!zu(r,nu(t,r.schema),e)&&function(t,e){var n=t.selection,r=n.$from,o=n.$to,i=r.blockRange(o),u=i&&Gt(i);return null!=u&&(e&&e(t.tr.lift(i,u).scrollIntoView()),!0)}(r,o)}},ju=function(){return function(t){var e=t.state,n=t.dispatch;return un(e,n)}},Hu=function(t){return function(e){var n,r=e.state,o=e.dispatch;return(n=nu(t,r.schema),function(t,e){var r=t.selection,o=r.$from,i=r.$to,u=o.blockRange(i,function(t){return t.childCount>0&&t.firstChild.type==n});return!!u&&(!e||(o.node(u.depth-1).type==n?function(t,e,n,r){var o=t.tr,i=r.end,u=r.$to.end(r.depth);i<u&&(o.step(new Wt(i-1,u,i,u,new S(E.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new W(o.doc.resolve(r.$from.pos),o.doc.resolve(u),r.depth));var s=Gt(r);if(null==s)return!1;o.lift(r,s);var a=o.doc.resolve(o.mapping.map(i,-1)-1);return ee(o.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&o.join(a.pos),e(o.scrollIntoView()),!0}(t,e,n,u):function(t,e,n){for(var r=t.tr,o=n.parent,i=n.end,u=n.endIndex-1,s=n.startIndex;u>s;u--)i-=o.child(u).nodeSize,r.delete(i-1,i+1);var a=r.doc.resolve(n.start),c=a.nodeAfter;if(r.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;var l=0==n.startIndex,d=n.endIndex==o.childCount,f=a.node(-1),h=a.index(-1);if(!f.canReplace(h+(l?0:1),h+1,c.content.append(d?E.empty:E.from(o))))return!1;var p=a.pos,m=p+c.nodeSize;return r.step(new Wt(p-(l?1:0),m+(d?1:0),p+1,m-1,new S((l?E.empty:E.from(o.copy(E.empty))).append(d?E.empty:E.from(o.copy(E.empty))),l?0:1,d?0:1),l?0:1)),e(r.scrollIntoView()),!0}(t,e,u)))})(r,o)}},Vu=function(){return function(t){var e=t.state,n=t.dispatch;return en(e,n)}};function _u(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function qu(t,e){var n="string"==typeof e?[e]:e;return Object.keys(t).reduce(function(e,r){return n.includes(r)||(e[r]=t[r]),e},{})}var Wu=function(t,e){return function(n){var r=n.tr,o=n.state,i=n.dispatch,u=null,s=null,a=_u("string"==typeof t?t:t.name,o.schema);if(!a)return!1;"node"===a&&(u=nu(t,o.schema)),"mark"===a&&(s=hu(t,o.schema));var c=!1;return r.selection.ranges.forEach(function(t){o.doc.nodesBetween(t.$from.pos,t.$to.pos,function(t,n){u&&u===t.type&&(c=!0,i&&r.setNodeMarkup(n,void 0,qu(t.attrs,e))),s&&t.marks.length&&t.marks.forEach(function(o){s===o.type&&(c=!0,i&&r.addMark(n,n+t.nodeSize,s.create(qu(o.attrs,e))))})})}),c}},Ku=function(){return function(t){var e=t.tr;return t.dispatch&&e.scrollIntoView(),!0}},Uu=function(){return function(t){var e=t.tr;if(t.dispatch){var n=new Se(e.doc);e.setSelection(n)}return!0}},Ju=function(){return function(t){var e=t.state,n=t.dispatch;return Ge(e,n)}},Gu=function(){return function(t){var e=t.state,n=t.dispatch;return Ye(e,n)}},Zu=function(){return function(t){return e=t.state,n=t.dispatch,o=e.selection,i=o.$from,u=o.to,0!=(s=i.sharedDepth(u))&&(r=i.before(s),n&&n(e.tr.setSelection(xe.create(e.doc,r))),!0);var e,n,r,o,i,u,s}},Qu=function(){return function(t){var e=t.state,n=t.dispatch;return ln(e,n)}},Xu=function(){return function(t){var e=t.state,n=t.dispatch;return cn(e,n)}};function Yu(t,e,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),wu(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var ts=function(t,e){var n=void 0===e?{}:e,r=n.errorOnInvalidContent,o=n.emitUpdate,i=void 0===o||o,u=n.parseOptions,s=void 0===u?{}:u;return function(e){var n=e.editor,o=e.tr,u=e.dispatch,a=e.commands,c=o.doc;if("full"!==s.preserveWhitespace){var l=Yu(t,n.schema,s,{errorOnInvalidContent:null!=r?r:n.options.enableContentCheck});return u&&o.replaceWith(0,c.content.size,l).setMeta("preventUpdate",!i),!0}return u&&o.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:c.content.size},t,{parseOptions:s,errorOnInvalidContent:null!=r?r:n.options.enableContentCheck})}};function es(t,e){var n=hu(e,t.schema),r=t.selection,o=r.from,i=r.to,u=r.empty,s=[];u?(t.storedMarks&&s.push.apply(s,t.storedMarks),s.push.apply(s,t.selection.$head.marks())):t.doc.nodesBetween(o,i,function(t){s.push.apply(s,t.marks)});var a=s.find(function(t){return t.type.name===n.name});return a?h({},a.attrs):{}}function ns(t,e){var n=new Fe(t);return e.forEach(function(t){t.steps.forEach(function(t){n.step(t)})}),n}function rs(t){return function(e){return function(t,e){for(var n=t.depth;n>0;n-=1){var r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}(e.$from,t)}}function is(t,e,n){return void 0===t.config[e]&&t.parent?is(t.parent,e,n):"function"==typeof t.config[e]?t.config[e].bind(h({},n,{parent:t.parent?is(t.parent,e,n):null})):t.config[e]}function us(t){return t.map(function(t){var e=is(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t].concat(us(e())):t}).flat(10)}function ss(t,e){var n=bt.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function as(t){return"function"==typeof t}function cs(t,e){if(void 0===e&&(e=void 0),as(t)){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e?t.bind(e).apply(void 0,r):t.apply(void 0,r)}return t}function ls(t){return{baseExtensions:t.filter(function(t){return"extension"===t.type}),nodeExtensions:t.filter(function(t){return"node"===t.type}),markExtensions:t.filter(function(t){return"mark"===t.type})}}function ds(t){var e=[],n=ls(t),r=n.nodeExtensions,o=n.markExtensions,i=[].concat(r,o),u={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(function(t){var n=is(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage,extensions:i});n&&n().forEach(function(t){t.types.forEach(function(n){Object.entries(t.attributes).forEach(function(t){var r=t[0],o=t[1];e.push({type:n,name:r,attribute:h({},u,o)})})})})}),i.forEach(function(t){var n={name:t.name,options:t.options,storage:t.storage},r=is(t,"addAttributes",n);if(r){var o=r();Object.entries(o).forEach(function(n){var r=n[0],o=n[1],i=h({},u,o);"function"==typeof(null==i?void 0:i.default)&&(i.default=i.default()),(null==i?void 0:i.isRequired)&&void 0===(null==i?void 0:i.default)&&delete i.default,e.push({type:t.name,name:r,attribute:i})})}}),e}function fs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.filter(function(t){return!!t}).reduce(function(t,e){var n=h({},t);return Object.entries(e).forEach(function(t){var e=t[0],r=t[1];if(n[e])if("class"===e){var o=r?String(r).split(" "):[],i=n[e]?n[e].split(" "):[],u=o.filter(function(t){return!i.includes(t)});n[e]=[].concat(i,u).join(" ")}else if("style"===e){var s=r?r.split(";").map(function(t){return t.trim()}).filter(Boolean):[],a=n[e]?n[e].split(";").map(function(t){return t.trim()}).filter(Boolean):[],c=new Map;a.forEach(function(t){var e=t.split(":").map(function(t){return t.trim()}),n=e[0],r=e[1];c.set(n,r)}),s.forEach(function(t){var e=t.split(":").map(function(t){return t.trim()}),n=e[0],r=e[1];c.set(n,r)}),n[e]=Array.from(c.entries()).map(function(t){return t[0]+": "+t[1]}).join("; ")}else n[e]=r;else n[e]=r}),n},{})}function hs(t,e){return e.filter(function(e){return e.type===t.type.name}).filter(function(t){return t.attribute.rendered}).map(function(e){var n;return e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:((n={})[e.name]=t.attrs[e.name],n)}).reduce(function(t,e){return fs(t,e)},{})}function ps(t,e){return"style"in t?t:h({},t,{getAttrs:function(n){var r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;var o=e.reduce(function(t,e){var r,o=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return null==o?t:h({},t,((r={})[e.name]=o,r))},{});return h({},r,o)}})}function ms(t){return Object.fromEntries(Object.entries(t).filter(function(t){var e=t[0],n=t[1];return("attrs"!==e||!function(t){return void 0===t&&(t={}),0===Object.keys(t).length&&t.constructor===Object}(n))&&null!=n}))}function Ds(t){var e,n,r={};return!(null==(e=null==t?void 0:t.attribute)?void 0:e.isRequired)&&"default"in((null==t?void 0:t.attribute)||{})&&(r.default=t.attribute.default),void 0!==(null==(n=null==t?void 0:t.attribute)?void 0:n.validate)&&(r.validate=t.attribute.validate),[t.name,r]}function vs(t,e){var n,r=ds(t),o=ls(t),i=o.nodeExtensions,u=o.markExtensions,s=null==(n=i.find(function(t){return is(t,"topNode")}))?void 0:n.name,a=Object.fromEntries(i.map(function(n){var o=r.filter(function(t){return t.type===n.name}),i={name:n.name,options:n.options,storage:n.storage,editor:e},u=t.reduce(function(t,e){var r=is(e,"extendNodeSchema",i);return h({},t,r?r(n):{})},{}),s=ms(h({},u,{content:cs(is(n,"content",i)),marks:cs(is(n,"marks",i)),group:cs(is(n,"group",i)),inline:cs(is(n,"inline",i)),atom:cs(is(n,"atom",i)),selectable:cs(is(n,"selectable",i)),draggable:cs(is(n,"draggable",i)),code:cs(is(n,"code",i)),whitespace:cs(is(n,"whitespace",i)),linebreakReplacement:cs(is(n,"linebreakReplacement",i)),defining:cs(is(n,"defining",i)),isolating:cs(is(n,"isolating",i)),attrs:Object.fromEntries(o.map(Ds))})),a=cs(is(n,"parseHTML",i));a&&(s.parseDOM=a.map(function(t){return ps(t,o)}));var c=is(n,"renderHTML",i);c&&(s.toDOM=function(t){return c({node:t,HTMLAttributes:hs(t,o)})});var l=is(n,"renderText",i);return l&&(s.toText=l),[n.name,s]})),c=Object.fromEntries(u.map(function(n){var o=r.filter(function(t){return t.type===n.name}),i={name:n.name,options:n.options,storage:n.storage,editor:e},u=t.reduce(function(t,e){var r=is(e,"extendMarkSchema",i);return h({},t,r?r(n):{})},{}),s=ms(h({},u,{inclusive:cs(is(n,"inclusive",i)),excludes:cs(is(n,"excludes",i)),group:cs(is(n,"group",i)),spanning:cs(is(n,"spanning",i)),code:cs(is(n,"code",i)),attrs:Object.fromEntries(o.map(Ds))})),a=cs(is(n,"parseHTML",i));a&&(s.parseDOM=a.map(function(t){return ps(t,o)}));var c=is(n,"renderHTML",i);return c&&(s.toDOM=function(t){return c({mark:t,HTMLAttributes:hs(t,o)})}),[n.name,s]}));return new ht({topNode:s,nodes:a,marks:c})}function gs(t){return t.sort(function(t,e){var n=is(t,"priority")||100,r=is(e,"priority")||100;return n>r?-1:n<r?1:0})}function Fs(t){var e,n,r=gs(us(t)),o=(n=(e=r.map(function(t){return t.name})).filter(function(t,n){return e.indexOf(t)!==n}),Array.from(new Set(n)));return o.length&&console.warn("[tiptap warn]: Duplicate extension names found: ["+o.map(function(t){return"'"+t+"'"}).join(", ")+"]. This can lead to issues."),r}function ys(t,e,n){var r=e.from,o=e.to,i=n||{},u=i.blockSeparator,s=void 0===u?"\n\n":u,a=i.textSerializers,c=void 0===a?{}:a,l="";return t.nodesBetween(r,o,function(t,n,i,u){var a;t.isBlock&&n>r&&(l+=s);var d=null==c?void 0:c[t.type.name];if(d)return i&&(l+=d({node:t,pos:n,parent:i,index:u,range:e})),!1;t.isText&&(l+=null==(a=null==t?void 0:t.text)?void 0:a.slice(Math.max(r,n)-n,o-n))}),l}function Cs(t){return Object.fromEntries(Object.entries(t.nodes).filter(function(t){return t[1].spec.toText}).map(function(t){return[t[0],t[1].spec.toText]}))}function ks(t,e){var n=_u("string"==typeof e?e:e.name,t.schema);return"node"===n?function(t,e){var n=nu(e,t.schema),r=t.selection,o=r.from,i=r.to,u=[];t.doc.nodesBetween(o,i,function(t){u.push(t)});var s=u.reverse().find(function(t){return t.type.name===n.name});return s?h({},s.attrs):{}}(t,e):"mark"===n?es(t,e):{}}function Es(t){var e=t.mapping,n=t.steps,r=[];return e.maps.forEach(function(t,o){var i=[];if(t.ranges.length)t.forEach(function(t,e){i.push({from:t,to:e})});else{var u=n[o],s=u.from,a=u.to;if(void 0===s||void 0===a)return;i.push({from:s,to:a})}i.forEach(function(t){var n=t.from,i=t.to,u=e.slice(o).map(n,-1),s=e.slice(o).map(i),a=e.invert().map(u,-1),c=e.invert().map(s);r.push({oldRange:{from:a,to:c},newRange:{from:u,to:s}})})}),function(t){var e=function(t,e){void 0===e&&(e=JSON.stringify);var n={};return t.filter(function(t){var r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(t);return 1===e.length?e:e.filter(function(t,n){var r=e.filter(function(t,e){return e!==n});return!r.some(function(e){return t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to})})}(r)}function As(t,e,n){var r=[];return t===e?n.resolve(t).marks().forEach(function(e){var o=fu(n.resolve(t),e.type);o&&r.push(h({mark:e},o))}):n.nodesBetween(t,e,function(t,e){t&&void 0!==(null==t?void 0:t.nodeSize)&&r.push.apply(r,t.marks.map(function(n){return{from:e,to:e+t.nodeSize,mark:n}}))}),r}function bs(t,e){return e.nodes[t]||e.marks[t]||null}function ws(t,e,n){return Object.fromEntries(Object.entries(n).filter(function(n){var r=n[0],o=t.find(function(t){return t.type===e&&t.name===r});return!!o&&o.attribute.keepOnSplit}))}function xs(t,e,n){void 0===n&&(n={});var r=t.selection,o=r.empty,i=r.ranges,u=e?hu(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter(function(t){return!u||u.name===t.type.name}).find(function(t){return cu(t.attrs,n,{strict:!1})});var s=0,a=[];if(i.forEach(function(e){var n=e.$from,r=e.$to,o=n.pos,i=r.pos;t.doc.nodesBetween(o,i,function(t,e){if(t.isText||t.marks.length){var n=Math.max(o,e),r=Math.min(i,e+t.nodeSize);s+=r-n,a.push.apply(a,t.marks.map(function(t){return{mark:t,from:n,to:r}}))}})}),0===s)return!1;var c=a.filter(function(t){return!u||u.name===t.mark.type.name}).filter(function(t){return cu(t.mark.attrs,n,{strict:!1})}).reduce(function(t,e){return t+e.to-e.from},0),l=a.filter(function(t){return!u||t.mark.type!==u&&t.mark.type.excludes(u)}).reduce(function(t,e){return t+e.to-e.from},0);return(c>0?c+l:c)>=s}function Bs(t,e){return Array.isArray(e)?e.some(function(e){return("string"==typeof e?e:e.name)===t.name}):e}function Ss(t,e){var n=ls(e).nodeExtensions.find(function(e){return e.name===t});if(!n)return!1;var r=cs(is(n,"group",{name:n.name,options:n.options,storage:n.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function Ms(t,e){var n,r=void 0===e?{}:e,o=r.checkChildren,i=void 0===o||o,u=r.ignoreWhitespace,s=void 0!==u&&u;if(s){if("hardBreak"===t.type.name)return!0;if(t.isText)return/^\s*$/m.test(null!=(n=t.text)?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(0===t.content.childCount)return!0;if(i){var a=!0;return t.content.forEach(function(t){!1!==a&&(Ms(t,{ignoreWhitespace:s,checkChildren:i})||(a=!1))}),a}return!1}function Ts(t){return t instanceof xe}var Os=function(){function t(t){this.position=t}return t.fromJSON=function(e){return new t(e.position)},t.prototype.toJSON=function(){return{position:this.position}},t}();function Ns(t,e){var n=e.mapping.mapResult(t.position);return{position:new Os(n.pos),mapResult:n}}function Rs(t){return new Os(t)}var Is=function(t,e){return void 0===e&&(e={}),function(n){var r=n.tr,o=n.state,i=n.dispatch,u=r.selection,s=u.empty,a=u.ranges,c=hu(t,o.schema);if(i)if(s){var l=es(o,c);r.addStoredMark(c.create(h({},l,e)))}else a.forEach(function(t){var n=t.$from.pos,i=t.$to.pos;o.doc.nodesBetween(n,i,function(t,o){var u=Math.max(o,n),s=Math.min(o+t.nodeSize,i);t.marks.find(function(t){return t.type===c})?t.marks.forEach(function(t){c===t.type&&r.addMark(u,s,c.create(h({},t.attrs,e)))}):r.addMark(u,s,c.create(e))})});return function(t,e,n){var r,o=e.selection,i=null;if(Du(o)&&(i=o.$cursor),i){var u=null!=(r=t.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(u)||!u.some(function(t){return t.type.excludes(n)}))}return o.ranges.some(function(e){var r=e.$from,o=e.$to,i=0===r.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(r.pos,o.pos,function(t,e,r){if(i)return!1;if(t.isInline){var o=!r||r.type.allowsMarkType(n),u=!!n.isInSet(t.marks)||!t.marks.some(function(t){return t.type.excludes(n)});i=o&&u}return!i}),i})}(o,r,c)}},Ls=function(t,e){return function(n){return n.tr.setMeta(t,e),!0}},Ps=function(t,e){return void 0===e&&(e={}),function(n){var r,o=n.state,i=n.dispatch,u=n.chain,s=nu(t,o.schema);return o.selection.$anchor.sameParent(o.selection.$head)&&(r=o.selection.$anchor.parent.attrs),s.isTextblock?u().command(function(t){var n=t.commands;return!!dn(s,h({},r,e))(o)||n.clearNodes()}).command(function(t){var n=t.state;return dn(s,h({},r,e))(n,i)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},zs=function(t){return function(e){var n=e.tr;if(e.dispatch){var r=n.doc,o=vu(t,0,r.content.size),i=xe.create(r,o);n.setSelection(i)}return!0}},$s=function(t,e){return function(n){var r,o,i=n.tr,u=n.state,s=n.dispatch,a=u.selection;return"number"==typeof e?(r=e,o=e):e&&"from"in e&&"to"in e?(r=e.from,o=e.to):(r=a.from,o=a.to),s&&i.doc.nodesBetween(r,o,function(e,n){e.isText||i.setNodeMarkup(n,void 0,h({},e.attrs,{dir:t}))}),!0}},js=function(t){return function(e){var n=e.tr;if(e.dispatch){var r=n.doc,o="number"==typeof t?{from:t,to:t}:t,i=o.from,u=o.to,s=be.atStart(r).from,a=be.atEnd(r).to,c=vu(i,s,a),l=vu(u,s,a),d=be.create(r,c,l);n.setSelection(d)}return!0}},Hs=function(t){return function(e){var n,r=e.state,o=e.dispatch,i=nu(t,r.schema);return(n=i,function(t,e){var r=t.selection,o=r.$from,i=r.$to,u=o.blockRange(i,function(t){return t.childCount>0&&t.firstChild.type==n});if(!u)return!1;var s=u.startIndex;if(0==s)return!1;var a=u.parent,c=a.child(s-1);if(c.type!=n)return!1;if(e){var l=c.lastChild&&c.lastChild.type==a.type,d=E.from(l?n.create():null),f=new S(E.from(n.create(null,E.from(a.type.create(null,d)))),l?3:1,0),h=u.start,p=u.end;e(t.tr.step(new Wt(h-(l?3:1),p,h,p,f,1,!0)).scrollIntoView())}return!0})(r,o)}};function Vs(t,e){var n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){var r=n.filter(function(t){return null==e?void 0:e.includes(t.type.name)});t.tr.ensureMarks(r)}}var _s=function(t){var e=(void 0===t?{}:t).keepMarks,n=void 0===e||e;return function(t){var e=t.tr,r=t.state,o=t.dispatch,i=t.editor,u=e.selection,s=e.doc,a=u.$from,c=u.$to,l=ws(i.extensionManager.attributes,a.node().type.name,a.node().attrs);if(u instanceof xe&&u.node.isBlock)return!(!a.parentOffset||!te(s,a.pos)||(o&&(n&&Vs(r,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),0));if(!a.parent.isBlock)return!1;var d=c.parentOffset===c.parent.content.size,f=0===a.depth?void 0:function(t){for(var e=0;e<t.edgeCount;e+=1){var n=t.edge(e).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1))),h=d&&f?[{type:f,attrs:l}]:void 0,p=te(e.doc,e.mapping.map(a.pos),1,h);if(h||p||!te(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)||(p=!0,h=f?[{type:f,attrs:l}]:void 0),o){if(p&&(u instanceof be&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),f&&!d&&!a.parentOffset&&a.parent.type!==f)){var m=e.mapping.map(a.before()),D=e.doc.resolve(m);a.node(-1).canReplaceWith(D.index(),D.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&Vs(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return p}},qs=function(t,e){return void 0===e&&(e={}),function(n){var r,o=n.tr,i=n.state,u=n.dispatch,s=n.editor,a=nu(t,i.schema),c=i.selection,l=c.$from,d=c.$to,f=i.selection.node;if(f&&f.isBlock||l.depth<2||!l.sameParent(d))return!1;var p=l.node(-1);if(p.type!==a)return!1;var m=s.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(u){for(var D=E.empty,v=l.index(-1)?1:l.index(-2)?2:3,g=l.depth-v;g>=l.depth-3;g-=1)D=E.from(l.node(g).copy(D));var F=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,y=h({},ws(m,l.node().type.name,l.node().attrs),e),C=(null==(r=a.contentMatch.defaultType)?void 0:r.createAndFill(y))||void 0;D=D.append(E.from(a.createAndFill(null,C)||void 0));var k=l.before(l.depth-(v-1));o.replace(k,l.after(-F),new S(D,4-v,0));var A=-1;o.doc.nodesBetween(k,o.doc.content.size,function(t,e){if(A>-1)return!1;t.isTextblock&&0===t.content.size&&(A=e+1)}),A>-1&&o.setSelection(be.near(o.doc.resolve(A))),o.scrollIntoView()}return!0}var b=d.pos===l.end()?p.contentMatchAt(0).defaultType:null,w=h({},ws(m,p.type.name,p.attrs),e),x=h({},ws(m,l.node().type.name,l.node().attrs),e);o.delete(l.pos,d.pos);var B=b?[{type:a,attrs:w},{type:b,attrs:x}]:[{type:a,attrs:w}];if(!te(o.doc,l.pos,2))return!1;if(u){var M=i.selection,T=i.storedMarks,O=s.extensionManager.splittableMarks,N=T||M.$to.parentOffset&&M.$from.marks();if(o.split(l.pos,2,B).scrollIntoView(),!N||!u)return!0;var R=N.filter(function(t){return O.includes(t.type.name)});o.ensureMarks(R)}return!0}},Ws=function(t,e){var n=rs(function(t){return t.type===e})(t.selection);if(!n)return!0;var r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;var o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!ee(t.doc,n.pos)||(t.join(n.pos),!0)},Ks=function(t,e){var n=rs(function(t){return t.type===e})(t.selection);if(!n)return!0;var r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;var o=t.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!ee(t.doc,r)||(t.join(r),!0)},Us=function(t,e,n,r){return void 0===r&&(r={}),function(o){var i=o.editor,u=o.tr,s=o.state,a=o.dispatch,c=o.chain,l=o.commands,d=o.can,f=i.extensionManager,h=f.extensions,p=f.splittableMarks,m=nu(t,s.schema),D=nu(e,s.schema),v=s.selection,g=s.storedMarks,F=v.$from,y=v.$to,C=F.blockRange(y),k=g||v.$to.parentOffset&&v.$from.marks();if(!C)return!1;var E=rs(function(t){return Ss(t.type.name,h)})(v);if(C.depth>=1&&E&&C.depth-E.depth<=1){if(E.node.type===m)return l.liftListItem(D);if(Ss(E.node.type.name,h)&&m.validContent(E.node.content)&&a)return c().command(function(){return u.setNodeMarkup(E.pos,m),!0}).command(function(){return Ws(u,m)}).command(function(){return Ks(u,m)}).run()}return n&&k&&a?c().command(function(){var t=d().wrapInList(m,r),e=k.filter(function(t){return p.includes(t.type.name)});return u.ensureMarks(e),!!t||l.clearNodes()}).wrapInList(m,r).command(function(){return Ws(u,m)}).command(function(){return Ks(u,m)}).run():c().command(function(){return!!d().wrapInList(m,r)||l.clearNodes()}).wrapInList(m,r).command(function(){return Ws(u,m)}).command(function(){return Ks(u,m)}).run()}},Js=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),function(r){var o=r.state,i=r.commands,u=n.extendEmptyMarkRange,s=void 0!==u&&u,a=hu(t,o.schema);return xs(o,a,e)?i.unsetMark(a,{extendEmptyMarkRange:s}):i.setMark(a,e)}},Gs=function(t,e,n){return void 0===n&&(n={}),function(r){var o,i=r.state,u=r.commands,s=nu(t,i.schema),a=nu(e,i.schema),c=zu(i,s,n);return i.selection.$anchor.sameParent(i.selection.$head)&&(o=i.selection.$anchor.parent.attrs),c?u.setNode(a,o):u.setNode(s,h({},o,n))}},Zs=function(t,e){return void 0===e&&(e={}),function(n){var r=n.state,o=n.commands,i=nu(t,r.schema);return zu(r,i,e)?o.lift(i):o.wrapIn(i,e)}},Qs=function(){return function(t){for(var e=t.state,n=t.dispatch,r=e.plugins,o=0;o<r.length;o+=1){var i=r[o],u=void 0;if(i.spec.isInputRules&&(u=i.getState(e))){if(n){for(var s=e.tr,a=u.transform,c=a.steps.length-1;c>=0;c-=1)s.step(a.steps[c].invert(a.docs[c]));if(u.text){var l=s.doc.resolve(u.from).marks();s.replaceWith(u.from,u.to,e.schema.text(u.text,l))}else s.delete(u.from,u.to)}return!0}}return!1}},Xs=function(){return function(t){var e=t.tr,n=t.dispatch,r=e.selection,o=r.empty,i=r.ranges;return o||n&&i.forEach(function(t){e.removeMark(t.$from.pos,t.$to.pos)}),!0}},Ys=function(t,e){return void 0===e&&(e={}),function(n){var r,o=n.tr,i=n.state,u=n.dispatch,s=e.extendEmptyMarkRange,a=void 0!==s&&s,c=o.selection,l=hu(t,i.schema),d=c.$from,f=c.empty,h=c.ranges;if(!u)return!0;if(f&&a){var p=c.from,m=c.to,D=null==(r=d.marks().find(function(t){return t.type===l}))?void 0:r.attrs,v=fu(d,l,D);v&&(p=v.from,m=v.to),o.removeMark(p,m,l)}else h.forEach(function(t){o.removeMark(t.$from.pos,t.$to.pos,l)});return o.removeStoredMark(l),!0}},ta=function(t){return function(e){var n,r,o=e.tr,i=e.state,u=e.dispatch,s=i.selection;return"number"==typeof t?(n=t,r=t):t&&"from"in t&&"to"in t?(n=t.from,r=t.to):(n=s.from,r=s.to),u&&o.doc.nodesBetween(n,r,function(t,e){if(!t.isText){var n=h({},t.attrs);delete n.dir,o.setNodeMarkup(e,void 0,n)}}),!0}},ea=function(t,e){return void 0===e&&(e={}),function(n){var r=n.tr,o=n.state,i=n.dispatch,u=null,s=null,a=_u("string"==typeof t?t:t.name,o.schema);if(!a)return!1;"node"===a&&(u=nu(t,o.schema)),"mark"===a&&(s=hu(t,o.schema));var c=!1;return r.selection.ranges.forEach(function(t){var n,a,l,d,f=t.$from.pos,p=t.$to.pos;r.selection.empty?o.doc.nodesBetween(f,p,function(t,e){u&&u===t.type&&(c=!0,l=Math.max(e,f),d=Math.min(e+t.nodeSize,p),n=e,a=t)}):o.doc.nodesBetween(f,p,function(t,o){o<f&&u&&u===t.type&&(c=!0,l=Math.max(o,f),d=Math.min(o+t.nodeSize,p),n=o,a=t),o>=f&&o<=p&&(u&&u===t.type&&(c=!0,i&&r.setNodeMarkup(o,void 0,h({},t.attrs,e))),s&&t.marks.length&&t.marks.forEach(function(n){if(s===n.type&&(c=!0,i)){var u=Math.max(o,f),a=Math.min(o+t.nodeSize,p);r.addMark(u,a,s.create(h({},n.attrs,e)))}}))}),a&&(void 0!==n&&i&&r.setNodeMarkup(n,void 0,h({},a.attrs,e)),s&&a.marks.length&&a.marks.forEach(function(t){s===t.type&&i&&r.addMark(l,d,s.create(h({},t.attrs,e)))}))}),c}},na=function(t,e){return void 0===e&&(e={}),function(n){var r,o,i=n.state,u=n.dispatch,s=nu(t,i.schema);return(r=s,void 0===(o=e)&&(o=null),function(t,e){var n=t.selection,i=n.$from,u=n.$to,s=i.blockRange(u),a=s&&Zt(s,r,o);return!!a&&(e&&e(t.tr.wrap(s,a).scrollIntoView()),!0)})(i,u)}},ra=function(t,e){return void 0===e&&(e={}),function(n){var r,o,i=n.state,u=n.dispatch;return(r=nu(t,i.schema),void 0===(o=e)&&(o=null),function(t,e){var n=t.selection,i=n.$from,u=n.$to,s=i.blockRange(u);if(!s)return!1;var a=e?t.tr:null;return!!function(t,e,n,r){void 0===r&&(r=null);var o=!1,i=e,u=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&0==e.startIndex){if(0==e.$from.index(e.depth-1))return!1;var s=u.resolve(e.start-2);i=new W(s,s,e.depth),e.endIndex<e.parent.childCount&&(e=new W(e.$from,u.resolve(e.$to.end(e.depth)),e.depth)),o=!0}var a=Zt(i,n,r,e);return!!a&&(t&&function(t,e,n,r,o){for(var i=E.empty,u=n.length-1;u>=0;u--)i=E.from(n[u].type.create(n[u].attrs,i));t.step(new Wt(e.start-(r?2:0),e.end,e.start,e.end,new S(i,0,0),n.length,!0));for(var s=0,a=0;a<n.length;a++)n[a].type==o&&(s=a+1);for(var c=n.length-s,l=e.start+n.length-(r?2:0),d=e.parent,f=e.startIndex,h=e.endIndex,p=!0;f<h;f++,p=!1)!p&&te(t.doc,l,c)&&(t.split(l,c),l+=2*c),l+=d.child(f).nodeSize}(t,e,a,o,n),!0)}(a,s,r,o)&&(e&&e(a.scrollIntoView()),!0)})(i,u)}},oa=function(){function t(){this.callbacks={}}var e=t.prototype;return e.on=function(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this},e.emit=function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=this.callbacks[t];return i&&i.forEach(function(t){return t.apply(e,r)}),this},e.off=function(t,e){var n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(function(t){return t!==e}):delete this.callbacks[t]),this},e.once=function(t,e){var n=this,r=function(){n.off(t,r);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];e.apply(n,i)};return this.on(t,r)},e.removeAllListeners=function(){this.callbacks={}},t}(),ia=function(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=null==(e=t.undoable)||e};function ua(t){var e,n=t.editor,r=t.from,o=t.to,i=t.text,u=t.rules,s=t.plugin,a=n.view;if(a.composing)return!1;var c=a.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(e=c.nodeBefore||c.nodeAfter)?void 0:e.marks.find(function(t){return t.type.spec.code})))return!1;var l=!1,d=function(t,e){void 0===e&&(e=500);var n="",r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,function(t,e,o,i){var u,s,a=(null==(s=(u=t.type.spec).toText)?void 0:s.call(u,{node:t,pos:e,parent:o,index:i}))||t.textContent||"%leaf%";n+=t.isAtom&&!t.isText?a:a.slice(0,Math.max(0,r-e))}),n}(c)+i;return u.forEach(function(t){if(!l){var e=function(t,e){if(au(e))return e.exec(t);var n=e(t);if(!n)return null;var r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r}(d,t.find);if(e){var u=a.state.tr,c=Ki({state:a.state,transaction:u}),f={from:r-(e[0].length-i.length),to:o},h=new Ui({editor:n,state:c}),p=h.commands,m=h.chain,D=h.can;null!==t.handler({state:c,range:f,match:e,commands:p,chain:m,can:D})&&u.steps.length&&(t.undoable&&u.setMeta(s,{transform:u,from:r,to:o,text:i}),a.dispatch(u),l=!0)}}}),l}function sa(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function aa(t,e){var n=h({},t);return sa(t)&&sa(e)&&Object.keys(e).forEach(function(r){sa(e[r])&&sa(t[r])?n[r]=aa(t[r],e[r]):n[r]=e[r]}),n}var ca=function(){function t(t){void 0===t&&(t={}),this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=h({},this.config,t),this.name=this.config.name}var e=t.prototype;return e.configure=function(t){var e=this;void 0===t&&(t={});var n=this.extend(h({},this.config,{addOptions:function(){return aa(e.options,t)}}));return n.name=this.name,n.parent=this.parent,n},e.extend=function(t){void 0===t&&(t={});var e=new this.constructor(h({},this.config,t));return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e},f(t,[{key:"options",get:function(){return h({},cs(is(this,"addOptions",{name:this.name}))||{})}},{key:"storage",get:function(){return h({},cs(is(this,"addStorage",{name:this.name,options:this.options}))||{})}}])}(),la=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).type="mark",e}a(e,t),e.create=function(t){return void 0===t&&(t={}),new e("function"==typeof t?t():t)},e.handleExit=function(t){var e=t.editor,n=t.mark,r=e.state.tr,o=e.state.selection.$from;if(o.pos===o.end()){var i=o.marks();if(!i.find(function(t){return(null==t?void 0:t.type.name)===n.name}))return!1;var u=i.find(function(t){return(null==t?void 0:t.type.name)===n.name});return u&&r.removeStoredMark(u),r.insertText(" ",o.pos),e.view.dispatch(r),!0}return!1};var n=e.prototype;return n.configure=function(e){return t.prototype.configure.call(this,e)},n.extend=function(e){var n="function"==typeof e?e():e;return t.prototype.extend.call(this,n)},e}(ca),da=function(t){this.find=t.find,this.handler=t.handler};var fa=null;function ha(t){var e,n=t.editor,r=t.rules,o=null,i=!1,u=!1,s="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{e="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch(t){e=null}var a=function(t){var r=t.state,o=t.from,i=t.to,u=t.rule,a=t.pasteEvt,c=r.tr,l=Ki({state:r,transaction:c});if(function(t){var e=t.editor,n=t.state,r=t.from,o=t.to,i=t.rule,u=t.pasteEvent,s=t.dropEvent,a=new Ui({editor:e,state:n}),c=a.commands,l=a.chain,d=a.can,f=[];return n.doc.nodesBetween(r,o,function(t,e){var a,h,p,m,D;if(!(null==(h=null==(a=t.type)?void 0:a.spec)?void 0:h.code)&&(t.isText||t.isTextblock||t.isInline)){var v=null!=(D=null!=(m=null==(p=t.content)?void 0:p.size)?m:t.nodeSize)?D:0,g=Math.max(r,e),F=Math.min(o,e+v);g>=F||function(t,e,n){if(au(e))return[].concat(t.matchAll(e));var r=e(t,n);return r?r.map(function(e){var n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n}):[]}(t.isText?t.text||"":t.textBetween(g-e,F-e,void 0,""),i.find,u).forEach(function(t){if(void 0!==t.index){var e=g+t.index+1,r=e+t[0].length,o={from:n.tr.mapping.map(e),to:n.tr.mapping.map(r)},a=i.handler({state:n,range:o,match:t,commands:c,chain:l,can:d,pasteEvent:u,dropEvent:s});f.push(a)}})}}),f.every(function(t){return null!==t})}({editor:n,state:l,from:Math.max(o-1,0),to:i.b-1,rule:u,pasteEvent:a,dropEvent:e})&&c.steps.length){try{e="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch(t){e=null}return s="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}},c=r.map(function(t){return new je({view:function(t){var e=function(e){var r;(o=(null==(r=t.dom.parentElement)?void 0:r.contains(e.target))?t.dom.parentElement:null)&&(fa=n)},r=function(){fa&&(fa=null)};return window.addEventListener("dragstart",e),window.addEventListener("dragend",r),{destroy:function(){window.removeEventListener("dragstart",e),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:function(t,n){if(u=o===t.dom.parentElement,e=n,!u){var r=fa;(null==r?void 0:r.isEditable)&&setTimeout(function(){var t=r.state.selection;t&&r.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:function(t,e){var n,r=null==(n=e.clipboardData)?void 0:n.getData("text/html");return s=e,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:function(e,n,r){var o=e[0],c="paste"===o.getMeta("uiEvent")&&!i,l="drop"===o.getMeta("uiEvent")&&!u,d=o.getMeta("applyPasteRules"),f=!!d;if(c||l||f){if(f){var h=d.text;"string"==typeof h||(h=ss(E.from(h),r.schema));var p=d.from,m=p+h.length,D=function(t){var e,n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(e=n.clipboardData)||e.setData("text/html",t),n}(h);return a({rule:t,state:r,from:p,to:{b:m},pasteEvt:D})}var v=n.doc.content.findDiffStart(r.doc.content),g=n.doc.content.findDiffEnd(r.doc.content);if("number"==typeof v&&g&&v!==g.b)return a({rule:t,state:r,from:v,to:g,pasteEvt:s})}}})});return c}var pa=function(){function t(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=Fs(t),this.schema=vs(this.extensions,e),this.setupExtensions()}var e=t.prototype;return e.dispatchTransaction=function(t){var e=this,n=this.editor;return gs([].concat(this.extensions).reverse()).reduceRight(function(t,r){var o={name:r.name,options:r.options,storage:e.editor.extensionStorage[r.name],editor:n,type:bs(r.name,e.schema)},i=is(r,"dispatchTransaction",o);return i?function(e){i.call(o,{transaction:e,next:t})}:t},t)},e.setupExtensions=function(){var t=this,e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(function(t){return[t.name,t.storage]})),e.forEach(function(e){var n,r={name:e.name,options:e.options,storage:t.editor.extensionStorage[e.name],editor:t.editor,type:bs(e.name,t.schema)};"mark"===e.type&&(null==(n=cs(is(e,"keepOnSplit",r)))||n)&&t.splittableMarks.push(e.name);var o=is(e,"onBeforeCreate",r),i=is(e,"onCreate",r),u=is(e,"onUpdate",r),s=is(e,"onSelectionUpdate",r),a=is(e,"onTransaction",r),c=is(e,"onFocus",r),l=is(e,"onBlur",r),d=is(e,"onDestroy",r);o&&t.editor.on("beforeCreate",o),i&&t.editor.on("create",i),u&&t.editor.on("update",u),s&&t.editor.on("selectionUpdate",s),a&&t.editor.on("transaction",a),c&&t.editor.on("focus",c),l&&t.editor.on("blur",l),d&&t.editor.on("destroy",d)})},f(t,[{key:"commands",get:function(){var t=this;return this.extensions.reduce(function(e,n){var r=is(n,"addCommands",{name:n.name,options:n.options,storage:t.editor.extensionStorage[n.name],editor:t.editor,type:bs(n.name,t.schema)});return r?h({},e,r()):e},{})}},{key:"plugins",get:function(){var t=this,e=this.editor,n=gs([].concat(this.extensions).reverse()).flatMap(function(n){var r={name:n.name,options:n.options,storage:t.editor.extensionStorage[n.name],editor:e,type:bs(n.name,t.schema)},o=[],i=is(n,"addKeyboardShortcuts",r),u={};"mark"===n.type&&is(n,"exitable",r)&&(u.ArrowRight=function(){return la.handleExit({editor:e,mark:n})}),i&&(u=h({},u,Object.fromEntries(Object.entries(i()).map(function(t){var n=t[0],r=t[1];return[n,function(){return r({editor:e})}]}))));var s=new je({props:{handleKeyDown:_i(u)}});o.push(s);var a=is(n,"addInputRules",r);if(Bs(n,e.options.enableInputRules)&&a){var c=a();if(c&&c.length){var l=function(t){var e=t.editor,n=t.rules,r=new je({state:{init:function(){return null},apply:function(t,o,i){var u=t.getMeta(r);if(u)return u;var s=t.getMeta("applyInputRules");return!!s&&setTimeout(function(){var t=s.text;"string"==typeof t||(t=ss(E.from(t),i.schema));var o=s.from,u=o+t.length;ua({editor:e,from:o,to:u,text:t,rules:n,plugin:r})}),t.selectionSet||t.docChanged?null:o}},props:{handleTextInput:function(t,o,i,u){return ua({editor:e,from:o,to:i,text:u,rules:n,plugin:r})},handleDOMEvents:{compositionend:function(t){return setTimeout(function(){var o=t.state.selection.$cursor;o&&ua({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1}},handleKeyDown:function(t,o){if("Enter"!==o.key)return!1;var i=t.state.selection.$cursor;return!!i&&ua({editor:e,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:c}),d=Array.isArray(l)?l:[l];o.push.apply(o,d)}}var f=is(n,"addPasteRules",r);if(Bs(n,e.options.enablePasteRules)&&f){var p=f();if(p&&p.length){var m=ha({editor:e,rules:p});o.push.apply(o,m)}}var D=is(n,"addProseMirrorPlugins",r);if(D){var v=D();o.push.apply(o,v)}return o});return n}},{key:"attributes",get:function(){return ds(this.extensions)}},{key:"nodeViews",get:function(){var t=this,e=this.editor,n=ls(this.extensions).nodeExtensions;return Object.fromEntries(n.filter(function(t){return!!is(t,"addNodeView")}).map(function(n){var r=t.attributes.filter(function(t){return t.type===n.name}),o={name:n.name,options:n.options,storage:t.editor.extensionStorage[n.name],editor:e,type:nu(n.name,t.schema)},i=is(n,"addNodeView",o);if(!i)return[];var u=i();return u?[n.name,function(t,o,i,s,a){var c=hs(t,r);return u({node:t,view:o,getPos:i,decorations:s,innerDecorations:a,editor:e,extension:n,HTMLAttributes:c})}]:[]}))}},{key:"markViews",get:function(){var t=this,e=this.editor,n=ls(this.extensions).markExtensions;return Object.fromEntries(n.filter(function(t){return!!is(t,"addMarkView")}).map(function(n){var r=t.attributes.filter(function(t){return t.type===n.name}),o={name:n.name,options:n.options,storage:t.editor.extensionStorage[n.name],editor:e,type:hu(n.name,t.schema)},i=is(n,"addMarkView",o);return i?[n.name,function(t,o,u){var s=hs(t,r);return i()({mark:t,view:o,inline:u,editor:e,extension:n,HTMLAttributes:s,updateAttributes:function(n){!function(t,e,n){void 0===n&&(n={});var r=e.state,o=r.doc,i=r.tr,u=t;o.descendants(function(e,r){var o=i.mapping.map(r),s=i.mapping.map(r)+e.nodeSize,a=null;if(e.marks.forEach(function(t){if(t!==u)return!1;a=t}),a){var c=!1;if(Object.keys(n).forEach(function(t){n[t]!==a.attrs[t]&&(c=!0)}),c){var l=t.type.create(h({},t.attrs,n));i.removeMark(o,s,t.type),i.addMark(o,s,l)}}}),i.docChanged&&e.view.dispatch(i)}(t,e,n)}})}]:[]}))}}])}();pa.resolve=Fs,pa.sort=gs,pa.flatten=us,Wi({},{ClipboardTextSerializer:function(){return Da},Commands:function(){return va},Delete:function(){return ga},Drop:function(){return Fa},Editable:function(){return ya},FocusEvents:function(){return ka},Keymap:function(){return Ea},Paste:function(){return Aa},Tabindex:function(){return ba},TextDirection:function(){return wa},focusEventsPluginKey:function(){return Ca}});var ma=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).type="extension",e}a(e,t),e.create=function(t){return void 0===t&&(t={}),new e("function"==typeof t?t():t)};var n=e.prototype;return n.configure=function(e){return t.prototype.configure.call(this,e)},n.extend=function(e){var n="function"==typeof e?e():e;return t.prototype.extend.call(this,n)},e}(ca),Da=ma.create({name:"clipboardTextSerializer",addOptions:function(){return{blockSeparator:void 0}},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("clipboardTextSerializer"),props:{clipboardTextSerializer:function(){var e=t.editor,n=e.state,r=e.schema,o=n.doc,i=n.selection.ranges,u=Math.min.apply(Math,i.map(function(t){return t.$from.pos})),s=Math.max.apply(Math,i.map(function(t){return t.$to.pos})),a=Cs(r);return ys(o,{from:u,to:s},h({},void 0!==t.options.blockSeparator?{blockSeparator:t.options.blockSeparator}:{},{textSerializers:a}))}}})]}}),va=ma.create({name:"commands",addCommands:function(){return h({},Ji)}}),ga=ma.create({name:"delete",onUpdate:function(t){var e,n,r,o=this,i=t.transaction,u=t.appendedTransactions,s=function(){var t,e,n,r;if(!(null!=(r=null==(n=null==(e=null==(t=o.editor.options.coreExtensionOptions)?void 0:t.delete)?void 0:e.filterTransaction)?void 0:n.call(e,i))?r:i.getMeta("y-sync$"))){var s=ns(i.before,[i].concat(u));Es(s).forEach(function(t){s.mapping.mapResult(t.oldRange.from).deletedAfter&&s.mapping.mapResult(t.oldRange.to).deletedBefore&&s.before.nodesBetween(t.oldRange.from,t.oldRange.to,function(e,n){var r=n+e.nodeSize-2,u=t.oldRange.from<=n&&r<=t.oldRange.to;o.editor.emit("delete",{type:"node",node:e,from:n,to:r,newFrom:s.mapping.map(n),newTo:s.mapping.map(r),deletedRange:t.oldRange,newRange:t.newRange,partial:!u,editor:o.editor,transaction:i,combinedTransform:s})})});var a=s.mapping;s.steps.forEach(function(t,e){var n,r;if(t instanceof Ht){var u=a.slice(e).map(t.from,-1),c=a.slice(e).map(t.to),l=a.invert().map(u,-1),d=a.invert().map(c),f=null==(n=s.doc.nodeAt(u-1))?void 0:n.marks.some(function(e){return e.eq(t.mark)}),h=null==(r=s.doc.nodeAt(c))?void 0:r.marks.some(function(e){return e.eq(t.mark)});o.editor.emit("delete",{type:"mark",mark:t.mark,from:t.from,to:t.to,deletedRange:{from:l,to:d},newRange:{from:u,to:c},partial:Boolean(h||f),editor:o.editor,transaction:i,combinedTransform:s})}})}};null==(r=null==(n=null==(e=this.editor.options.coreExtensionOptions)?void 0:e.delete)?void 0:n.async)||r?setTimeout(s,0):s()}}),Fa=ma.create({name:"drop",addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("tiptapDrop"),props:{handleDrop:function(e,n,r,o){t.editor.emit("drop",{editor:t.editor,event:n,slice:r,moved:o})}}})]}}),ya=ma.create({name:"editable",addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("editable"),props:{editable:function(){return t.editor.options.editable}}})]}}),Ca=new _e("focusEvents"),ka=ma.create({name:"focusEvents",addProseMirrorPlugins:function(){var t=this.editor;return[new je({key:Ca,props:{handleDOMEvents:{focus:function(e,n){t.isFocused=!0;var r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:function(e,n){t.isFocused=!1;var r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Ea=ma.create({name:"keymap",addKeyboardShortcuts:function(){var t=this,e=function(){return t.editor.commands.first(function(t){var e=t.commands;return[function(){return e.undoInputRule()},function(){return e.command(function(t){var n=t.tr,r=n.selection,o=n.doc,i=r.empty,u=r.$anchor,s=u.pos,a=u.parent,c=u.parent.isTextblock&&s>0?n.doc.resolve(s-1):u,l=c.parent.type.spec.isolating,d=u.pos-u.parentOffset,f=l&&1===c.parent.childCount?d===u.pos:Ce.atStart(o).from===s;return!(!i||!a.type.isTextblock||a.textContent.length||!f||f&&"paragraph"===u.parent.type.name)&&e.clearNodes()})},function(){return e.deleteSelection()},function(){return e.joinBackward()},function(){return e.selectNodeBackward()}]})},n=function(){return t.editor.commands.first(function(t){var e=t.commands;return[function(){return e.deleteSelection()},function(){return e.deleteCurrentNode()},function(){return e.joinForward()},function(){return e.selectNodeForward()}]})},r={Enter:function(){return t.editor.commands.first(function(t){var e=t.commands;return[function(){return e.newlineInCode()},function(){return e.createParagraphNear()},function(){return e.liftEmptyBlock()},function(){return e.splitBlock()}]})},"Mod-Enter":function(){return t.editor.commands.exitCode()},Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:n,"Mod-Delete":n,"Mod-a":function(){return t.editor.commands.selectAll()}},o=h({},r),i=h({},r,{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":function(){return t.editor.commands.selectTextblockStart()},"Ctrl-e":function(){return t.editor.commands.selectTextblockEnd()}});return yu()||Lu()?i:o},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("clearDocument"),appendTransaction:function(e,n,r){if(!e.some(function(t){return t.getMeta("composition")})){var o=e.some(function(t){return t.docChanged})&&!n.doc.eq(r.doc),i=e.some(function(t){return t.getMeta("preventClearDocument")});if(o&&!i){var u=n.selection,s=u.empty,a=u.from,c=u.to,l=Ce.atStart(n.doc).from,d=Ce.atEnd(n.doc).to;if(!s&&a===l&&c===d&&Ms(r.doc)){var f=r.tr,h=Ki({state:r,transaction:f});if(new Ui({editor:t.editor,state:h}).commands.clearNodes(),f.steps.length)return f}}}}})]}}),Aa=ma.create({name:"paste",addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("tiptapPaste"),props:{handlePaste:function(e,n,r){t.editor.emit("paste",{editor:t.editor,event:n,slice:r})}}})]}}),ba=ma.create({name:"tabindex",addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("tabindex"),props:{attributes:function(){return t.editor.isEditable?{tabindex:"0"}:{}}}})]}}),wa=ma.create({name:"textDirection",addOptions:function(){return{direction:void 0}},addGlobalAttributes:function(){var t=this;return this.options.direction?[{types:ls(this.extensions).nodeExtensions.filter(function(t){return"text"!==t.name}).map(function(t){return t.name}),attributes:{dir:{default:this.options.direction,parseHTML:function(e){var n=e.getAttribute("dir");return!n||"ltr"!==n&&"rtl"!==n&&"auto"!==n?t.options.direction:n},renderHTML:function(t){return t.dir?{dir:t.dir}:{}}}}}]:[]},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("textDirection"),props:{attributes:function(){var e=t.options.direction;return e?{dir:e}:{}}}})]}}),xa=function(){function t(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=null),this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=r}var e=t.prototype;return e.closest=function(t,e){void 0===e&&(e={});for(var n=null,r=this.parent;r&&!n;){if(r.node.type.name===t)if(Object.keys(e).length>0)for(var o=r.node.attrs,i=Object.keys(e),u=0;u<i.length;u+=1){var s=i[u];if(o[s]!==e[s])break}else n=r;r=r.parent}return n},e.querySelector=function(t,e){return void 0===e&&(e={}),this.querySelectorAll(t,e,!0)[0]||null},e.querySelectorAll=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n=!1);var r=[];if(!this.children||0===this.children.length)return r;var o=Object.keys(e);return this.children.forEach(function(i){if(!(n&&r.length>0)){if(i.node.type.name===t){var u=o.every(function(t){return e[t]===i.node.attrs[t]});u&&r.push(i)}n&&r.length>0||(r=r.concat(i.querySelectorAll(t,e,n)))}}),r},e.setAttribute=function(t){var e=this.editor.state.tr;e.setNodeMarkup(this.from,void 0,h({},this.node.attrs,t)),this.editor.view.dispatch(e)},f(t,[{key:"name",get:function(){return this.node.type.name}},{key:"node",get:function(){return this.currentNode||this.resolvedPos.node()}},{key:"element",get:function(){return this.editor.view.domAtPos(this.pos).node}},{key:"depth",get:function(){var t;return null!=(t=this.actualDepth)?t:this.resolvedPos.depth}},{key:"pos",get:function(){return this.resolvedPos.pos}},{key:"content",get:function(){return this.node.content},set:function(t){var e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error("You cant set content on a block node. Tried to set content on "+this.name+" at "+this.pos);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}},{key:"attributes",get:function(){return this.node.attrs}},{key:"textContent",get:function(){return this.node.textContent}},{key:"size",get:function(){return this.node.nodeSize}},{key:"from",get:function(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}},{key:"range",get:function(){return{from:this.from,to:this.to}}},{key:"to",get:function(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}},{key:"parent",get:function(){if(0===this.depth)return null;var e=this.resolvedPos.start(this.resolvedPos.depth-1);return new t(this.resolvedPos.doc.resolve(e),this.editor)}},{key:"before",get:function(){var e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new t(e,this.editor)}},{key:"after",get:function(){var e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new t(e,this.editor)}},{key:"children",get:function(){var e=this,n=[];return this.node.content.forEach(function(r,o){var i=r.isBlock&&!r.isTextblock,u=r.isAtom&&!r.isText,s=e.pos+o+(u?0:1);if(!(s<0||s>e.resolvedPos.doc.nodeSize-2)){var a=e.resolvedPos.doc.resolve(s);if(i||!(a.depth<=e.depth)){var c=new t(a,e.editor,i,i?r:null);i&&(c.actualDepth=e.depth+1),n.push(new t(a,e.editor,i,i?r:null))}}}),n}},{key:"firstChild",get:function(){return this.children[0]||null}},{key:"lastChild",get:function(){var t=this.children;return t[t.length-1]||null}}])}(),Ba=function(t){function e(e){var n;void 0===e&&(e={}),(n=t.call(this)||this).css=null,n.className="tiptap",n.editorView=null,n.isFocused=!1,n.isInitialized=!1,n.extensionStorage={},n.instanceId=Math.random().toString(36).slice(2,9),n.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:function(){return null},onCreate:function(){return null},onMount:function(){return null},onUnmount:function(){return null},onUpdate:function(){return null},onSelectionUpdate:function(){return null},onTransaction:function(){return null},onFocus:function(){return null},onBlur:function(){return null},onDestroy:function(){return null},onContentError:function(t){throw t.error},onPaste:function(){return null},onDrop:function(){return null},onDelete:function(){return null},enableExtensionDispatchTransaction:!0},n.isCapturingTransaction=!1,n.capturedTransaction=null,n.utils={getUpdatedPosition:Ns,createMappablePosition:Rs},n.setOptions(e),n.createExtensionManager(),n.createCommandManager(),n.createSchema(),n.on("beforeCreate",n.options.onBeforeCreate),n.emit("beforeCreate",{editor:n}),n.on("mount",n.options.onMount),n.on("unmount",n.options.onUnmount),n.on("contentError",n.options.onContentError),n.on("create",n.options.onCreate),n.on("update",n.options.onUpdate),n.on("selectionUpdate",n.options.onSelectionUpdate),n.on("transaction",n.options.onTransaction),n.on("focus",n.options.onFocus),n.on("blur",n.options.onBlur),n.on("destroy",n.options.onDestroy),n.on("drop",function(t){var e=t.event,r=t.slice,o=t.moved;return n.options.onDrop(e,r,o)}),n.on("paste",function(t){var e=t.event,r=t.slice;return n.options.onPaste(e,r)}),n.on("delete",n.options.onDelete);var r=n.createDoc(),o=gu(r,n.options.autofocus);return n.editorState=ze.create({doc:r,schema:n.schema,selection:o||void 0}),n.options.element&&n.mount(n.options.element),n}a(e,t);var n=e.prototype;return n.mount=function(t){var e=this;if("undefined"==typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(function(){e.isDestroyed||(!1!==e.options.autofocus&&null!==e.options.autofocus&&e.commands.focus(e.options.autofocus),e.emit("create",{editor:e}),e.isInitialized=!0)},0)},n.unmount=function(){if(this.editorView){var t=this.editorView.dom;(null==t?void 0:t.editor)&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll("."+this.className).length)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})},n.chain=function(){return this.commandManager.chain()},n.can=function(){return this.commandManager.can()},n.injectCSS=function(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=function(t,e){var n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;var r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',document.getElementsByTagName("head")[0].appendChild(r),r}(0,this.options.injectNonce))},n.setOptions=function(t){void 0===t&&(t={}),this.options=h({},this.options,t),this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))},n.setEditable=function(t,e){void 0===e&&(e=!0),this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})},n.registerPlugin=function(t,e){var n=as(e)?e(t,[].concat(this.state.plugins)):[].concat(this.state.plugins,[t]),r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r},n.unregisterPlugin=function(t){if(!this.isDestroyed){var e=this.state.plugins,n=e;if([].concat(t).forEach(function(t){var e="string"==typeof t?t+"$":t.key;n=n.filter(function(t){return!t.key.startsWith(e)})}),e.length!==n.length){var r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}}},n.createExtensionManager=function(){var t,e,n=this,r=this.options.enableCoreExtensions?[ya,Da.configure({blockSeparator:null==(e=null==(t=this.options.coreExtensionOptions)?void 0:t.clipboardTextSerializer)?void 0:e.blockSeparator}),va,ka,Ea,ba,Fa,Aa,ga,wa.configure({direction:this.options.textDirection})].filter(function(t){return"object"!=typeof n.options.enableCoreExtensions||!1!==n.options.enableCoreExtensions[t.name]}):[],o=[].concat(r,this.options.extensions).filter(function(t){return["extension","node","mark"].includes(null==t?void 0:t.type)});this.extensionManager=new pa(o,this)},n.createCommandManager=function(){this.commandManager=new Ui({editor:this})},n.createSchema=function(){this.schema=this.extensionManager.schema},n.createDoc=function(){var t,e=this;try{t=Yu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(n){if(!(n instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(n.message)))throw n;this.emit("contentError",{editor:this,error:n,disableCollaboration:function(){"collaboration"in e.storage&&"object"==typeof e.storage.collaboration&&e.storage.collaboration&&(e.storage.collaboration.isDisabled=!0),e.options.extensions=e.options.extensions.filter(function(t){return"collaboration"!==t.name}),e.createExtensionManager()}}),t=Yu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t},n.createView=function(t){var e=this.options,n=e.editorProps,r=e.enableExtensionDispatchTransaction,o=n.dispatchTransaction||this.dispatchTransaction.bind(this),i=r?this.extensionManager.dispatchTransaction(o):o;this.editorView=new xi(t,h({},n,{attributes:h({role:"textbox"},null==n?void 0:n.attributes),dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));var u=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(u),this.prependClass(),this.injectCSS(),this.view.dom.editor=this},n.createNodeViews=function(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})},n.prependClass=function(){this.view.dom.className=this.className+" "+this.view.dom.className},n.captureTransaction=function(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;var e=this.capturedTransaction;return this.capturedTransaction=null,e},n.dispatchTransaction=function(t){var e=this;if(!this.view.isDestroyed){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(function(t){var n;return null==(n=e.capturedTransaction)?void 0:n.step(t)}):void(this.capturedTransaction=t);var n=this.state.applyTransaction(t),r=n.state,o=n.transactions,i=!this.state.selection.eq(r.selection),u=o.includes(t),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:r}),u){this.view.updateState(r),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:o.slice(1)}),i&&this.emit("selectionUpdate",{editor:this,transaction:t});var a=o.findLast(function(t){return t.getMeta("focus")||t.getMeta("blur")}),c=null==a?void 0:a.getMeta("focus"),l=null==a?void 0:a.getMeta("blur");c&&this.emit("focus",{editor:this,event:c.event,transaction:a}),l&&this.emit("blur",{editor:this,event:l.event,transaction:a}),t.getMeta("preventUpdate")||!o.some(function(t){return t.docChanged})||s.doc.eq(r.doc)||this.emit("update",{editor:this,transaction:t,appendedTransactions:o.slice(1)})}}},n.getAttributes=function(t){return ks(this.state,t)},n.isActive=function(t,e){var n="string"==typeof t?t:null,r="string"==typeof t?e:t;return function(t,e,n){if(void 0===n&&(n={}),!e)return zu(t,null,n)||xs(t,null,n);var r=_u(e,t.schema);return"node"===r?zu(t,e,n):"mark"===r&&xs(t,e,n)}(this.state,n,r)},n.getJSON=function(){return this.state.doc.toJSON()},n.getHTML=function(){return ss(this.state.doc.content,this.schema)},n.getText=function(t){var e=t||{},n=e.blockSeparator,r=void 0===n?"\n\n":n,o=e.textSerializers,i=void 0===o?{}:o;return function(t,e){return ys(t,{from:0,to:t.content.size},e)}(this.state.doc,{blockSeparator:r,textSerializers:h({},Cs(this.schema),i)})},n.destroy=function(){this.emit("destroy"),this.unmount(),this.removeAllListeners()},n.$node=function(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelector(t,e))||null},n.$nodes=function(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(t,e))||null},n.$pos=function(t){var e=this.state.doc.resolve(t);return new xa(e,this)},f(e,[{key:"storage",get:function(){return this.extensionStorage}},{key:"commands",get:function(){return this.commandManager.commands}},{key:"isEditable",get:function(){return this.options.editable&&this.view&&this.view.editable}},{key:"view",get:function(){var t=this;return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:function(e){t.editorState=e},dispatch:function(e){t.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:function(e,n){if(t.editorView)return t.editorView[n];if("state"===n)return t.editorState;if(n in e)return Reflect.get(e,n);throw new Error("[tiptap error]: The editor view is not available. Cannot access view['"+n+"']. The editor may not be mounted yet.")}})}},{key:"state",get:function(){return this.editorView&&(this.editorState=this.view.state),this.editorState}},{key:"isEmpty",get:function(){return Ms(this.state.doc)}},{key:"isDestroyed",get:function(){var t,e;return null==(e=null==(t=this.editorView)?void 0:t.isDestroyed)||e}},{key:"$doc",get:function(){return this.$pos(0)}}])}(oa);function Sa(t){return new ia({find:t.find,handler:function(e){var n=e.state,r=e.range,o=e.match,i=cs(t.getAttributes,void 0,o);if(!1===i||null===i)return null;var u=n.tr,s=o[o.length-1],a=o[0];if(s){var c=a.search(/\S/),l=r.from+a.indexOf(s),d=l+s.length;if(As(r.from,r.to,n.doc).filter(function(e){return e.mark.type.excluded.find(function(n){return n===t.type&&n!==e.mark.type})}).filter(function(t){return t.to>l}).length)return null;d<r.to&&u.delete(d,r.to),l>r.from&&u.delete(r.from+c,l);var f=r.from+c+s.length;u.addMark(r.from+c,f,t.type.create(i||{})),u.removeStoredMark(t.type)}},undoable:t.undoable})}function Ma(t){return new ia({find:t.find,handler:function(e){var n=e.state,r=e.range,o=e.match,i=n.doc.resolve(r.from),u=cs(t.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;n.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,u)},undoable:t.undoable})}function Ta(t){return new ia({find:t.find,handler:function(e){var n=e.state,r=e.range,o=e.match,i=e.chain,u=cs(t.getAttributes,void 0,o)||{},s=n.tr.delete(r.from,r.to),a=s.doc.resolve(r.from).blockRange(),c=a&&Zt(a,t.type,u);if(!c)return null;if(s.wrap(a,c),t.keepMarks&&t.editor){var l=n.selection,d=n.storedMarks,f=t.editor.extensionManager.splittableMarks,h=d||l.$to.parentOffset&&l.$from.marks();if(h){var p=h.filter(function(t){return f.includes(t.type.name)});s.ensureMarks(p)}}if(t.keepAttributes){var m="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";i().updateAttributes(m,u).run()}var D=s.doc.resolve(r.from-1).nodeBefore;D&&D.type===t.type&&ee(s.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(o,D))&&s.join(r.from-1)},undoable:t.undoable})}function Oa(t){if(!(null==t?void 0:t.trim()))return{};var e={},n=[],r=t.replace(/["']([^"']*)["']/g,function(t){return n.push(t),"__QUOTED_"+(n.length-1)+"__"}),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){var i=o.map(function(t){return t.trim().slice(1)});e.class=i.join(" ")}var u=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);u&&(e.id=u[1]),Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(function(t){var r,o=t[1],i=t[2],u=parseInt((null==(r=i.match(/__QUOTED_(\d+)__/))?void 0:r[1])||"0",10),s=n[u];s&&(e[o]=s.slice(1,-1))});var s=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return s&&s.split(/\s+/).filter(Boolean).forEach(function(t){t.match(/^[a-zA-Z][\w-]*$/)&&(e[t]=!0)}),e}function Na(t){if(!t||0===Object.keys(t).length)return"";var e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(function(t){return e.push("."+t)}),t.id&&e.push("#"+t.id),Object.entries(t).forEach(function(t){var n=t[0],r=t[1];"class"!==n&&"id"!==n&&(!0===r?e.push(n):!1!==r&&null!=r&&e.push(n+'="'+String(r)+'"'))}),e.join(" ")}function Ra(t){var e=t.nodeName,n=t.name,r=t.parseAttributes,o=void 0===r?Oa:r,i=t.serializeAttributes,u=void 0===i?Na:i,s=t.defaultAttributes,a=void 0===s?{}:s,c=t.requiredAttributes,l=void 0===c?[]:c,d=t.allowedAttributes,f=n||e;return{parseMarkdown:function(t,n){var r=h({},a,t.attributes);return n.createNode(e,r,[])},markdownTokenizer:{name:e,level:"block",start:function(t){var e,n=new RegExp("^:::"+f+"(?:\\s|$)","m"),r=null==(e=t.match(n))?void 0:e.index;return void 0!==r?r:-1},tokenize:function(t,n,r){var i=new RegExp("^:::"+f+"(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)"),u=t.match(i);if(u){var s=u[1]||"",a=o(s);if(!l.find(function(t){return!(t in a)}))return{type:e,raw:u[0],attributes:a}}}},renderMarkdown:function(t){var e=function(t){if(!d)return t;var e={};return d.forEach(function(n){n in t&&(e[n]=t[n])}),e}(t.attrs||{}),n=u(e);return":::"+f+(n?" {"+n+"}":"")+" :::"}}}function Ia(t){var e=t.nodeName,n=t.name,r=t.getContent,o=t.parseAttributes,i=void 0===o?Oa:o,u=t.serializeAttributes,s=void 0===u?Na:u,a=t.defaultAttributes,c=void 0===a?{}:a,l=t.content,d=void 0===l?"block":l,f=t.allowedAttributes,p=n||e;return{parseMarkdown:function(t,n){var o;if(r){var i=r(t);o="string"==typeof i?[{type:"text",text:i}]:i}else o="block"===d?n.parseChildren(t.tokens||[]):n.parseInline(t.tokens||[]);var u=h({},c,t.attributes);return n.createNode(e,u,o)},markdownTokenizer:{name:e,level:"block",start:function(t){var e,n=new RegExp("^:::"+p,"m"),r=null==(e=t.match(n))?void 0:e.index;return void 0!==r?r:-1},tokenize:function(t,n,r){var o,u=new RegExp("^:::"+p+"(?:\\s+\\{([^}]*)\\})?\\s*\\n"),s=t.match(u);if(s){var a=s[0],c=s[1],l=i(void 0===c?"":c),f=1,h=a.length,m="",D=/^:::([\w-]*)(\s.*)?/gm,v=t.slice(h);for(D.lastIndex=0;;){var g=D.exec(v);if(null===g)break;var F=g.index,y=g[1];if(!(null==(o=g[2])?void 0:o.endsWith(":::")))if(y)f+=1;else if(0==(f-=1)){var C=v.slice(0,F);m=C.trim();var k=t.slice(0,h+F+g[0].length),E=[];if(m)if("block"===d)for((E=r.blockTokens(C)).forEach(function(t){!t.text||t.tokens&&0!==t.tokens.length||(t.tokens=r.inlineTokens(t.text))});E.length>0;){var A=E[E.length-1];if("paragraph"!==A.type||A.text&&""!==A.text.trim())break;E.pop()}else E=r.inlineTokens(m);return{type:e,raw:k,attributes:l,content:m,tokens:E}}}}}},renderMarkdown:function(t,e){var n=function(t){if(!f)return t;var e={};return f.forEach(function(n){n in t&&(e[n]=t[n])}),e}(t.attrs||{}),r=s(n),o=r?" {"+r+"}":"",i=e.renderChildren(t.content||[],"\n\n");return":::"+p+o+"\n\n"+i+"\n\n:::"}}}function La(t){if(!t.trim())return{};for(var e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,r=n.exec(t);null!==r;){var o=r,i=o[1],u=o[2],s=o[3];e[i]=u||s,r=n.exec(t)}return e}function Pa(t){return Object.entries(t).filter(function(t){return null!=t[1]}).map(function(t){return t[0]+'="'+t[1]+'"'}).join(" ")}function za(t){var e=t.nodeName,n=t.name,r=t.getContent,o=t.parseAttributes,i=void 0===o?La:o,u=t.serializeAttributes,s=void 0===u?Pa:u,a=t.defaultAttributes,c=void 0===a?{}:a,l=t.selfClosing,d=void 0!==l&&l,f=t.allowedAttributes,p=n||e,m=p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:function(t,n){var o=h({},c,t.attributes);if(d)return n.createNode(e,o);var i=r?r(t):t.content||"";return i?n.createNode(e,o,[n.createTextNode(i)]):n.createNode(e,o,[])},markdownTokenizer:{name:e,level:"inline",start:function(t){var e=d?new RegExp("\\["+m+"\\s*[^\\]]*\\]"):new RegExp("\\["+m+"\\s*[^\\]]*\\][\\s\\S]*?\\[\\/"+m+"\\]"),n=t.match(e),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize:function(t,n,r){var o=d?new RegExp("^\\["+m+"\\s*([^\\]]*)\\]"):new RegExp("^\\["+m+"\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/"+m+"\\]"),u=t.match(o);if(u){var s="",a="";d?a=u[1]:(a=u[1],s=u[2]||"");var c=i(a.trim());return{type:e,raw:u[0],content:s.trim(),attributes:c}}}},renderMarkdown:function(t){var e="";r?e=r(t):t.content&&t.content.length>0&&(e=t.content.filter(function(t){return"text"===t.type}).map(function(t){return t.text}).join(""));var n=function(t){if(!f)return t;var e={};return f.forEach(function(n){var r="string"==typeof n?n:n.name,o="string"==typeof n?void 0:n.skipIfDefault;if(r in t){var i=t[r];if(void 0!==o&&i===o)return;e[r]=i}}),e}(t.attrs||{}),o=s(n),i=o?" "+o:"";return d?"["+p+i+"]":"["+p+i+"]"+e+"[/"+p+"]"}}}function $a(t,e,n){for(var r,o,i,u,s,a=t.split("\n"),c=[],l="",d=0,f=e.baseIndentSize||2,h=function(){var t=a[d],s=t.match(e.itemPattern);if(!s)return c.length>0?0:""===t.trim()?(d+=1,l=""+l+t+"\n",1):{v:void 0};var h=e.extractItemData(s),p=h.indentLevel,m=h.mainContent;l=""+l+t+"\n";var D,v=[m];for(d+=1;d<a.length;){var g=a[d];if(""===g.trim()){var F=a.slice(d+1).findIndex(function(t){return""!==t.trim()});if(-1===F)break;var y=a[d+1+F];if(((null==(o=null==(r=y.match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>p){v.push(g),l=""+l+g+"\n",d+=1;continue}break}if(!(((null==(u=null==(i=g.match(/^(\s*)/))?void 0:i[1])?void 0:u.length)||0)>p))break;v.push(g),l=""+l+g+"\n",d+=1}var C=v.slice(1);if(C.length>0){var k=C.map(function(t){return t.slice(p+f)}).join("\n");k.trim()&&(D=e.customNestedParser?e.customNestedParser(k):n.blockTokens(k))}var E=e.createToken(h,D);c.push(E)};d<a.length&&0!==(s=h());)if(1!==s&&s)return s.v;if(0!==c.length)return{items:c,raw:l}}function ja(t,e,n,r){if(!t||!Array.isArray(t.content))return"";var o="function"==typeof n?n(r):n,i=t.content,u=i[0],s=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}(i).slice(1),a=[""+o+e.renderChildren([u])];return s&&s.length>0&&s.forEach(function(t){var n=e.renderChildren([t]);if(n){var r=n.split("\n").map(function(t){return t?e.indent(t):""}).join("\n");a.push(r)}}),a.join("\n")}Wi({},{createAtomBlockMarkdownSpec:function(){return Ra},createBlockMarkdownSpec:function(){return Ia},createInlineMarkdownSpec:function(){return za},parseAttributes:function(){return Oa},parseIndentedBlocks:function(){return $a},renderNestedMarkdownContent:function(){return ja},serializeAttributes:function(){return Na}});var Ha=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).type="node",e}a(e,t),e.create=function(t){return void 0===t&&(t={}),new e("function"==typeof t?t():t)};var n=e.prototype;return n.configure=function(e){return t.prototype.configure.call(this,e)},n.extend=function(e){var n="function"==typeof e?e():e;return t.prototype.extend.call(this,n)},e}(ca);function Va(t){return new da({find:t.find,handler:function(e){var n=e.state,r=e.range,o=e.match,i=e.pasteEvent,u=cs(t.getAttributes,void 0,o,i);if(!1===u||null===u)return null;var s=n.tr,a=o[o.length-1],c=o[0],l=r.to;if(a){var d=c.search(/\S/),f=r.from+c.indexOf(a),h=f+a.length;if(As(r.from,r.to,n.doc).filter(function(e){return e.mark.type.excluded.find(function(n){return n===t.type&&n!==e.mark.type})}).filter(function(t){return t.to>f}).length)return null;h<r.to&&s.delete(h,r.to),f>r.from&&s.delete(r.from+d,f),l=r.from+d+a.length,s.addMark(r.from+d,l,t.type.create(u||{})),s.removeStoredMark(t.type)}}})}function _a(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}var qa=["children"],Wa=function(t,e){if("slot"===t)return 0;if(t instanceof Function)return t(e);var n=null!=e?e:{},r=n.children,o=_a(n,qa);if("svg"===t)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,o,r]},Ka=/^\s*>\s$/,Ua=Ha.create({name:"blockquote",addOptions:function(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML:function(){return[{tag:"blockquote"}]},renderHTML:function(t){var e=t.HTMLAttributes;return Wa("blockquote",h({},fs(this.options.HTMLAttributes,e),{children:Wa("slot",{})}))},parseMarkdown:function(t,e){return e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[]))},renderMarkdown:function(t,e){if(!t.content)return"";var n=[];return t.content.forEach(function(t){var r=e.renderChildren([t]).split("\n").map(function(t){return""===t.trim()?">":"> "+t});n.push(r.join("\n"))}),n.join("\n>\n")},addCommands:function(){var t=this;return{setBlockquote:function(){return function(e){return e.commands.wrapIn(t.name)}},toggleBlockquote:function(){return function(e){return e.commands.toggleWrap(t.name)}},unsetBlockquote:function(){return function(e){return e.commands.lift(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Shift-b":function(){return t.editor.commands.toggleBlockquote()}}},addInputRules:function(){return[Ta({find:Ka,type:this.type})]}}),Ja=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ga=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Za=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Qa=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Xa=la.create({name:"bold",addOptions:function(){return{HTMLAttributes:{}}},parseHTML:function(){var t=this;return[{tag:"strong"},{tag:"b",getAttrs:function(t){return"normal"!==t.style.fontWeight&&null}},{style:"font-weight=400",clearMark:function(e){return e.type.name===t.name}},{style:"font-weight",getAttrs:function(t){return/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}}]},renderHTML:function(t){var e=t.HTMLAttributes;return Wa("strong",h({},fs(this.options.HTMLAttributes,e),{children:Wa("slot",{})}))},markdownTokenName:"strong",parseMarkdown:function(t,e){return e.applyMark("bold",e.parseInline(t.tokens||[]))},renderMarkdown:function(t,e){return"**"+e.renderChildren(t)+"**"},addCommands:function(){var t=this;return{setBold:function(){return function(e){return e.commands.setMark(t.name)}},toggleBold:function(){return function(e){return e.commands.toggleMark(t.name)}},unsetBold:function(){return function(e){return e.commands.unsetMark(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-b":function(){return t.editor.commands.toggleBold()},"Mod-B":function(){return t.editor.commands.toggleBold()}}},addInputRules:function(){return[Sa({find:Ja,type:this.type}),Sa({find:Za,type:this.type})]},addPasteRules:function(){return[Va({find:Ga,type:this.type}),Va({find:Qa,type:this.type})]}}),Ya=/(^|[^`])`([^`]+)`(?!`)$/,tc=/(^|[^`])`([^`]+)`(?!`)/g,ec=la.create({name:"code",addOptions:function(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML:function(){return[{tag:"code"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["code",fs(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:function(t,e){return e.applyMark("code",[{type:"text",text:t.text||""}])},renderMarkdown:function(t,e){return t.content?"`"+e.renderChildren(t.content)+"`":""},addCommands:function(){var t=this;return{setCode:function(){return function(e){return e.commands.setMark(t.name)}},toggleCode:function(){return function(e){return e.commands.toggleMark(t.name)}},unsetCode:function(){return function(e){return e.commands.unsetMark(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-e":function(){return t.editor.commands.toggleCode()}}},addInputRules:function(){return[Sa({find:Ya,type:this.type})]},addPasteRules:function(){return[Va({find:tc,type:this.type})]}}),nc=/^```([a-z]+)?[\s\n]$/,rc=/^~~~([a-z]+)?[\s\n]$/,oc=Ha.create({name:"codeBlock",addOptions:function(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes:function(){var t=this;return{language:{default:this.options.defaultLanguage,parseHTML:function(e){var n,r=t.options.languageClassPrefix;return r&&[].concat((null==(n=e.firstElementChild)?void 0:n.classList)||[]).filter(function(t){return t.startsWith(r)}).map(function(t){return t.replace(r,"")})[0]||null},rendered:!1}}},parseHTML:function(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML:function(t){var e=t.node,n=t.HTMLAttributes;return["pre",fs(this.options.HTMLAttributes,n),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:function(t,e){var n;return!1===(null==(n=t.raw)?void 0:n.startsWith("```"))&&"indented"!==t.codeBlockStyle?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:function(t,e){var n,r=(null==(n=t.attrs)?void 0:n.language)||"";return t.content?["```"+r,e.renderChildren(t.content),"```"].join("\n"):"```"+r+"\n\n```"},addCommands:function(){var t=this;return{setCodeBlock:function(e){return function(n){return n.commands.setNode(t.name,e)}},toggleCodeBlock:function(e){return function(n){return n.commands.toggleNode(t.name,"paragraph",e)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Alt-c":function(){return t.editor.commands.toggleCodeBlock()},Backspace:function(){var e=t.editor.state.selection,n=e.empty,r=e.$anchor,o=1===r.pos;return!(!n||r.parent.type.name!==t.name)&&!(!o&&r.parent.textContent.length)&&t.editor.commands.clearNodes()},Tab:function(e){var n,r=e.editor;if(!t.options.enableTabIndentation)return!1;var o=null!=(n=t.options.tabSize)?n:4,i=r.state,u=i.selection,s=u.$from,a=u.empty;if(s.parent.type!==t.type)return!1;var c=" ".repeat(o);return a?r.commands.insertContent(c):r.commands.command(function(t){var e=t.tr,n=u.from,r=u.to,o=i.doc.textBetween(n,r,"\n","\n").split("\n").map(function(t){return c+t}).join("\n");return e.replaceWith(n,r,i.schema.text(o)),!0})},"Shift-Tab":function(e){var n,r=e.editor;if(!t.options.enableTabIndentation)return!1;var o=null!=(n=t.options.tabSize)?n:4,i=r.state,u=i.selection,s=u.$from,a=u.empty;return s.parent.type===t.type&&(a?r.commands.command(function(t){for(var e,n=t.tr,r=s.pos,u=s.start(),a=s.end(),c=i.doc.textBetween(u,a,"\n","\n").split("\n"),l=0,d=0,f=r-u,h=0;h<c.length;h+=1){if(d+c[h].length>=f){l=h;break}d+=c[h].length+1}var p=(null==(e=c[l].match(/^ */))?void 0:e[0])||"",m=Math.min(p.length,o);if(0===m)return!0;for(var D=u,v=0;v<l;v+=1)D+=c[v].length+1;return n.delete(D,D+m),r-D<=m&&n.setSelection(be.create(n.doc,D)),!0}):r.commands.command(function(t){var e=t.tr,n=u.from,r=u.to,s=i.doc.textBetween(n,r,"\n","\n").split("\n").map(function(t){var e,n=(null==(e=t.match(/^ */))?void 0:e[0])||"",r=Math.min(n.length,o);return t.slice(r)}).join("\n");return e.replaceWith(n,r,i.schema.text(s)),!0}))},Enter:function(e){var n=e.editor;if(!t.options.exitOnTripleEnter)return!1;var r=n.state.selection,o=r.$from;if(!r.empty||o.parent.type!==t.type)return!1;var i=o.parentOffset===o.parent.nodeSize-2,u=o.parent.textContent.endsWith("\n\n");return!(!i||!u)&&n.chain().command(function(t){return t.tr.delete(o.pos-2,o.pos),!0}).exitCode().run()},ArrowDown:function(e){var n=e.editor;if(!t.options.exitOnArrowDown)return!1;var r=n.state,o=r.selection,i=r.doc,u=o.$from;if(!o.empty||u.parent.type!==t.type)return!1;if(u.parentOffset!==u.parent.nodeSize-2)return!1;var s=u.after();return void 0!==s&&(i.nodeAt(s)?n.commands.command(function(t){return t.tr.setSelection(Ce.near(i.resolve(s))),!0}):n.commands.exitCode())}}},addInputRules:function(){return[Ma({find:nc,type:this.type,getAttributes:function(t){return{language:t[1]}}}),Ma({find:rc,type:this.type,getAttributes:function(t){return{language:t[1]}}})]},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("codeBlockVSCodeHandler"),props:{handlePaste:function(e,n){if(!n.clipboardData)return!1;if(t.editor.isActive(t.type.name))return!1;var r=n.clipboardData.getData("text/plain"),o=n.clipboardData.getData("vscode-editor-data"),i=o?JSON.parse(o):void 0,u=null==i?void 0:i.mode;if(!r||!u)return!1;var s=e.state,a=s.tr,c=s.schema.text(r.replace(/\r\n?/g,"\n"));return a.replaceSelectionWith(t.type.create({language:u},c)),a.selection.$from.parent.type!==t.type&&a.setSelection(be.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),e.dispatch(a),!0}}})]}}),ic=Ha.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:function(t,e){return t.content?e.renderChildren(t.content,"\n\n"):""}}),uc=Ha.create({name:"hardBreak",markdownTokenName:"br",addOptions:function(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:function(){return[{tag:"br"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["br",fs(this.options.HTMLAttributes,e)]},renderText:function(){return"\n"},renderMarkdown:function(){return"  \n"},parseMarkdown:function(){return{type:"hardBreak"}},addCommands:function(){var t=this;return{setHardBreak:function(){return function(e){var n=e.commands,r=e.chain,o=e.state,i=e.editor;return n.first([function(){return n.exitCode()},function(){return n.command(function(){var e=o.selection,n=o.storedMarks;if(e.$from.parent.type.spec.isolating)return!1;var u=t.options.keepMarks,s=i.extensionManager.splittableMarks,a=n||e.$to.parentOffset&&e.$from.marks();return r().insertContent({type:t.name}).command(function(t){var e=t.tr;if(t.dispatch&&a&&u){var n=a.filter(function(t){return s.includes(t.type.name)});e.ensureMarks(n)}return!0}).run()})}])}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Enter":function(){return t.editor.commands.setHardBreak()},"Shift-Enter":function(){return t.editor.commands.setHardBreak()}}}}),sc=Ha.create({name:"heading",addOptions:function(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes:function(){return{level:{default:1,rendered:!1}}},parseHTML:function(){return this.options.levels.map(function(t){return{tag:"h"+t,attrs:{level:t}}})},renderHTML:function(t){var e=t.node,n=t.HTMLAttributes;return["h"+(this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]),fs(this.options.HTMLAttributes,n),0]},parseMarkdown:function(t,e){return e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[]))},renderMarkdown:function(t,e){var n,r=(null==(n=t.attrs)?void 0:n.level)?parseInt(t.attrs.level,10):1,o="#".repeat(r);return t.content?o+" "+e.renderChildren(t.content):""},addCommands:function(){var t=this;return{setHeading:function(e){return function(n){var r=n.commands;return!!t.options.levels.includes(e.level)&&r.setNode(t.name,e)}},toggleHeading:function(e){return function(n){var r=n.commands;return!!t.options.levels.includes(e.level)&&r.toggleNode(t.name,"paragraph",e)}}}},addKeyboardShortcuts:function(){var t=this;return this.options.levels.reduce(function(e,n){var r;return h({},e,((r={})["Mod-Alt-"+n]=function(){return t.editor.commands.toggleHeading({level:n})},r))},{})},addInputRules:function(){var t=this;return this.options.levels.map(function(e){return Ma({find:new RegExp("^(#{"+Math.min.apply(Math,t.options.levels)+","+e+"})\\s$"),type:t.type,getAttributes:{level:e}})})}}),ac=Ha.create({name:"horizontalRule",addOptions:function(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML:function(){return[{tag:"hr"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["hr",fs(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:function(t,e){return e.createNode("horizontalRule")},renderMarkdown:function(){return"---"},addCommands:function(){var t=this;return{setHorizontalRule:function(){return function(e){var n=e.chain,r=e.state;if(!function(t,e){var n=t.selection,r=n.$from;if(n instanceof xe){var o=r.index();return r.parent.canReplaceWith(o,o+1,e)}for(var i=r.depth;i>=0;){var u=r.index(i);if(r.node(i).contentMatchAt(u).matchType(e))return!0;i-=1}return!1}(r,r.schema.nodes[t.name]))return!1;var o=r.selection,i=o.$to,u=n();return Ts(o)?u.insertContentAt(i.pos,{type:t.name}):u.insertContent({type:t.name}),u.command(function(e){var n=e.state,r=e.tr;if(e.dispatch){var o=r.selection.$to,i=o.end();if(o.nodeAfter)o.nodeAfter.isTextblock?r.setSelection(be.create(r.doc,o.pos+1)):o.nodeAfter.isBlock?r.setSelection(xe.create(r.doc,o.pos)):r.setSelection(be.create(r.doc,o.pos));else{var u=n.schema.nodes[t.options.nextNodeType]||o.parent.type.contentMatch.defaultType,s=null==u?void 0:u.create();s&&(r.insert(i,s),r.setSelection(be.create(r.doc,i+1)))}r.scrollIntoView()}return!0}).run()}}}},addInputRules:function(){return[(t={find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type},new ia({find:t.find,handler:function(e){var n=e.state,r=e.range,o=e.match,i=cs(t.getAttributes,void 0,o)||{},u=n.tr,s=r.from,a=r.to,c=t.type.create(i);if(o[1]){var l=s+o[0].lastIndexOf(o[1]);l>a?l=a:a=l+o[1].length;var d=o[0][o[0].length-1];u.insertText(d,s+o[0].length-1),u.replaceWith(l,a,c)}else if(o[0]){var f=t.type.isInline?s:s-1;u.insert(f,t.type.create(i)).delete(u.mapping.map(s),u.mapping.map(a))}u.scrollIntoView()},undoable:t.undoable}))];var t}}),cc=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,lc=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,dc=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,fc=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,hc=la.create({name:"italic",addOptions:function(){return{HTMLAttributes:{}}},parseHTML:function(){var t=this;return[{tag:"em"},{tag:"i",getAttrs:function(t){return"normal"!==t.style.fontStyle&&null}},{style:"font-style=normal",clearMark:function(e){return e.type.name===t.name}},{style:"font-style=italic"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["em",fs(this.options.HTMLAttributes,e),0]},addCommands:function(){var t=this;return{setItalic:function(){return function(e){return e.commands.setMark(t.name)}},toggleItalic:function(){return function(e){return e.commands.toggleMark(t.name)}},unsetItalic:function(){return function(e){return e.commands.unsetMark(t.name)}}}},markdownTokenName:"em",parseMarkdown:function(t,e){return e.applyMark("italic",e.parseInline(t.tokens||[]))},renderMarkdown:function(t,e){return"*"+e.renderChildren(t)+"*"},addKeyboardShortcuts:function(){var t=this;return{"Mod-i":function(){return t.editor.commands.toggleItalic()},"Mod-I":function(){return t.editor.commands.toggleItalic()}}},addInputRules:function(){return[Sa({find:cc,type:this.type}),Sa({find:dc,type:this.type})]},addPasteRules:function(){return[Va({find:lc,type:this.type}),Va({find:fc,type:this.type})]}});const pc="numeric",mc="ascii",Dc="alpha",vc="asciinumeric",gc="alphanumeric",Fc="domain",yc="emoji",Cc="scheme",kc="slashscheme",Ec="whitespace";function Ac(t,e){return t in e||(e[t]=[]),e[t]}function bc(t,e,n){e[pc]&&(e[vc]=!0,e[gc]=!0),e[mc]&&(e[vc]=!0,e[Dc]=!0),e[vc]&&(e[gc]=!0),e[Dc]&&(e[gc]=!0),e[gc]&&(e[Fc]=!0),e[yc]&&(e[Fc]=!0);for(const r in e){const e=Ac(r,n);e.indexOf(t)<0&&e.push(t)}}function wc(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}wc.groups={},wc.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let n=0;n<e.jr.length;n++){const r=e.jr[n][0],o=e.jr[n][1];if(o&&r.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let o=0;o<t.length;o++)this.tt(t[o],e,n,r)},tr(t,e,n,r){let o;return r=r||wc.groups,e&&e.j?o=e:(o=new wc(e),n&&r&&bc(e,n,r)),this.jr.push([t,o]),o},ts(t,e,n,r){let o=this;const i=t.length;if(!i)return o;for(let e=0;e<i-1;e++)o=o.tt(t[e]);return o.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||wc.groups;const o=this;if(e&&e.j)return o.j[t]=e,e;const i=e;let u,s=o.go(t);if(s?(u=new wc,Object.assign(u.j,s.j),u.jr.push.apply(u.jr,s.jr),u.jd=s.jd,u.t=s.t):u=new wc,i){if(r)if(u.t&&"string"==typeof u.t){const t=Object.assign(function(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}(u.t,r),n);bc(i,t,r)}else n&&bc(i,n,r);u.t=i}return o.j[t]=u,u}};const xc=(t,e,n,r,o)=>t.ta(e,n,r,o),Bc=(t,e,n,r,o)=>t.tr(e,n,r,o),Sc=(t,e,n,r,o)=>t.ts(e,n,r,o),Mc=(t,e,n,r,o)=>t.tt(e,n,r,o),Tc="WORD",Oc="UWORD",Nc="ASCIINUMERICAL",Rc="ALPHANUMERICAL",Ic="LOCALHOST",Lc="TLD",Pc="UTLD",zc="SCHEME",$c="SLASH_SCHEME",jc="NUM",Hc="WS",Vc="NL",_c="OPENBRACE",qc="CLOSEBRACE",Wc="OPENBRACKET",Kc="CLOSEBRACKET",Uc="OPENPAREN",Jc="CLOSEPAREN",Gc="OPENANGLEBRACKET",Zc="CLOSEANGLEBRACKET",Qc="FULLWIDTHLEFTPAREN",Xc="FULLWIDTHRIGHTPAREN",Yc="LEFTCORNERBRACKET",tl="RIGHTCORNERBRACKET",el="LEFTWHITECORNERBRACKET",nl="RIGHTWHITECORNERBRACKET",rl="FULLWIDTHLESSTHAN",ol="FULLWIDTHGREATERTHAN",il="AMPERSAND",ul="APOSTROPHE",sl="ASTERISK",al="AT",cl="BACKSLASH",ll="BACKTICK",dl="CARET",fl="COLON",hl="COMMA",pl="DOLLAR",ml="DOT",Dl="EQUALS",vl="EXCLAMATION",gl="HYPHEN",Fl="PERCENT",yl="PIPE",Cl="PLUS",kl="POUND",El="QUERY",Al="QUOTE",bl="FULLWIDTHMIDDLEDOT",wl="SEMI",xl="SLASH",Bl="TILDE",Sl="UNDERSCORE",Ml="EMOJI",Tl="SYM";var Ol=Object.freeze({__proto__:null,ALPHANUMERICAL:Rc,AMPERSAND:il,APOSTROPHE:ul,ASCIINUMERICAL:Nc,ASTERISK:sl,AT:al,BACKSLASH:cl,BACKTICK:ll,CARET:dl,CLOSEANGLEBRACKET:Zc,CLOSEBRACE:qc,CLOSEBRACKET:Kc,CLOSEPAREN:Jc,COLON:fl,COMMA:hl,DOLLAR:pl,DOT:ml,EMOJI:Ml,EQUALS:Dl,EXCLAMATION:vl,FULLWIDTHGREATERTHAN:ol,FULLWIDTHLEFTPAREN:Qc,FULLWIDTHLESSTHAN:rl,FULLWIDTHMIDDLEDOT:bl,FULLWIDTHRIGHTPAREN:Xc,HYPHEN:gl,LEFTCORNERBRACKET:Yc,LEFTWHITECORNERBRACKET:el,LOCALHOST:Ic,NL:Vc,NUM:jc,OPENANGLEBRACKET:Gc,OPENBRACE:_c,OPENBRACKET:Wc,OPENPAREN:Uc,PERCENT:Fl,PIPE:yl,PLUS:Cl,POUND:kl,QUERY:El,QUOTE:Al,RIGHTCORNERBRACKET:tl,RIGHTWHITECORNERBRACKET:nl,SCHEME:zc,SEMI:wl,SLASH:xl,SLASH_SCHEME:$c,SYM:Tl,TILDE:Bl,TLD:Lc,UNDERSCORE:Sl,UTLD:Pc,UWORD:Oc,WORD:Tc,WS:Hc});const Nl=/[a-z]/,Rl=/\p{L}/u,Il=/\p{Emoji}/u,Ll=/\d/,Pl=/\s/;let zl=null,$l=null;function jl(t,e){const n=function(t){const e=[],n=t.length;let r=0;for(;r<n;){let o,i=t.charCodeAt(r),u=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(u),r+=u.length}return e}(e.replace(/[A-Z]/g,t=>t.toLowerCase())),r=n.length,o=[];let i=0,u=0;for(;u<r;){let s=t,a=null,c=0,l=null,d=-1,f=-1;for(;u<r&&(a=s.go(n[u]));)s=a,s.accepts()?(d=0,f=0,l=s):d>=0&&(d+=n[u].length,f++),c+=n[u].length,i+=n[u].length,u++;i-=d,u-=f,c-=d,o.push({t:l.t,v:e.slice(i-c,i),s:i-c,e:i})}return o}function Hl(t,e,n,r,o){let i;const u=e.length;for(let n=0;n<u-1;n++){const u=e[n];t.j[u]?i=t.j[u]:(i=new wc(r),i.jr=o.slice(),t.j[u]=i),t=i}return i=new wc(n),i.jr=o.slice(),t.j[e[u-1]]=i,i}function Vl(t){const e=[],n=[];let r=0;for(;r<t.length;){let o=0;for(;"0123456789".indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let e=parseInt(t.substring(r,r+o),10);e>0;e--)n.pop();r+=o}else n.push(t[r]),r++}return e}const _l={defaultProtocol:"http",events:null,format:Wl,formatHref:Wl,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ql(t,e=null){let n=Object.assign({},_l);t&&(n=Object.assign(n,t instanceof ql?t.o:t));const r=n.ignoreTags,o=[];for(let t=0;t<r.length;t++)o.push(r[t].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=o}function Wl(t){return t}function Kl(t,e){this.t="token",this.v=t,this.tk=e}function Ul(t,e){class n extends Kl{constructor(e,n){super(e,n),this.t=t}}for(const t in e)n.prototype[t]=e[t];return n.t=t,n}ql.prototype={o:_l,ignoreTags:[],defaultRender:t=>t,check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=null!=e;let o=this.o[t];return o?("object"==typeof o?(o=n.t in o?o[n.t]:_l[t],"function"==typeof o&&r&&(o=o(e,n))):"function"==typeof o&&r&&(o=o(e,n.t,n)),o):o},getObj(t,e,n){let r=this.o[t];return"function"==typeof r&&null!=e&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}},Kl.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=_l.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),o=t.get("tagName",n,e),i=this.toFormattedString(t),u={},s=t.get("className",n,e),a=t.get("target",n,e),c=t.get("rel",n,e),l=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return u.href=r,s&&(u.class=s),a&&(u.target=a),c&&(u.rel=c),l&&Object.assign(u,l),{tagName:o,attributes:u,content:i,eventListeners:d}}};const Jl=Ul("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Gl=Ul("text"),Zl=Ul("nl"),Ql=Ul("url",{isLink:!0,toHref(t=_l.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Ic&&t[1].t===fl}}),Xl=t=>new wc(t);function Yl(t,e,n){const r=n[0].s,o=n[n.length-1].e;return new t(e.slice(r,o),n)}const td="undefined"!=typeof console&&console&&console.warn||(()=>{}),ed={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function nd(t,e=!1){if(ed.initialized&&td(`linkifyjs: already initialized - will not register custom scheme "${t}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');ed.customSchemes.push([t,e])}function rd(t){return ed.initialized||function(){ed.scanner=function(t=[]){const e={};wc.groups=e;const n=new wc;null==zl&&(zl=Vl("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==$l&&($l=Vl("121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222")),Mc(n,"'",ul),Mc(n,"{",_c),Mc(n,"}",qc),Mc(n,"[",Wc),Mc(n,"]",Kc),Mc(n,"(",Uc),Mc(n,")",Jc),Mc(n,"<",Gc),Mc(n,">",Zc),Mc(n,"",Qc),Mc(n,"",Xc),Mc(n,"",Yc),Mc(n,"",tl),Mc(n,"",el),Mc(n,"",nl),Mc(n,"",rl),Mc(n,"",ol),Mc(n,"&",il),Mc(n,"*",sl),Mc(n,"@",al),Mc(n,"`",ll),Mc(n,"^",dl),Mc(n,":",fl),Mc(n,",",hl),Mc(n,"$",pl),Mc(n,".",ml),Mc(n,"=",Dl),Mc(n,"!",vl),Mc(n,"-",gl),Mc(n,"%",Fl),Mc(n,"|",yl),Mc(n,"+",Cl),Mc(n,"#",kl),Mc(n,"?",El),Mc(n,'"',Al),Mc(n,"/",xl),Mc(n,";",wl),Mc(n,"~",Bl),Mc(n,"_",Sl),Mc(n,"\\",cl),Mc(n,"",bl);const r=Bc(n,Ll,jc,{[pc]:!0});Bc(r,Ll,r);const o=Bc(r,Nl,Nc,{[vc]:!0}),i=Bc(r,Rl,Rc,{[gc]:!0}),u=Bc(n,Nl,Tc,{[mc]:!0});Bc(u,Ll,o),Bc(u,Nl,u),Bc(o,Ll,o),Bc(o,Nl,o);const s=Bc(n,Rl,Oc,{[Dc]:!0});Bc(s,Nl),Bc(s,Ll,i),Bc(s,Rl,s),Bc(i,Ll,i),Bc(i,Nl),Bc(i,Rl,i);const a=Mc(n,"\n",Vc,{[Ec]:!0}),c=Mc(n,"\r",Hc,{[Ec]:!0}),l=Bc(n,Pl,Hc,{[Ec]:!0});Mc(n,"",l),Mc(c,"\n",a),Mc(c,"",l),Bc(c,Pl,l),Mc(l,"\r"),Mc(l,"\n"),Bc(l,Pl,l),Mc(l,"",l);const d=Bc(n,Il,Ml,{[yc]:!0});Mc(d,"#"),Bc(d,Il,d),Mc(d,"",d);const f=Mc(d,"");Mc(f,"#"),Bc(f,Il,d);const h=[[Nl,u],[Ll,o]],p=[[Nl,null],[Rl,s],[Ll,i]];for(let t=0;t<zl.length;t++)Hl(n,zl[t],Lc,Tc,h);for(let t=0;t<$l.length;t++)Hl(n,$l[t],Pc,Oc,p);bc(Lc,{tld:!0,ascii:!0},e),bc(Pc,{utld:!0,alpha:!0},e),Hl(n,"file",zc,Tc,h),Hl(n,"mailto",zc,Tc,h),Hl(n,"http",$c,Tc,h),Hl(n,"https",$c,Tc,h),Hl(n,"ftp",$c,Tc,h),Hl(n,"ftps",$c,Tc,h),bc(zc,{scheme:!0,ascii:!0},e),bc($c,{slashscheme:!0,ascii:!0},e),t=t.sort((t,e)=>t[0]>e[0]?1:-1);for(let e=0;e<t.length;e++){const r=t[e][0],o=t[e][1]?{[Cc]:!0}:{[kc]:!0};r.indexOf("-")>=0?o[Fc]=!0:Nl.test(r)?Ll.test(r)?o[vc]=!0:o[mc]=!0:o[pc]=!0,Sc(n,r,r,o)}return Sc(n,"localhost",Ic,{ascii:!0}),n.jd=new wc(Tl),{start:n,tokens:Object.assign({groups:e},Ol)}}(ed.customSchemes);for(let t=0;t<ed.tokenQueue.length;t++)ed.tokenQueue[t][1]({scanner:ed.scanner});ed.parser=function({groups:t}){const e=t.domain.concat([il,sl,al,cl,ll,dl,pl,Dl,gl,jc,Fl,yl,Cl,kl,xl,Tl,Bl,Sl]),n=[ul,fl,hl,ml,vl,Fl,El,Al,wl,Gc,Zc,_c,qc,Kc,Wc,Uc,Jc,Qc,Xc,Yc,tl,el,nl,rl,ol],r=[il,ul,sl,cl,ll,dl,pl,Dl,gl,_c,qc,Fl,yl,Cl,kl,El,xl,Tl,Bl,Sl],o=Xl(),i=Mc(o,Bl);xc(i,r,i),xc(i,t.domain,i);const u=Xl(),s=Xl(),a=Xl();xc(o,t.domain,u),xc(o,t.scheme,s),xc(o,t.slashscheme,a),xc(u,r,i),xc(u,t.domain,u);const c=Mc(u,al);Mc(i,al,c),Mc(s,al,c),Mc(a,al,c);const l=Mc(i,ml);xc(l,r,i),xc(l,t.domain,i);const d=Xl();xc(c,t.domain,d),xc(d,t.domain,d);const f=Mc(d,ml);xc(f,t.domain,d);const h=Xl(Jl);xc(f,t.tld,h),xc(f,t.utld,h),Mc(c,Ic,h);const p=Mc(d,gl);Mc(p,gl,p),xc(p,t.domain,d),xc(h,t.domain,d),Mc(h,ml,f),Mc(h,gl,p);const m=Mc(h,fl);xc(m,t.numeric,Jl);const D=Mc(u,gl),v=Mc(u,ml);Mc(D,gl,D),xc(D,t.domain,u),xc(v,r,i),xc(v,t.domain,u);const g=Xl(Ql);xc(v,t.tld,g),xc(v,t.utld,g),xc(g,t.domain,u),xc(g,r,i),Mc(g,ml,v),Mc(g,gl,D),Mc(g,al,c);const F=Mc(g,fl),y=Xl(Ql);xc(F,t.numeric,y);const C=Xl(Ql),k=Xl();xc(C,e,C),xc(C,n,k),xc(k,e,C),xc(k,n,k),Mc(g,xl,C),Mc(y,xl,C);const E=Mc(s,fl),A=Mc(a,fl),b=Mc(A,xl),w=Mc(b,xl);xc(s,t.domain,u),Mc(s,ml,v),Mc(s,gl,D),xc(a,t.domain,u),Mc(a,ml,v),Mc(a,gl,D),xc(E,t.domain,C),Mc(E,xl,C),Mc(E,El,C),xc(w,t.domain,C),xc(w,e,C),Mc(w,xl,C);const x=[[_c,qc],[Wc,Kc],[Uc,Jc],[Gc,Zc],[Qc,Xc],[Yc,tl],[el,nl],[rl,ol]];for(let t=0;t<x.length;t++){const[r,o]=x[t],i=Mc(C,r);Mc(k,r,i),Mc(i,o,C);const u=Xl(Ql);xc(i,e,u);const s=Xl();xc(i,n),xc(u,e,u),xc(u,n,s),xc(s,e,u),xc(s,n,s),Mc(u,o,C),Mc(s,o,C)}return Mc(o,Ic,g),Mc(o,Vc,Zl),{start:o,tokens:Ol}}(ed.scanner.tokens);for(let t=0;t<ed.pluginQueue.length;t++)ed.pluginQueue[t][1]({scanner:ed.scanner,parser:ed.parser});ed.initialized=!0}(),function(t,e,n){let r=n.length,o=0,i=[],u=[];for(;o<r;){let s=t,a=null,c=null,l=0,d=null,f=-1;for(;o<r&&!(a=s.go(n[o].t));)u.push(n[o++]);for(;o<r&&(c=a||s.go(n[o].t));)a=null,s=c,s.accepts()?(f=0,d=s):f>=0&&f++,o++,l++;if(f<0)o-=l,o<r&&(u.push(n[o]),o++);else{u.length>0&&(i.push(Yl(Gl,e,u)),u=[]),o-=f,l-=f;const t=d.t,r=n.slice(o-l,o);i.push(Yl(t,e,r))}}return u.length>0&&i.push(Yl(Gl,e,u)),i}(ed.parser.start,t,jl(ed.scanner.start,t))}function od(t,e=null,n=null){if(e&&"object"==typeof e){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new ql(n),o=rd(t),i=[];for(let t=0;t<o.length;t++){const n=o[t];!n.isLink||e&&n.t!==e||!r.check(n)||i.push(n.toFormattedObject(r))}return i}rd.scan=jl;var id="[\0- -\u2029]",ud=new RegExp(id),sd=new RegExp(id+"$"),ad=new RegExp(id,"g");function cd(t,e){var n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(function(t){var e="string"==typeof t?t:t.scheme;e&&n.push(e)}),!t||t.replace(ad,"").match(new RegExp("^(?:(?:"+n.join("|")+"):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))","i"))}var ld=la.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate:function(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(function(t){"string"!=typeof t?nd(t.scheme,t.optionalSlashes):nd(t)})},onDestroy:function(){wc.groups={},ed.scanner=null,ed.parser=null,ed.tokenQueue=[],ed.pluginQueue=[],ed.customSchemes=[],ed.initialized=!1},inclusive:function(){return this.options.autolink},addOptions:function(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:function(t,e){return!!cd(t,e.protocols)},validate:function(t){return!!t},shouldAutoLink:function(t){var e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;var r=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!/^\d{1,3}(\.\d{1,3}){3}$/.test(r)&&!!/\./.test(r)}}},addAttributes:function(){return{href:{default:null,parseHTML:function(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML:function(){var t=this;return[{tag:"a[href]",getAttrs:function(e){var n=e.getAttribute("href");return!(!n||!t.options.isAllowedUri(n,{defaultValidate:function(e){return!!cd(e,t.options.protocols)},protocols:t.options.protocols,defaultProtocol:t.options.defaultProtocol}))&&null}}]},renderHTML:function(t){var e=this,n=t.HTMLAttributes;return this.options.isAllowedUri(n.href,{defaultValidate:function(t){return!!cd(t,e.options.protocols)},protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",fs(this.options.HTMLAttributes,n),0]:["a",fs(this.options.HTMLAttributes,h({},n,{href:""})),0]},markdownTokenName:"link",parseMarkdown:function(t,e){return e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null})},renderMarkdown:function(t,e){var n,r=(null==(n=t.attrs)?void 0:n.href)||"";return"["+e.renderChildren(t)+"]("+r+")"},addCommands:function(){var t=this;return{setLink:function(e){return function(n){var r=n.chain,o=e.href;return!!t.options.isAllowedUri(o,{defaultValidate:function(e){return!!cd(e,t.options.protocols)},protocols:t.options.protocols,defaultProtocol:t.options.defaultProtocol})&&r().setMark(t.name,e).setMeta("preventAutolink",!0).run()}},toggleLink:function(e){return function(n){var r=n.chain,o=(e||{}).href;return!(o&&!t.options.isAllowedUri(o,{defaultValidate:function(e){return!!cd(e,t.options.protocols)},protocols:t.options.protocols,defaultProtocol:t.options.defaultProtocol}))&&r().toggleMark(t.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},unsetLink:function(){return function(e){return(0,e.chain)().unsetMark(t.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}}},addPasteRules:function(){var t=this;return[Va({find:function(e){var n=[];if(e){var r=t.options,o=r.protocols,i=r.defaultProtocol,u=od(e).filter(function(e){return e.isLink&&t.options.isAllowedUri(e.value,{defaultValidate:function(t){return!!cd(t,o)},protocols:o,defaultProtocol:i})});u.length&&u.forEach(function(e){t.options.shouldAutoLink(e.value)&&n.push({text:e.value,data:{href:e.href},index:e.start})})}return n},type:this.type,getAttributes:function(t){var e;return{href:null==(e=t.data)?void 0:e.href}}})]},addProseMirrorPlugins:function(){var t,e=this,n=[],r=this.options,o=r.protocols,i=r.defaultProtocol;return this.options.autolink&&n.push((t={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:function(t){return e.options.isAllowedUri(t,{defaultValidate:function(t){return!!cd(t,o)},protocols:o,defaultProtocol:i})},shouldAutoLink:this.options.shouldAutoLink},new je({key:new _e("autolink"),appendTransaction:function(e,n,r){var o=e.some(function(t){return t.docChanged})&&!n.doc.eq(r.doc),i=e.some(function(t){return t.getMeta("preventAutolink")});if(o&&!i){var u=r.tr;if(Es(ns(n.doc,[].concat(e))).forEach(function(e){var n,o,i,s,a,c,l,d=e.newRange,f=(n=r.doc,o=d,i=function(t){return t.isTextblock},s=[],n.nodesBetween(o.from,o.to,function(t,e){i(t)&&s.push({node:t,pos:e})}),s);if(f.length>1)a=f[0],c=r.doc.textBetween(a.pos,a.pos+a.node.nodeSize,void 0," ");else if(f.length){var p=r.doc.textBetween(d.from,d.to," "," ");if(!sd.test(p))return;a=f[0],c=r.doc.textBetween(a.pos,d.to,void 0," ")}if(a&&c){var m=c.split(ud).filter(Boolean);if(m.length<=0)return!1;var D=m[m.length-1],v=a.pos+c.lastIndexOf(D);if(!D)return!1;var g=rd(D).map(function(e){return e.toObject(t.defaultProtocol)});if(!(1===(l=g).length?l[0].isLink:3===l.length&&l[1].isLink&&["()","[]"].includes(l[0].value+l[2].value)))return!1;g.filter(function(t){return t.isLink}).map(function(t){return h({},t,{from:v+t.start+1,to:v+t.end+1})}).filter(function(t){return!r.schema.marks.code||!r.doc.rangeHasMark(t.from,t.to,r.schema.marks.code)}).filter(function(e){return t.validate(e.value)}).filter(function(e){return t.shouldAutoLink(e.value)}).forEach(function(e){As(e.from,e.to,r.doc).some(function(e){return e.mark.type===t.type})||u.addMark(e.from,e.to,t.type.create({href:e.href}))})}}),u.steps.length)return u}}}))),n.push(function(t){return new je({key:new _e("handleClickLink"),props:{handleClick:function(e,n,r){var o,i;if(0!==r.button)return!1;if(!e.editable)return!1;var u=!1;if(t.enableClickSelection&&(u=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){var s=null;if(r.target instanceof HTMLAnchorElement)s=r.target;else{for(var a=r.target,c=[];"DIV"!==a.nodeName;)c.push(a),a=a.parentNode;s=c.find(function(t){return"A"===t.nodeName})}if(!s)return u;var l=ks(e.state,t.type.name),d=null!=(o=null==s?void 0:s.href)?o:l.href,f=null!=(i=null==s?void 0:s.target)?i:l.target;s&&d&&(window.open(d,f),u=!0)}return u}}})}({type:this.type,editor:this.editor,openOnClick:"whenNotEditable"===this.options.openOnClick||this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(function(t){return new je({key:new _e("handlePasteLink"),props:{handlePaste:function(e,n,r){var o=t.shouldAutoLink;if(e.state.selection.empty)return!1;var i="";r.content.forEach(function(t){i+=t.textContent});var u=od(i,{defaultProtocol:t.defaultProtocol}).find(function(t){return t.isLink&&t.value===i});return!(!i||!u||void 0!==o&&!o(u.value))&&t.editor.commands.setMark(t.type,{href:u.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),dd=["start"],fd=Object.defineProperty,hd="textStyle",pd=/^\s*([-+*])\s$/,md=Ha.create({name:"bulletList",addOptions:function(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content:function(){return this.options.itemTypeName+"+"},parseHTML:function(){return[{tag:"ul"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["ul",fs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:function(t,e){return"list"!==t.type||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]}},renderMarkdown:function(t,e){return t.content?e.renderChildren(t.content,"\n"):""},markdownOptions:{indentsContent:!0},addCommands:function(){var t=this;return{toggleBulletList:function(){return function(e){var n=e.commands,r=e.chain;return t.options.keepAttributes?r().toggleList(t.name,t.options.itemTypeName,t.options.keepMarks).updateAttributes("listItem",t.editor.getAttributes(hd)).run():n.toggleList(t.name,t.options.itemTypeName,t.options.keepMarks)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Shift-8":function(){return t.editor.commands.toggleBulletList()}}},addInputRules:function(){var t=this,e=Ta({find:pd,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Ta({find:pd,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:function(){return t.editor.getAttributes(hd)},editor:this.editor})),[e]}}),Dd=Ha.create({name:"listItem",addOptions:function(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML:function(){return[{tag:"li"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["li",fs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:function(t,e){if("list_item"!==t.type)return[];var n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(function(t){return"paragraph"===t.type}))n=e.parseChildren(t.tokens);else{var r=t.tokens[0];if(r&&"text"===r.type&&r.tokens&&r.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(r.tokens)}],t.tokens.length>1){var o,i=t.tokens.slice(1),u=e.parseChildren(i);(o=n).push.apply(o,u)}}else n=e.parseChildren(t.tokens)}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:function(t,e,n){return ja(t,e,function(t){return"bulletList"===t.parentType?"- ":"orderedList"===t.parentType?t.index+1+". ":"- "},n)},addKeyboardShortcuts:function(){var t=this;return{Enter:function(){return t.editor.commands.splitListItem(t.name)},Tab:function(){return t.editor.commands.sinkListItem(t.name)},"Shift-Tab":function(){return t.editor.commands.liftListItem(t.name)}}}});!function(t,e){for(var n in e)fd(t,n,{get:e[n],enumerable:!0})}({},{findListItemPos:function(){return vd},getNextListDepth:function(){return gd},handleBackspace:function(){return kd},handleDelete:function(){return bd},hasListBefore:function(){return Fd},hasListItemAfter:function(){return wd},hasListItemBefore:function(){return yd},listItemHasSubList:function(){return Cd},nextListIsDeeper:function(){return Ed},nextListIsHigher:function(){return Ad}});var vd=function(t,e){for(var n=e.selection.$from,r=nu(t,e.schema),o=n.depth,i=n.pos,u=null;o>0&&null===u;)n.node(o).type===r?u=o:(o-=1,i-=1);return null===u?null:{$pos:e.doc.resolve(i),depth:u}},gd=function(t,e){var n=vd(t,e);if(!n)return!1;var r=function(t,e,n,r){void 0===r&&(r=20);for(var o=t.doc.resolve(n),i=r,u=null;i>0&&null===u;){var s=o.node(i);(null==s?void 0:s.type.name)===e?u=s:i-=1}return[u,i]}(e,t,n.$pos.pos+4);return r[1]},Fd=function(t,e,n){var r=t.selection.$anchor,o=Math.max(0,r.pos-2),i=t.doc.resolve(o).node();return!(!i||!n.includes(i.type.name))},yd=function(t,e){var n,r=e.selection.$anchor,o=e.doc.resolve(r.pos-2);return 0!==o.index()&&(null==(n=o.nodeBefore)?void 0:n.type.name)===t},Cd=function(t,e,n){if(!n)return!1;var r=nu(t,e.schema),o=!1;return n.descendants(function(t){t.type===r&&(o=!0)}),o},kd=function(t,e,n){if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!zu(t.state,e)&&Fd(t.state,e,n)){var r=t.state.selection.$anchor,o=t.state.doc.resolve(r.before()-1),i=[];o.node().descendants(function(t,n){t.type.name===e&&i.push({node:t,pos:n})});var u=i.at(-1);if(!u)return!1;var s=t.state.doc.resolve(o.start()+u.pos+1);return t.chain().cut({from:r.start()-1,to:r.end()+1},s.end()).joinForward().run()}if(!zu(t.state,e))return!1;if(c=(a=t.state.selection).$from,l=a.$to,c.parentOffset>0||c.pos!==l.pos)return!1;var a,c,l,d=vd(e,t.state);if(!d)return!1;var f=t.state.doc.resolve(d.$pos.pos-2).node(d.depth),h=Cd(e,t.state,f);return yd(e,t.state)&&!h?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},Ed=function(t,e){var n=gd(t,e),r=vd(t,e);return!(!r||!n)&&n>r.depth},Ad=function(t,e){var n=gd(t,e),r=vd(t,e);return!(!r||!n)&&n<r.depth},bd=function(t,e){if(!zu(t.state,e))return!1;if(!function(t,e){var n=t.selection,r=n.$from,o=n.$to,i=n.$anchor;if(e){var u=rs(function(t){return t.type.name===e})(t.selection);if(!u)return!1;var s=t.doc.resolve(u.pos+1);return i.pos+1===s.end()}return!(o.parentOffset<o.parent.nodeSize-2||r.pos!==o.pos)}(t.state,e))return!1;var n=t.state.selection,r=n.$from,o=n.$to;return!(!n.empty&&r.sameParent(o))&&(Ed(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():Ad(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward())},wd=function(t,e){var n,r=e.selection.$anchor,o=e.doc.resolve(r.pos-r.parentOffset-2);return o.index()!==o.parent.childCount-1&&(null==(n=o.nodeAfter)?void 0:n.type.name)===t},xd=ma.create({name:"listKeymap",addOptions:function(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts:function(){var t=this;return{Delete:function(e){var n=e.editor,r=!1;return t.options.listTypes.forEach(function(t){var e=t.itemName;void 0!==n.state.schema.nodes[e]&&bd(n,e)&&(r=!0)}),r},"Mod-Delete":function(e){var n=e.editor,r=!1;return t.options.listTypes.forEach(function(t){var e=t.itemName;void 0!==n.state.schema.nodes[e]&&bd(n,e)&&(r=!0)}),r},Backspace:function(e){var n=e.editor,r=!1;return t.options.listTypes.forEach(function(t){var e=t.itemName,o=t.wrapperNames;void 0!==n.state.schema.nodes[e]&&kd(n,e,o)&&(r=!0)}),r},"Mod-Backspace":function(e){var n=e.editor,r=!1;return t.options.listTypes.forEach(function(t){var e=t.itemName,o=t.wrapperNames;void 0!==n.state.schema.nodes[e]&&kd(n,e,o)&&(r=!0)}),r}}}}),Bd=/^(\s*)(\d+)\.\s+(.*)$/,Sd=/^\s/;function Md(t,e,n){for(var r,o=[],i=0;i<t.length;){var u=t[i];if(u.indent===e){var s=u.content.split("\n"),a=(null==(r=s[0])?void 0:r.trim())||"",c=[];a&&c.push({type:"paragraph",raw:a,tokens:n.inlineTokens(a)});var l=s.slice(1).join("\n").trim();if(l){var d=n.blockTokens(l);c.push.apply(c,d)}for(var f=i+1,h=[];f<t.length&&t[f].indent>e;)h.push(t[f]),f+=1;if(h.length>0){var p=Math.min.apply(Math,h.map(function(t){return t.indent})),m=Md(h,p,n);c.push({type:"list",ordered:!0,start:h[0].number,items:m,raw:h.map(function(t){return t.raw}).join("\n")})}o.push({type:"list_item",raw:u.raw,tokens:c}),i=f}else i+=1}return o}var Td="textStyle",Od=/^(\d+)\.\s$/,Nd=Ha.create({name:"orderedList",addOptions:function(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content:function(){return this.options.itemTypeName+"+"},addAttributes:function(){return{start:{default:1,parseHTML:function(t){return t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}},type:{default:null,parseHTML:function(t){return t.getAttribute("type")}}}},parseHTML:function(){return[{tag:"ol"}]},renderHTML:function(t){var e=t.HTMLAttributes,n=e.start,r=_a(e,dd);return 1===n?["ol",fs(this.options.HTMLAttributes,r),0]:["ol",fs(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:function(t,e){if("list"!==t.type||!t.ordered)return[];var n=t.start||1,r=t.items?function(t,e){return t.map(function(t){if("list_item"!==t.type)return e.parseChildren([t])[0];var n=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(function(t){if("paragraph"===t.type||"list"===t.type||"blockquote"===t.type||"code"===t.type)n.push.apply(n,e.parseChildren([t]));else if("text"===t.type&&t.tokens){var r=e.parseChildren([t]);n.push({type:"paragraph",content:r})}else{var o=e.parseChildren([t]);o.length>0&&n.push.apply(n,o)}}),{type:"listItem",content:n}})}(t.items,e):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:function(t,e){return t.content?e.renderChildren(t.content,"\n"):""},markdownTokenizer:{name:"orderedList",level:"block",start:function(t){var e=t.match(/^(\s*)(\d+)\.\s+/),n=null==e?void 0:e.index;return void 0!==n?n:-1},tokenize:function(t,e,n){var r,o=t.split("\n"),i=function(t){for(var e=[],n=0,r=0;n<t.length;){var o=t[n],i=o.match(Bd);if(!i)break;for(var u=i[1],s=i[2],a=i[3],c=u.length,l=a,d=n+1,f=[o];d<t.length;){var h=t[d];if(h.match(Bd))break;if(""===h.trim())f.push(h),l+="\n",d+=1;else{if(!h.match(Sd))break;f.push(h),l+="\n"+h.slice(c+2),d+=1}}e.push({indent:c,number:parseInt(s,10),content:l.trim(),raw:f.join("\n")}),r=d,n=d}return[e,r]}(o),u=i[0],s=i[1];if(0!==u.length){var a=Md(u,0,n);if(0!==a.length)return{type:"list",ordered:!0,start:(null==(r=u[0])?void 0:r.number)||1,items:a,raw:o.slice(0,s).join("\n")}}}},markdownOptions:{indentsContent:!0},addCommands:function(){var t=this;return{toggleOrderedList:function(){return function(e){var n=e.commands,r=e.chain;return t.options.keepAttributes?r().toggleList(t.name,t.options.itemTypeName,t.options.keepMarks).updateAttributes("listItem",t.editor.getAttributes(Td)).run():n.toggleList(t.name,t.options.itemTypeName,t.options.keepMarks)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Shift-7":function(){return t.editor.commands.toggleOrderedList()}}},addInputRules:function(){var t=this,e=Ta({find:Od,type:this.type,getAttributes:function(t){return{start:+t[1]}},joinPredicate:function(t,e){return e.childCount+e.attrs.start===+t[1]}});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Ta({find:Od,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:function(e){return h({start:+e[1]},t.editor.getAttributes(Td))},joinPredicate:function(t,e){return e.childCount+e.attrs.start===+t[1]},editor:this.editor})),[e]}}),Rd=/^\s*(\[([( |x])?\])\s$/,Id=Ha.create({name:"taskItem",addOptions:function(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content:function(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:function(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:function(t){var e=t.getAttribute("data-checked");return""===e||"true"===e},renderHTML:function(t){return{"data-checked":t.checked}}}}},parseHTML:function(){return[{tag:'li[data-type="'+this.name+'"]',priority:51}]},renderHTML:function(t){var e=t.node,n=t.HTMLAttributes;return["li",fs(this.options.HTMLAttributes,n,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:function(t,e){var n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){var r=e.parseChildren(t.nestedTokens);n.push.apply(n,r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:function(t,e){var n;return ja(t,e,"- ["+((null==(n=t.attrs)?void 0:n.checked)?"x":" ")+"] ")},addKeyboardShortcuts:function(){var t=this,e={Enter:function(){return t.editor.commands.splitListItem(t.name)},"Shift-Tab":function(){return t.editor.commands.liftListItem(t.name)}};return this.options.nested?h({},e,{Tab:function(){return t.editor.commands.sinkListItem(t.name)}}):e},addNodeView:function(){var t=this;return function(e){var n=e.node,r=e.HTMLAttributes,o=e.getPos,i=e.editor,u=document.createElement("li"),s=document.createElement("label"),a=document.createElement("span"),c=document.createElement("input"),l=document.createElement("div"),d=function(e){var n,r;c.ariaLabel=(null==(r=null==(n=t.options.a11y)?void 0:n.checkboxLabel)?void 0:r.call(n,e,c.checked))||"Task item checkbox for "+(e.textContent||"empty task item")};d(n),s.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",function(t){return t.preventDefault()}),c.addEventListener("change",function(e){if(i.isEditable||t.options.onReadOnlyChecked){var r=e.target.checked;i.isEditable&&"function"==typeof o&&i.chain().focus(void 0,{scrollIntoView:!1}).command(function(t){var e=t.tr,n=o();if("number"!=typeof n)return!1;var i=e.doc.nodeAt(n);return e.setNodeMarkup(n,void 0,h({},null==i?void 0:i.attrs,{checked:r})),!0}).run(),!i.isEditable&&t.options.onReadOnlyChecked&&(t.options.onReadOnlyChecked(n,r)||(c.checked=!c.checked))}else c.checked=!c.checked}),Object.entries(t.options.HTMLAttributes).forEach(function(t){var e=t[0],n=t[1];u.setAttribute(e,n)}),u.dataset.checked=n.attrs.checked,c.checked=n.attrs.checked,s.append(c,a),u.append(s,l),Object.entries(r).forEach(function(t){var e=t[0],n=t[1];u.setAttribute(e,n)});var f=new Set(Object.keys(r));return{dom:u,contentDOM:l,update:function(e){if(e.type!==t.type)return!1;u.dataset.checked=e.attrs.checked,c.checked=e.attrs.checked,d(e);var n=hs(e,i.extensionManager.attributes),r=new Set(Object.keys(n)),o=t.options.HTMLAttributes;return f.forEach(function(t){r.has(t)||(t in o?u.setAttribute(t,o[t]):u.removeAttribute(t))}),Object.entries(n).forEach(function(t){var e=t[0],n=t[1];null==n?e in o?u.setAttribute(e,o[e]):u.removeAttribute(e):u.setAttribute(e,n)}),f=r,!0}}}},addInputRules:function(){return[Ta({find:Rd,type:this.type,getAttributes:function(t){return{checked:"x"===t[t.length-1]}}})]}}),Ld=Ha.create({name:"taskList",addOptions:function(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content:function(){return this.options.itemTypeName+"+"},parseHTML:function(){return[{tag:'ul[data-type="'+this.name+'"]',priority:51}]},renderHTML:function(t){var e=t.HTMLAttributes;return["ul",fs(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:function(t,e){return e.createNode("taskList",{},e.parseChildren(t.items||[]))},renderMarkdown:function(t,e){return t.content?e.renderChildren(t.content,"\n"):""},markdownTokenizer:{name:"taskList",level:"block",start:function(t){var e,n=null==(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:e.index;return void 0!==n?n:-1},tokenize:function(t,e,n){var r=function(t){var e=$a(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:function(t){return{indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}},createToken:function(t,e){return{type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}},customNestedParser:r},n);return e?[{type:"taskList",raw:e.raw,items:e.items}]:n.blockTokens(t)},o=$a(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:function(t){return{indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}},createToken:function(t,e){return{type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}},customNestedParser:r},n);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands:function(){var t=this;return{toggleTaskList:function(){return function(e){return e.commands.toggleList(t.name,t.options.itemTypeName)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Shift-9":function(){return t.editor.commands.toggleTaskList()}}}}),Pd=(ma.create({name:"listKit",addExtensions:function(){var t=[];return!1!==this.options.bulletList&&t.push(md.configure(this.options.bulletList)),!1!==this.options.listItem&&t.push(Dd.configure(this.options.listItem)),!1!==this.options.listKeymap&&t.push(xd.configure(this.options.listKeymap)),!1!==this.options.orderedList&&t.push(Nd.configure(this.options.orderedList)),!1!==this.options.taskItem&&t.push(Id.configure(this.options.taskItem)),!1!==this.options.taskList&&t.push(Ld.configure(this.options.taskList)),t}}),Ha.create({name:"paragraph",priority:1e3,addOptions:function(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML:function(){return[{tag:"p"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["p",fs(this.options.HTMLAttributes,e),0]},parseMarkdown:function(t,e){var n=t.tokens||[];return 1===n.length&&"image"===n[0].type?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:function(t,e){return t&&Array.isArray(t.content)?e.renderChildren(t.content):""},addCommands:function(){var t=this;return{setParagraph:function(){return function(e){return e.commands.setNode(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Alt-0":function(){return t.editor.commands.setParagraph()}}}})),zd=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,$d=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,jd=la.create({name:"strike",addOptions:function(){return{HTMLAttributes:{}}},parseHTML:function(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:function(t){return!!t.includes("line-through")&&{}}}]},renderHTML:function(t){var e=t.HTMLAttributes;return["s",fs(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:function(t,e){return e.applyMark("strike",e.parseInline(t.tokens||[]))},renderMarkdown:function(t,e){return"~~"+e.renderChildren(t)+"~~"},addCommands:function(){var t=this;return{setStrike:function(){return function(e){return e.commands.setMark(t.name)}},toggleStrike:function(){return function(e){return e.commands.toggleMark(t.name)}},unsetStrike:function(){return function(e){return e.commands.unsetMark(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-Shift-s":function(){return t.editor.commands.toggleStrike()}}},addInputRules:function(){return[Sa({find:zd,type:this.type})]},addPasteRules:function(){return[Va({find:$d,type:this.type})]}}),Hd=Ha.create({name:"text",group:"inline",parseMarkdown:function(t){return{type:"text",text:t.text||""}},renderMarkdown:function(t){return t.text||""}}),Vd=la.create({name:"underline",addOptions:function(){return{HTMLAttributes:{}}},parseHTML:function(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:function(t){return!!t.includes("underline")&&{}}}]},renderHTML:function(t){var e=t.HTMLAttributes;return["u",fs(this.options.HTMLAttributes,e),0]},parseMarkdown:function(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown:function(t,e){return"++"+e.renderChildren(t)+"++"},markdownTokenizer:{name:"underline",level:"inline",start:function(t){return t.indexOf("++")},tokenize:function(t,e,n){var r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(r){var o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}}},addCommands:function(){var t=this;return{setUnderline:function(){return function(e){return e.commands.setMark(t.name)}},toggleUnderline:function(){return function(e){return e.commands.toggleMark(t.name)}},unsetUnderline:function(){return function(e){return e.commands.unsetMark(t.name)}}}},addKeyboardShortcuts:function(){var t=this;return{"Mod-u":function(){return t.editor.commands.toggleUnderline()},"Mod-U":function(){return t.editor.commands.toggleUnderline()}}}});var _d=function(){function t(t,e){var n,r=this;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=e.width)&&void 0!==n?n:1,this.color=!1===e.color?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(function(e){var n=function(t){r[e](t)};return t.dom.addEventListener(e,n),{name:e,handler:n}})}var e=t.prototype;return e.destroy=function(){var t=this;this.handlers.forEach(function(e){var n=e.name,r=e.handler;return t.editorView.dom.removeEventListener(n,r)})},e.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},e.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},e.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,u=o.height/r.offsetHeight;if(n){var s=e.nodeBefore,a=e.nodeAfter;if(s||a){var c=this.editorView.nodeDOM(this.cursorPos-(s?s.nodeSize:0));if(c){var l=c.getBoundingClientRect(),d=s?l.bottom:l.top;s&&a&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);var f=this.width/2*u;t={left:l.left,right:l.right,top:d-f,bottom:d+f}}}}if(!t){var h=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*i;t={left:h.left-p,right:h.left+p,top:h.top,bottom:h.bottom}}var m,D,v=this.editorView.dom.offsetParent;if(this.element||(this.element=v.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!v||v==document.body&&"static"==getComputedStyle(v).position)m=-pageXOffset,D=-pageYOffset;else{var g=v.getBoundingClientRect(),F=g.width/v.offsetWidth,y=g.height/v.offsetHeight;m=g.left-v.scrollLeft*F,D=g.top-v.scrollTop*y}this.element.style.left=(t.left-m)/i+"px",this.element.style.top=(t.top-D)/u+"px",this.element.style.width=(t.right-t.left)/i+"px",this.element.style.height=(t.bottom-t.top)/u+"px"},e.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return e.setCursor(null)},t)},e.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,e,t):r;if(e&&!o){var i=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){var u=oe(this.editorView.state.doc,i,this.editorView.dragging.slice);null!=u&&(i=u)}this.setCursor(i),this.scheduleRemoval(5e3)}}},e.dragend=function(){this.scheduleRemoval(20)},e.drop=function(){this.scheduleRemoval(20)},e.dragleave=function(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)},t}(),qd=function(t){function e(e){return t.call(this,e,e)||this}a(e,t);var n=e.prototype;return n.map=function(t,n){var r=t.resolve(n.map(this.head));return e.valid(r)?new e(r):Ce.near(r)},n.content=function(){return S.empty},n.eq=function(t){return t instanceof e&&t.head==this.head},n.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},n.getBookmark=function(){return new Wd(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!function(t){for(var e=t.depth;e>=0;e--){var n=t.index(e),r=t.node(e);if(0!=n)for(var o=r.child(n-1);;o=o.lastChild){if(0==o.childCount&&!o.inlineContent||Kd(o.type))return!0;if(o.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t)||!function(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||Kd(o.type))return!0;if(o.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(t))return!1;var n=e.type.spec.allowGapCursor;if(null!=n)return n;var r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock},e.findGapCursorFrom=function(t,n,r){void 0===r&&(r=!1);t:for(;;){if(!r&&e.valid(t))return t;for(var o=t.pos,i=null,u=t.depth;;u--){var s=t.node(u);if(n>0?t.indexAfter(u)<s.childCount:t.index(u)>0){i=s.child(n>0?t.indexAfter(u):t.index(u)-1);break}if(0==u)return null;o+=n;var a=t.doc.resolve(o);if(e.valid(a))return a}for(;;){var c=n>0?i.firstChild:i.lastChild;if(!c){if(i.isAtom&&!i.isText&&!xe.isSelectable(i)){t=t.doc.resolve(o+i.nodeSize*n),r=!1;continue t}break}i=c,o+=n;var l=t.doc.resolve(o);if(e.valid(l))return l}return null}},e}(Ce);qd.prototype.visible=!1,qd.findFrom=qd.findGapCursorFrom,Ce.jsonID("gapcursor",qd);var Wd=function(){function t(t){this.pos=t}var e=t.prototype;return e.map=function(e){return new t(e.map(this.pos))},e.resolve=function(t){var e=t.resolve(this.pos);return qd.valid(e)?new qd(e):Ce.near(e)},t}();function Kd(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}var Ud=_i({ArrowLeft:Jd("horiz",-1),ArrowRight:Jd("horiz",1),ArrowUp:Jd("vert",-1),ArrowDown:Jd("vert",1)});function Jd(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){var i=t.selection,u=e>0?i.$to:i.$from,s=i.empty;if(i instanceof be){if(!o.endOfTextblock(n)||0==u.depth)return!1;s=!1,u=t.doc.resolve(e>0?u.after():u.before())}var a=qd.findGapCursorFrom(u,e,s);return!!a&&(r&&r(t.tr.setSelection(new qd(a))),!0)}}function Gd(t,e,n){if(!t||!t.editable)return!1;var r=t.state.doc.resolve(e);if(!qd.valid(r))return!1;var o=t.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&xe.isSelectable(t.state.doc.nodeAt(o.inside))||(t.dispatch(t.state.tr.setSelection(new qd(r))),0))}function Zd(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof qd))return!1;var n=t.state.selection.$from,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;for(var o=E.empty,i=r.length-1;i>=0;i--)o=E.from(r[i].createAndFill(null,o));var u=t.state.tr.replace(n.pos,n.pos,new S(o,0,0));return u.setSelection(be.near(u.doc.resolve(n.pos+1))),t.dispatch(u),!1}function Qd(t){if(!(t.selection instanceof qd))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",ni.create(t.doc,[Yo.widget(t.selection.head,e,{key:"gapcursor"})])}var Xd=200,Yd=function(){};Yd.prototype.append=function(t){return t.length?(t=Yd.from(t),!this.length&&t||t.length<Xd&&this.leafAppend(t)||this.length<Xd&&t.leafPrepend(this)||this.appendInner(t)):this},Yd.prototype.prepend=function(t){return t.length?Yd.from(t).append(this):this},Yd.prototype.appendInner=function(t){return new ef(this,t)},Yd.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?Yd.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Yd.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Yd.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Yd.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(e,n){return r.push(t(e,n))},e,n),r},Yd.from=function(t){return t instanceof Yd?t:t&&t.length?new tf(t):Yd.empty};var tf=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=Xd)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=Xd)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Yd);Yd.empty=new tf([]);var ef=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(Yd);const nf=Yd;var rf=function(){function t(t,e){this.items=t,this.eventCount=e}var e=t.prototype;return e.popEvent=function(e,n){var r=this;if(0==this.eventCount)return null;for(var o,i,u=this.items.length;;u--)if(this.items.get(u-1).selection){--u;break}n&&(o=this.remapping(u,this.items.length),i=o.maps.length);var s,a,c=e.tr,l=[],d=[];return this.items.forEach(function(e,n){if(!e.step)return o||(o=r.remapping(u,n+1),i=o.maps.length),i--,void d.push(e);if(o){d.push(new of(e.map));var f,h=e.step.map(o.slice(i));h&&c.maybeStep(h).doc&&(f=c.mapping.maps[c.mapping.maps.length-1],l.push(new of(f,void 0,void 0,l.length+d.length))),i--,f&&o.appendMap(f,i)}else c.maybeStep(e.step);return e.selection?(s=o?e.selection.map(o.slice(i)):e.selection,a=new t(r.items.slice(0,u).append(d.reverse().concat(l)),r.eventCount-1),!1):void 0},this.items.length,0),{remaining:a,transform:c,selection:s}},e.addTransform=function(e,n,r,o){for(var i=[],u=this.eventCount,s=this.items,a=!o&&s.length?s.get(s.length-1):null,c=0;c<e.steps.length;c++){var l,d=e.steps[c].invert(e.docs[c]),f=new of(e.mapping.maps[c],d,n);(l=a&&a.merge(f))&&(f=l,c?i.pop():s=s.slice(0,s.length-1)),i.push(f),n&&(u++,n=void 0),o||(a=f)}var h,p,m,D=u-r.depth;return D>sf&&(p=D,(h=s).forEach(function(t,e){if(t.selection&&0==p--)return m=e,!1}),s=h.slice(m),u-=D),new t(s.append(i),u)},e.remapping=function(t,e){var n=new It;return this.items.forEach(function(e,r){var o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:void 0;n.appendMap(e.map,o)},t,e),n},e.addMaps=function(e){return 0==this.eventCount?this:new t(this.items.append(e.map(function(t){return new of(t)})),this.eventCount)},e.rebased=function(e,n){if(!this.eventCount)return this;var r=[],o=Math.max(0,this.items.length-n),i=e.mapping,u=e.steps.length,s=this.eventCount;this.items.forEach(function(t){t.selection&&s--},o);var a=n;this.items.forEach(function(t){var n=i.getMirror(--a);if(null!=n){u=Math.min(u,n);var o=i.maps[n];if(t.step){var c=e.steps[n].invert(e.docs[n]),l=t.selection&&t.selection.map(i.slice(a+1,n));l&&s++,r.push(new of(o,c,l))}else r.push(new of(o))}},o);for(var c=[],l=n;l<u;l++)c.push(new of(i.maps[l]));var d=new t(this.items.slice(0,o).append(c).append(r),s);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-r.length)),d},e.emptyItemCount=function(){var t=0;return this.items.forEach(function(e){e.step||t++}),t},e.compress=function(e){void 0===e&&(e=this.items.length);var n=this.remapping(0,e),r=n.maps.length,o=[],i=0;return this.items.forEach(function(t,u){if(u>=e)o.push(t),t.selection&&i++;else if(t.step){var s=t.step.map(n.slice(r)),a=s&&s.getMap();if(r--,a&&n.appendMap(a,r),s){var c=t.selection&&t.selection.map(n.slice(r));c&&i++;var l,d=new of(a.invert(),s,c),f=o.length-1;(l=o.length&&o[f].merge(d))?o[f]=l:o.push(d)}}else t.map&&r--},this.items.length,0),new t(nf.from(o.reverse()),i)},t}();rf.empty=new rf(nf.empty,0);var of=function(){function t(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r}return t.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var n=e.step.merge(this.step);if(n)return new t(n.getMap().invert(),n,this.selection)}},t}(),uf=function(t,e,n,r,o){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r,this.prevComposition=o},sf=20;function af(t){for(var e=[],n=t.length-1;n>=0&&0==e.length;n--)t[n].forEach(function(t,n,r,o){return e.push(r,o)});return e}function cf(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}var lf=!1,df=null;function ff(t){var e=t.plugins;if(df!=e){lf=!1,df=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){lf=!0;break}}return lf}var hf=new _e("history"),pf=new _e("closeHistory");function mf(t,e){return function(n,r){var o=hf.getState(n);if(!o||0==(t?o.undone:o.done).eventCount)return!1;if(r){var i=function(t,e,n){var r=ff(e),o=hf.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;var u=i.selection.resolve(i.transform.doc),s=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),o,r),a=new uf(n?s:i.remaining,n?i.remaining:s,null,0,-1);return i.transform.setSelection(u).setMeta(hf,{redo:n,historyState:a})}(o,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}var Df=mf(!1,!0),vf=mf(!0,!0);mf(!1,!1),mf(!0,!1),ma.create({name:"characterCount",addOptions:function(){return{limit:null,mode:"textSize",textCounter:function(t){return t.length},wordCounter:function(t){return t.split(" ").filter(function(t){return""!==t}).length}}},addStorage:function(){return{characters:function(){return 0},words:function(){return 0}}},onBeforeCreate:function(){var t=this;this.storage.characters=function(e){var n=(null==e?void 0:e.node)||t.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||t.options.mode)){var r=n.textBetween(0,n.content.size,void 0," ");return t.options.textCounter(r)}return n.nodeSize},this.storage.words=function(e){var n=(null==e?void 0:e.node)||t.editor.state.doc,r=n.textBetween(0,n.content.size," "," ");return t.options.wordCounter(r)}},addProseMirrorPlugins:function(){var t=this,e=!1;return[new je({key:new _e("characterCount"),appendTransaction:function(n,r,o){if(!e){var i=t.options.limit;if(null!=i&&0!==i){var u=t.storage.characters({node:o.doc});if(u>i){var s=u-i;console.warn("[CharacterCount] Initial content exceeded limit of "+i+" characters. Content was automatically trimmed.");var a=o.tr.deleteRange(0,s);return e=!0,a}e=!0}else e=!0}},filterTransaction:function(e,n){var r=t.options.limit;if(!e.docChanged||0===r||null==r)return!0;var o=t.storage.characters({node:n.doc}),i=t.storage.characters({node:e.doc});if(i<=r)return!0;if(o>r&&i>r&&i<=o)return!0;if(o>r&&i>r&&i>o)return!1;if(!e.getMeta("paste"))return!1;var u=e.selection.$head.pos,s=u-(i-r),a=u;return e.deleteRange(s,a),!(t.storage.characters({node:e.doc})>r)}})]}});var gf=ma.create({name:"dropCursor",addOptions:function(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins:function(){return[(t=this.options,void 0===t&&(t={}),new je({view:function(e){return new _d(e,t)}}))];var t}}),Ff=(ma.create({name:"focus",addOptions:function(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("focus"),props:{decorations:function(e){var n=e.doc,r=e.selection,o=t.editor,i=o.isEditable,u=o.isFocused,s=r.anchor,a=[];if(!i||!u)return ni.create(n,[]);var c=0;"deepest"===t.options.mode&&n.descendants(function(t,e){if(!t.isText){if(!(s>=e&&s<=e+t.nodeSize-1))return!1;c+=1}});var l=0;return n.descendants(function(e,n){return!e.isText&&s>=n&&s<=n+e.nodeSize-1&&(l+=1,"deepest"===t.options.mode&&c-l>0||"shallowest"===t.options.mode&&l>1?"deepest"===t.options.mode:void a.push(Yo.node(n,n+e.nodeSize,{class:t.options.className})))}),ni.create(n,a)}}})]}}),ma.create({name:"gapCursor",addProseMirrorPlugins:function(){return[new je({props:{decorations:Qd,createSelectionBetween:function(t,e,n){return e.pos==n.pos&&qd.valid(n)?new qd(n):null},handleClick:Gd,handleKeyDown:Ud,handleDOMEvents:{beforeinput:Zd}}})]},extendNodeSchema:function(t){var e;return{allowGapCursor:null!=(e=cs(is(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))?e:null}}})),yf=ma.create({name:"placeholder",addOptions:function(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins:function(){var t=this;return[new je({key:new _e("placeholder"),props:{decorations:function(e){var n=e.doc,r=e.selection,o=t.editor.isEditable||!t.options.showOnlyWhenEditable,i=r.anchor,u=[];if(!o)return null;var s=t.editor.isEmpty;return n.descendants(function(e,n){var r=i>=n&&i<=n+e.nodeSize,o=!e.isLeaf&&Ms(e);if((r||!t.options.showOnlyCurrent)&&o){var a=[t.options.emptyNodeClass];s&&a.push(t.options.emptyEditorClass);var c=Yo.node(n,n+e.nodeSize,{class:a.join(" "),"data-placeholder":"function"==typeof t.options.placeholder?t.options.placeholder({editor:t.editor,node:e,pos:n,hasAnchor:r}):t.options.placeholder});u.push(c)}return t.options.includeChildren}),ni.create(n,u)}}})]}});function Cf(t){var e=t.types,n=t.node;return n&&Array.isArray(e)&&e.includes(n.type)||(null==n?void 0:n.type)===e}ma.create({name:"selection",addOptions:function(){return{className:"selection"}},addProseMirrorPlugins:function(){var t=this.editor,e=this.options;return[new je({key:new _e("selection"),props:{decorations:function(n){return n.selection.empty||t.isFocused||!t.isEditable||Ts(n.selection)||t.view.dragging?null:ni.create(n.doc,[Yo.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});var kf,Ef=ma.create({name:"trailingNode",addOptions:function(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins:function(){var t,e=this,n=new _e(this.name),r=this.options.node||(null==(t=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:t.name)||"paragraph",o=Object.entries(this.editor.schema.nodes).map(function(t){return t[1]}).filter(function(t){return(e.options.notAfter||[]).concat(r).includes(t.name)});return[new je({key:n,appendTransaction:function(t,e,o){var i=o.doc,u=o.tr,s=o.schema,a=n.getState(o),c=i.content.size,l=s.nodes[r];if(a)return u.insert(c,l.create())},state:{init:function(t,e){return!Cf({node:e.tr.doc.lastChild,types:o})},apply:function(t,e){return t.docChanged?t.getMeta("__uniqueIDTransaction")?e:!Cf({node:t.doc.lastChild,types:o}):e}}})]}}),Af=ma.create({name:"undoRedo",addOptions:function(){return{depth:100,newGroupDelay:500}},addCommands:function(){return{undo:function(){return function(t){var e=t.state,n=t.dispatch;return Df(e,n)}},redo:function(){return function(t){var e=t.state,n=t.dispatch;return vf(e,n)}}}},addProseMirrorPlugins:function(){return[(t=this.options,void 0===t&&(t={}),t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new je({key:hf,state:{init:function(){return new uf(rf.empty,rf.empty,null,0,-1)},apply:function(e,n,r){return function(t,e,n,r){var o,i=n.getMeta(hf);if(i)return i.historyState;n.getMeta(pf)&&(t=new uf(t.done,t.undone,null,0,-1));var u=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(u&&u.getMeta(hf))return u.getMeta(hf).redo?new uf(t.done.addTransform(n,void 0,r,ff(e)),t.undone,af(n.mapping.maps),t.prevTime,t.prevComposition):new uf(t.done,t.undone.addTransform(n,void 0,r,ff(e)),null,t.prevTime,t.prevComposition);if(!1===n.getMeta("addToHistory")||u&&!1===u.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new uf(t.done.rebased(n,o),t.undone.rebased(n,o),cf(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new uf(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),cf(t.prevRanges,n.mapping),t.prevTime,t.prevComposition);var s=n.getMeta("composition"),a=0==t.prevTime||!u&&t.prevComposition!=s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach(function(t,r){for(var o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)}),n}(n,t.prevRanges)),c=u?cf(t.prevRanges,n.mapping):af(n.mapping.maps);return new uf(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,ff(e)),rf.empty,c,n.time,null==s?t.prevComposition:s)}(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput:function(t,e){var n=e.inputType,r="historyUndo"==n?Df:"historyRedo"==n?vf:null;return!(!r||!t.editable)&&(e.preventDefault(),r(t.state,t.dispatch))}}}}))];var t},addKeyboardShortcuts:function(){var t=this;return{"Mod-z":function(){return t.editor.commands.undo()},"Shift-Mod-z":function(){return t.editor.commands.redo()},"Mod-y":function(){return t.editor.commands.redo()},"Mod-":function(){return t.editor.commands.undo()},"Shift-Mod-":function(){return t.editor.commands.redo()}}}}),bf=ma.create({name:"starterKit",addExtensions:function(){var t,e,n,r,o=[];return!1!==this.options.bold&&o.push(Xa.configure(this.options.bold)),!1!==this.options.blockquote&&o.push(Ua.configure(this.options.blockquote)),!1!==this.options.bulletList&&o.push(md.configure(this.options.bulletList)),!1!==this.options.code&&o.push(ec.configure(this.options.code)),!1!==this.options.codeBlock&&o.push(oc.configure(this.options.codeBlock)),!1!==this.options.document&&o.push(ic.configure(this.options.document)),!1!==this.options.dropcursor&&o.push(gf.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&o.push(Ff.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&o.push(uc.configure(this.options.hardBreak)),!1!==this.options.heading&&o.push(sc.configure(this.options.heading)),!1!==this.options.undoRedo&&o.push(Af.configure(this.options.undoRedo)),!1!==this.options.horizontalRule&&o.push(ac.configure(this.options.horizontalRule)),!1!==this.options.italic&&o.push(hc.configure(this.options.italic)),!1!==this.options.listItem&&o.push(Dd.configure(this.options.listItem)),!1!==this.options.listKeymap&&o.push(xd.configure(null==(t=this.options)?void 0:t.listKeymap)),!1!==this.options.link&&o.push(ld.configure(null==(e=this.options)?void 0:e.link)),!1!==this.options.orderedList&&o.push(Nd.configure(this.options.orderedList)),!1!==this.options.paragraph&&o.push(Pd.configure(this.options.paragraph)),!1!==this.options.strike&&o.push(jd.configure(this.options.strike)),!1!==this.options.text&&o.push(Hd.configure(this.options.text)),!1!==this.options.underline&&o.push(Vd.configure(null==(n=this.options)?void 0:n.underline)),!1!==this.options.trailingNode&&o.push(Ef.configure(null==(r=this.options)?void 0:r.trailingNode)),o}});function wf(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return xf(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xf(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Bf={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Sf(t){Bf=t}var Mf={exec:function(){return null}};function Tf(t,e){void 0===e&&(e="");var n="string"==typeof t?t:t.source,r={replace:function(t,e){var o="string"==typeof e?e:e.source;return o=o.replace(Of.caret,"$1"),n=n.replace(t,o),r},getRegex:function(){return new RegExp(n,e)}};return r}var Of={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDD40-\uDD65\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])/,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:function(t){return new RegExp("^( {0,3}"+t+")((?:[\t ][^\\n]*)?(?:\\n|$))")},nextBulletRegex:function(t){return new RegExp("^ {0,"+Math.min(3,t-1)+"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))")},hrRegex:function(t){return new RegExp("^ {0,"+Math.min(3,t-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")},fencesBeginRegex:function(t){return new RegExp("^ {0,"+Math.min(3,t-1)+"}(?:```|~~~)")},headingBeginRegex:function(t){return new RegExp("^ {0,"+Math.min(3,t-1)+"}#")},htmlBeginRegex:function(t){return new RegExp("^ {0,"+Math.min(3,t-1)+"}<(?:[a-z].*>|!--)","i")}},Nf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Rf=/(?:[*+-]|\d{1,9}[.)])/,If=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Lf=Tf(If).replace(/bull/g,Rf).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Pf=Tf(If).replace(/bull/g,Rf).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),zf=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$f=/(?!\s*\])(?:\\.|[^\[\]\\])+/,jf=Tf(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",$f).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Hf=Tf(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Rf).getRegex(),Vf="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_f=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,qf=Tf("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",_f).replace("tag",Vf).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Wf=Tf(zf).replace("hr",Nf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vf).getRegex(),Kf={blockquote:Tf(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Wf).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:jf,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:Nf,html:qf,lheading:Lf,list:Hf,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:Wf,table:Mf,text:/^[^\n]+/},Uf=Tf("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Nf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vf).getRegex(),Jf=h({},Kf,{lheading:Pf,table:Uf,paragraph:Tf(zf).replace("hr",Nf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Uf).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vf).getRegex()}),Gf=h({},Kf,{html:Tf("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",_f).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Mf,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Tf(zf).replace("hr",Nf).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Lf).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()}),Zf=/^( {2,}|\\)\n(?!\s*$)/,Qf=/(?:[!-\/:-@\[-`\{-~\xA1-\xA9\xAB\xAC\xAE-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060F\u061B\u061D-\u061F\u066A-\u066D\u06D4\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u0888\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C77\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u20A0-\u20C1\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2BFF\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uAB6A\uAB6B\uABEB\uFB29\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDCF\uFDFC-\uFDFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDD8E\uDD8F\uDEAD\uDED0-\uDED8\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3F]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFD5-\uDFF1\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F[\uDC9C\uDC9F]|\uD833[\uDC00-\uDCEF\uDCFA-\uDCFC\uDD00-\uDEB3\uDEBA-\uDED0\uDEE0-\uDEF0\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD838[\uDD4F\uDEFF]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED8\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDCD0-\uDCD8\uDD00-\uDE57\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF\uDFFA])/,Xf=/(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB\xAC\xAE-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060F\u061B\u061D-\u061F\u066A-\u066D\u06D4\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u0888\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C77\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u200A\u2010-\u2029\u202F-\u205F\u207A-\u207E\u208A-\u208E\u20A0-\u20C1\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2BFF\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uAB6A\uAB6B\uABEB\uFB29\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDCF\uFDFC-\uFDFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDD8E\uDD8F\uDEAD\uDED0-\uDED8\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3F]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFD5-\uDFF1\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F[\uDC9C\uDC9F]|\uD833[\uDC00-\uDCEF\uDCFA-\uDCFC\uDD00-\uDEB3\uDEBA-\uDED0\uDEE0-\uDEF0\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD838[\uDD4F\uDEFF]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED8\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDCD0-\uDCD8\uDD00-\uDE57\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF\uDFFA])/,Yf=/(?:[\0-\x08\x0E-\x1F0-9A-Za-z\x7F-\x9F\xAA\xAD\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376-\u037D\u037F-\u0383\u0386\u0388-\u03F5\u03F7-\u0481\u0483-\u0559\u0560-\u0588\u058B\u058C\u0590-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0605\u0610-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06DD\u06DF-\u06E8\u06EA-\u06FC\u06FF\u070E-\u07F5\u07FA-\u07FD\u0800-\u082F\u083F-\u085D\u085F-\u0887\u0889-\u0963\u0966-\u096F\u0971-\u09F1\u09F4-\u09F9\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF2-\u0B6F\u0B71-\u0BF2\u0BFB-\u0C76\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0D4E\u0D50-\u0D78\u0D7A-\u0DF3\u0DF5-\u0E3E\u0E40-\u0E4E\u0E50-\u0E59\u0E5C-\u0F00\u0F18\u0F19\u0F20-\u0F33\u0F35\u0F37\u0F39\u0F3E-\u0F84\u0F86-\u0FBD\u0FC6\u0FCD\u0FDB-\u1049\u1050-\u109D\u10A0-\u10FA\u10FC-\u135F\u1369-\u138F\u139A-\u13FF\u1401-\u166C\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DC-\u17FF\u180B-\u193F\u1941-\u1943\u1946-\u19DD\u1A00-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FBC\u1FBE\u1FC2-\u1FCC\u1FD0-\u1FDC\u1FE0-\u1FEC\u1FF0-\u1FFC\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u2079\u207F-\u2089\u208F-\u209F\u20C2-\u20FF\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u218C-\u218F\u242A-\u243F\u244B-\u249B\u24EA-\u24FF\u2776-\u2793\u2B74\u2B75\u2C00-\u2CE4\u2CEB-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E5E-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3040-\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u318F\u3192-\u3195\u31A0-\u31BF\u31E6-\u31EE\u31F0-\u31FF\u321F-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48F\uA4C7-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA6FF\uA717-\uA71F\uA722-\uA788\uA78B-\uA827\uA82C-\uA835\uA83A-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAA76\uAA7A-\uAADD\uAAE0-\uAAEF\uAAF2-\uAB5A\uAB5C-\uAB69\uAB6C-\uABEA\uABEC-\uD7FF\uE000-\uFB28\uFB2A-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDD0-\uFDFB\uFE00-\uFE0F\uFE1A-\uFE2F\uFE53\uFE67\uFE6C-\uFEFE\uFF00\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDD36\uDD40-\uDD78\uDD8A\uDD8B\uDD8F\uDD9D-\uDD9F\uDDA1-\uDDCF\uDDFD-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDC76\uDC79-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEC7\uDEC9-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDD8D\uDD90-\uDEAC\uDEAE-\uDECF\uDED9-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF40-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFD4\uDFF2-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD832\uD837\uD83F-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF40-\uDF43\uDF46-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9B\uDC9D\uDC9E\uDCA0-\uDFFF]|\uD833[\uDCF0-\uDCF9\uDCFD-\uDCFF\uDEB4-\uDEB9\uDED1-\uDEDF\uDEF1-\uDF4F\uDFC4-\uDFFF]|\uD834[\uDCF6-\uDCFF\uDD27\uDD28\uDD65-\uDD69\uDD6D-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDDEB-\uDDFF\uDE42-\uDE44\uDE46-\uDEFF\uDF57-\uDFFF]|\uD835[\uDC00-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE8C-\uDFFF]|\uD838[\uDC00-\uDD4E\uDD50-\uDEFE\uDF00-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF]|\uD83B[\uDC00-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDD2D\uDD2F-\uDEEF\uDEF2-\uDFFF]|\uD83C[\uDC2C-\uDC2F\uDC94-\uDC9F\uDCAF\uDCB0\uDCC0\uDCD0\uDCF6-\uDD0C\uDDAE-\uDDE5\uDE03-\uDE0F\uDE3C-\uDE3F\uDE49-\uDE4F\uDE52-\uDE5F\uDE66-\uDEFF]|\uD83D[\uDED9-\uDEDB\uDEED-\uDEEF\uDEFD-\uDEFF\uDFDA-\uDFDF\uDFEC-\uDFEF\uDFF1-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE\uDCAF\uDCBC-\uDCBF\uDCC2-\uDCCF\uDCD9-\uDCFF\uDE58-\uDE5F\uDE6E\uDE6F\uDE7D-\uDE7F\uDE8B-\uDE8D\uDEC7\uDEC9-\uDECC\uDEDD\uDEDE\uDEEB-\uDEEE\uDEF9-\uDEFF\uDF93\uDFF0-\uDFF9\uDFFB-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,th=Tf(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Xf).getRegex(),eh=/(?!~)(?:[!-\/:-@\[-`\{-~\xA1-\xA9\xAB\xAC\xAE-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060F\u061B\u061D-\u061F\u066A-\u066D\u06D4\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u0888\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C77\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u20A0-\u20C1\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2BFF\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uAB6A\uAB6B\uABEB\uFB29\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDCF\uFDFC-\uFDFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDD8E\uDD8F\uDEAD\uDED0-\uDED8\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3F]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFD5-\uDFF1\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F[\uDC9C\uDC9F]|\uD833[\uDC00-\uDCEF\uDCFA-\uDCFC\uDD00-\uDEB3\uDEBA-\uDED0\uDEE0-\uDEF0\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD838[\uDD4F\uDEFF]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED8\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDCD0-\uDCD8\uDD00-\uDE57\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF\uDFFA])/,nh=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,rh=Tf(nh,"u").replace(/punct/g,Qf).getRegex(),oh=Tf(nh,"u").replace(/punct/g,eh).getRegex(),ih="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",uh=Tf(ih,"gu").replace(/notPunctSpace/g,Yf).replace(/punctSpace/g,Xf).replace(/punct/g,Qf).getRegex(),sh=Tf(ih,"gu").replace(/notPunctSpace/g,/(?:(?:[\0-\x08\x0E-\x1F0-9A-Za-z\x7F-\x9F\xAA\xAD\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376-\u037D\u037F-\u0383\u0386\u0388-\u03F5\u03F7-\u0481\u0483-\u0559\u0560-\u0588\u058B\u058C\u0590-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05F2\u05F5-\u0605\u0610-\u061A\u061C\u0620-\u0669\u066E-\u06D3\u06D5-\u06DD\u06DF-\u06E8\u06EA-\u06FC\u06FF\u070E-\u07F5\u07FA-\u07FD\u0800-\u082F\u083F-\u085D\u085F-\u0887\u0889-\u0963\u0966-\u096F\u0971-\u09F1\u09F4-\u09F9\u09FC\u09FE-\u0A75\u0A77-\u0AEF\u0AF2-\u0B6F\u0B71-\u0BF2\u0BFB-\u0C76\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0D4E\u0D50-\u0D78\u0D7A-\u0DF3\u0DF5-\u0E3E\u0E40-\u0E4E\u0E50-\u0E59\u0E5C-\u0F00\u0F18\u0F19\u0F20-\u0F33\u0F35\u0F37\u0F39\u0F3E-\u0F84\u0F86-\u0FBD\u0FC6\u0FCD\u0FDB-\u1049\u1050-\u109D\u10A0-\u10FA\u10FC-\u135F\u1369-\u138F\u139A-\u13FF\u1401-\u166C\u166F-\u167F\u1681-\u169A\u169D-\u16EA\u16EE-\u1734\u1737-\u17D3\u17D7\u17DC-\u17FF\u180B-\u193F\u1941-\u1943\u1946-\u19DD\u1A00-\u1A1D\u1A20-\u1A9F\u1AA7\u1AAE-\u1B4D\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BFB\u1C00-\u1C3A\u1C40-\u1C7D\u1C80-\u1CBF\u1CC8-\u1CD2\u1CD4-\u1FBC\u1FBE\u1FC2-\u1FCC\u1FD0-\u1FDC\u1FE0-\u1FEC\u1FF0-\u1FFC\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u2079\u207F-\u2089\u208F-\u209F\u20C2-\u20FF\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u218C-\u218F\u242A-\u243F\u244B-\u249B\u24EA-\u24FF\u2776-\u2793\u2B74\u2B75\u2C00-\u2CE4\u2CEB-\u2CF8\u2CFD\u2D00-\u2D6F\u2D71-\u2DFF\u2E2F\u2E5E-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3040-\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u318F\u3192-\u3195\u31A0-\u31BF\u31E6-\u31EE\u31F0-\u31FF\u321F-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48F\uA4C7-\uA4FD\uA500-\uA60C\uA610-\uA672\uA674-\uA67D\uA67F-\uA6F1\uA6F8-\uA6FF\uA717-\uA71F\uA722-\uA788\uA78B-\uA827\uA82C-\uA835\uA83A-\uA873\uA878-\uA8CD\uA8D0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA95E\uA960-\uA9C0\uA9CE-\uA9DD\uA9E0-\uAA5B\uAA60-\uAA76\uAA7A-\uAADD\uAAE0-\uAAEF\uAAF2-\uAB5A\uAB5C-\uAB69\uAB6C-\uABEA\uABEC-\uD7FF\uE000-\uFB28\uFB2A-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDD0-\uFDFB\uFE00-\uFE0F\uFE1A-\uFE2F\uFE53\uFE67\uFE6C-\uFEFE\uFF00\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]|\uD800[\uDC00-\uDCFF\uDD03-\uDD36\uDD40-\uDD78\uDD8A\uDD8B\uDD8F\uDD9D-\uDD9F\uDDA1-\uDDCF\uDDFD-\uDF9E\uDFA0-\uDFCF\uDFD1-\uDFFF]|\uD801[\uDC00-\uDD6E\uDD70-\uDFFF]|\uD802[\uDC00-\uDC56\uDC58-\uDC76\uDC79-\uDD1E\uDD20-\uDD3E\uDD40-\uDE4F\uDE59-\uDE7E\uDE80-\uDEC7\uDEC9-\uDEEF\uDEF7-\uDF38\uDF40-\uDF98\uDF9D-\uDFFF]|\uD803[\uDC00-\uDD6D\uDD6F-\uDD8D\uDD90-\uDEAC\uDEAE-\uDECF\uDED9-\uDF54\uDF5A-\uDF85\uDF8A-\uDFFF]|\uD804[\uDC00-\uDC46\uDC4E-\uDCBA\uDCBD\uDCC2-\uDD3F\uDD44-\uDD73\uDD76-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDDE0-\uDE37\uDE3E-\uDEA8\uDEAA-\uDFD3\uDFD6\uDFD9-\uDFFF]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5C\uDC5E-\uDCC5\uDCC7-\uDDC0\uDDD8-\uDE40\uDE44-\uDE5F\uDE6D-\uDEB8\uDEBA-\uDF3B\uDF40-\uDFFF]|\uD806[\uDC00-\uDC3A\uDC3C-\uDD43\uDD47-\uDDE1\uDDE3-\uDE3E\uDE47-\uDE99\uDE9D\uDEA3-\uDEFF\uDF0A-\uDFE0\uDFE2-\uDFFF]|\uD807[\uDC00-\uDC40\uDC46-\uDC6F\uDC72-\uDEF6\uDEF9-\uDF42\uDF50-\uDFD4\uDFF2-\uDFFE]|[\uD808\uD80A\uD80C-\uD819\uD81C-\uD82E\uD830-\uD832\uD837\uD83F-\uDBFF][\uDC00-\uDFFF]|\uD809[\uDC00-\uDC6F\uDC75-\uDFFF]|\uD80B[\uDC00-\uDFF0\uDFF3-\uDFFF]|\uD81A[\uDC00-\uDE6D\uDE70-\uDEF4\uDEF6-\uDF36\uDF40-\uDF43\uDF46-\uDFFF]|\uD81B[\uDC00-\uDD6C\uDD70-\uDE96\uDE9B-\uDFE1\uDFE3-\uDFFF]|\uD82F[\uDC00-\uDC9B\uDC9D\uDC9E\uDCA0-\uDFFF]|\uD833[\uDCF0-\uDCF9\uDCFD-\uDCFF\uDEB4-\uDEB9\uDED1-\uDEDF\uDEF1-\uDF4F\uDFC4-\uDFFF]|\uD834[\uDCF6-\uDCFF\uDD27\uDD28\uDD65-\uDD69\uDD6D-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDDEB-\uDDFF\uDE42-\uDE44\uDE46-\uDEFF\uDF57-\uDFFF]|\uD835[\uDC00-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE8C-\uDFFF]|\uD838[\uDC00-\uDD4E\uDD50-\uDEFE\uDF00-\uDFFF]|\uD839[\uDC00-\uDDFE\uDE00-\uDFFF]|\uD83A[\uDC00-\uDD5D\uDD60-\uDFFF]|\uD83B[\uDC00-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDD2D\uDD2F-\uDEEF\uDEF2-\uDFFF]|\uD83C[\uDC2C-\uDC2F\uDC94-\uDC9F\uDCAF\uDCB0\uDCC0\uDCD0\uDCF6-\uDD0C\uDDAE-\uDDE5\uDE03-\uDE0F\uDE3C-\uDE3F\uDE49-\uDE4F\uDE52-\uDE5F\uDE66-\uDEFF]|\uD83D[\uDED9-\uDEDB\uDEED-\uDEEF\uDEFD-\uDEFF\uDFDA-\uDFDF\uDFEC-\uDFEF\uDFF1-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE\uDCAF\uDCBC-\uDCBF\uDCC2-\uDCCF\uDCD9-\uDCFF\uDE58-\uDE5F\uDE6E\uDE6F\uDE7D-\uDE7F\uDE8B-\uDE8D\uDEC7\uDEC9-\uDECC\uDEDD\uDEDE\uDEEB-\uDEEE\uDEF9-\uDEFF\uDF93\uDFF0-\uDFF9\uDFFB-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|~)/).replace(/punctSpace/g,/(?!~)(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB\xAC\xAE-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060F\u061B\u061D-\u061F\u066A-\u066D\u06D4\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u0888\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C77\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u200A\u2010-\u2029\u202F-\u205F\u207A-\u207E\u208A-\u208E\u20A0-\u20C1\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2BFF\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uAB6A\uAB6B\uABEB\uFB29\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDCF\uFDFC-\uFDFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDD8E\uDD8F\uDEAD\uDED0-\uDED8\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3F]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFD5-\uDFF1\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F[\uDC9C\uDC9F]|\uD833[\uDC00-\uDCEF\uDCFA-\uDCFC\uDD00-\uDEB3\uDEBA-\uDED0\uDEE0-\uDEF0\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD838[\uDD4F\uDEFF]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED8\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDCD0-\uDCD8\uDD00-\uDE57\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF\uDFFA])/).replace(/punct/g,eh).getRegex(),ah=Tf("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Yf).replace(/punctSpace/g,Xf).replace(/punct/g,Qf).getRegex(),ch=Tf(/\\(punct)/,"gu").replace(/punct/g,Qf).getRegex(),lh=Tf(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),dh=Tf(_f).replace("(?:--\x3e|$)","--\x3e").getRegex(),fh=Tf("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",dh).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),hh=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ph=Tf(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",hh).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),mh=Tf(/^!?\[(label)\]\[(ref)\]/).replace("label",hh).replace("ref",$f).getRegex(),Dh=Tf(/^!?\[(ref)\](?:\[\])?/).replace("ref",$f).getRegex(),vh={_backpedal:Mf,anyPunctuation:ch,autolink:lh,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:Zf,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Mf,emStrongLDelim:rh,emStrongRDelimAst:uh,emStrongRDelimUnd:ah,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:ph,nolink:Dh,punctuation:th,reflink:mh,reflinkSearch:Tf("reflink|nolink(?!\\()","g").replace("reflink",mh).replace("nolink",Dh).getRegex(),tag:fh,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Mf},gh=h({},vh,{link:Tf(/^!?\[(label)\]\((.*?)\)/).replace("label",hh).getRegex(),reflink:Tf(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",hh).getRegex()}),Fh=h({},vh,{emStrongRDelimAst:sh,emStrongLDelim:oh,url:Tf(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),yh=h({},Fh,{br:Tf(Zf).replace("{2,}","*").getRegex(),text:Tf(Fh.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),Ch={normal:Kf,gfm:Jf,pedantic:Gf},kh={normal:vh,gfm:Fh,breaks:yh,pedantic:gh},Eh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ah=function(t){return Eh[t]};function bh(t,e){if(e){if(Of.escapeTest.test(t))return t.replace(Of.escapeReplace,Ah)}else if(Of.escapeTestNoEncode.test(t))return t.replace(Of.escapeReplaceNoEncode,Ah);return t}function wh(t){try{t=encodeURI(t).replace(Of.percentDecode,"%")}catch(t){return null}return t}function xh(t,e){var n,r=t.replace(Of.findPipe,function(t,e,n){for(var r=!1,o=e;--o>=0&&"\\"===n[o];)r=!r;return r?"|":" |"}).split(Of.splitPipe),o=0;if(r[0].trim()||r.shift(),r.length>0&&(null==(n=r.at(-1))||!n.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;o<r.length;o++)r[o]=r[o].trim().replace(Of.slashPipe,"|");return r}function Bh(t,e,n){var r=t.length;if(0===r)return"";for(var o=0;o<r;){var i=t.charAt(r-o-1);if(i!==e||n){if(i===e||!n)break;o++}else o++}return t.slice(0,r-o)}function Sh(t,e,n,r,o){var i=e.href,u=e.title||null,s=t[1].replace(o.other.outputLinkReplace,"$1");r.state.inLink=!0;var a={type:"!"===t[0].charAt(0)?"image":"link",raw:n,href:i,title:u,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,a}var Mh=function(){function t(t){this.options=void 0,this.rules=void 0,this.lexer=void 0,this.options=t||Bf}var e=t.prototype;return e.space=function(t){var e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}},e.code=function(t){var e=this.rules.block.code.exec(t);if(e){var n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Bh(n,"\n")}}},e.fences=function(t){var e=this.rules.block.fences.exec(t);if(e){var n=e[0],r=function(t,e,n){var r=t.match(n.other.indentCodeCompensation);if(null===r)return e;var o=r[1];return e.split("\n").map(function(t){var e=t.match(n.other.beginningSpace);return null===e?t:e[0].length>=o.length?t.slice(o.length):t}).join("\n")}(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}},e.heading=function(t){var e=this.rules.block.heading.exec(t);if(e){var n=e[2].trim();if(this.rules.other.endingHash.test(n)){var r=Bh(n,"#");this.options.pedantic?n=r.trim():r&&!this.rules.other.endingSpaceChar.test(r)||(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}},e.hr=function(t){var e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Bh(e[0],"\n")}},e.blockquote=function(t){var e=this.rules.block.blockquote.exec(t);if(e){for(var n=Bh(e[0],"\n").split("\n"),r="",o="",i=[];n.length>0;){var u=!1,s=[],a=void 0;for(a=0;a<n.length;a++)if(this.rules.other.blockquoteStart.test(n[a]))s.push(n[a]),u=!0;else{if(u)break;s.push(n[a])}n=n.slice(a);var c=s.join("\n"),l=c.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");r=r?r+"\n"+c:c,o=o?o+"\n"+l:l;var d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,i,!0),this.lexer.state.top=d,0===n.length)break;var f=i.at(-1);if("code"===(null==f?void 0:f.type))break;if("blockquote"===(null==f?void 0:f.type)){var h=f,p=h.raw+"\n"+n.join("\n"),m=this.blockquote(p);i[i.length-1]=m,r=r.substring(0,r.length-h.raw.length)+m.raw,o=o.substring(0,o.length-h.text.length)+m.text;break}if("list"!==(null==f?void 0:f.type));else{var D=f,v=D.raw+"\n"+n.join("\n"),g=this.list(v);i[i.length-1]=g,r=r.substring(0,r.length-f.raw.length)+g.raw,o=o.substring(0,o.length-D.raw.length)+g.raw,n=v.substring(i.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:r,tokens:i,text:o}}},e.list=function(t){var e=this,n=this.rules.block.list.exec(t);if(n){var r=n[1].trim(),o=r.length>1,i={type:"list",raw:"",ordered:o,start:o?+r.slice(0,-1):"",loose:!1,items:[]};r=o?"\\d{1,9}\\"+r.slice(-1):"\\"+r,this.options.pedantic&&(r=o?r:"[*+-]");for(var u=this.rules.other.listItemRegex(r),s=!1;t;){var a=!1,c="",l="";if(!(n=u.exec(t)))break;if(this.rules.block.hr.test(t))break;c=n[0],t=t.substring(c.length);var d=n[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,function(t){return" ".repeat(3*t.length)}),f=t.split("\n",1)[0],h=!d.trim(),p=0;if(this.options.pedantic?(p=2,l=d.trimStart()):h?p=n[1].length+1:(p=(p=n[2].search(this.rules.other.nonSpaceChar))>4?1:p,l=d.slice(p),p+=n[1].length),h&&this.rules.other.blankLine.test(f)&&(c+=f+"\n",t=t.substring(f.length+1),a=!0),!a)for(var m=this.rules.other.nextBulletRegex(p),D=this.rules.other.hrRegex(p),v=this.rules.other.fencesBeginRegex(p),g=this.rules.other.headingBeginRegex(p),F=this.rules.other.htmlBeginRegex(p);t;){var y=t.split("\n",1)[0],C=void 0;if(f=y,C=this.options.pedantic?f=f.replace(this.rules.other.listReplaceNesting,"  "):f.replace(this.rules.other.tabCharGlobal,"    "),v.test(f))break;if(g.test(f))break;if(F.test(f))break;if(m.test(f))break;if(D.test(f))break;if(C.search(this.rules.other.nonSpaceChar)>=p||!f.trim())l+="\n"+C.slice(p);else{if(h)break;if(d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(v.test(d))break;if(g.test(d))break;if(D.test(d))break;l+="\n"+f}h||f.trim()||(h=!0),c+=y+"\n",t=t.substring(y.length+1),d=C.slice(p)}i.loose||(s?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(s=!0));var k=null,E=void 0;this.options.gfm&&(k=this.rules.other.listIsTask.exec(l))&&(E="[ ] "!==k[0],l=l.replace(this.rules.other.listReplaceTask,"")),i.items.push({type:"list_item",raw:c,task:!!k,checked:E,loose:!1,text:l,tokens:[]}),i.raw+=c}var A=i.items.at(-1);if(!A)return;A.raw=A.raw.trimEnd(),A.text=A.text.trimEnd(),i.raw=i.raw.trimEnd();for(var b=0;b<i.items.length;b++)if(this.lexer.state.top=!1,i.items[b].tokens=this.lexer.blockTokens(i.items[b].text,[]),!i.loose){var w=i.items[b].tokens.filter(function(t){return"space"===t.type}),x=w.length>0&&w.some(function(t){return e.rules.other.anyLine.test(t.raw)});i.loose=x}if(i.loose)for(var B=0;B<i.items.length;B++)i.items[B].loose=!0;return i}},e.html=function(t){var e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:"pre"===e[1]||"script"===e[1]||"style"===e[1],text:e[0]}},e.def=function(t){var e=this.rules.block.def.exec(t);if(e){var n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:o}}},e.table=function(t){var e,n=this,r=this.rules.block.table.exec(t);if(r&&this.rules.other.tableDelimiter.test(r[2])){var o=xh(r[1]),i=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),u=null!=(e=r[3])&&e.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],s={type:"table",raw:r[0],header:[],align:[],rows:[]};if(o.length===i.length){for(var a,c=wf(i);!(a=c()).done;){var l=a.value;this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null)}for(var d=0;d<o.length;d++)s.header.push({text:o[d],tokens:this.lexer.inline(o[d]),header:!0,align:s.align[d]});for(var f,h=wf(u);!(f=h()).done;){var p=f.value;s.rows.push(xh(p,s.header.length).map(function(t,e){return{text:t,tokens:n.lexer.inline(t),header:!1,align:s.align[e]}}))}return s}}},e.lheading=function(t){var e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}},e.paragraph=function(t){var e=this.rules.block.paragraph.exec(t);if(e){var n="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}},e.text=function(t){var e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}},e.escape=function(t){var e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}},e.tag=function(t){var e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}},e.link=function(t){var e=this.rules.inline.link.exec(t);if(e){var n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;var r=Bh(n.slice(0,-1),"\\");if((n.length-r.length)%2==0)return}else{var o=function(t,e){if(-1===t.indexOf(e[1]))return-1;for(var n=0,r=0;r<t.length;r++)if("\\"===t[r])r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&--n<0)return r;return n>0?-2:-1}(e[2],"()");if(-2===o)return;if(o>-1){var i=(0===e[0].indexOf("!")?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,i).trim(),e[3]=""}}var u=e[2],s="";if(this.options.pedantic){var a=this.rules.other.pedanticHrefTitle.exec(u);a&&(u=a[1],s=a[3])}else s=e[3]?e[3].slice(1,-1):"";return u=u.trim(),this.rules.other.startAngleBracket.test(u)&&(u=this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?u.slice(1):u.slice(1,-1)),Sh(e,{href:u?u.replace(this.rules.inline.anyPunctuation,"$1"):u,title:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s},e[0],this.lexer,this.rules)}},e.reflink=function(t,e){var n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){var r=e[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!r){var o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return Sh(n,r,n[0],this.lexer,this.rules)}},e.emStrong=function(t,e,n){void 0===n&&(n="");var r=this.rules.inline.emStrongLDelim.exec(t);if(r&&(!r[3]||!n.match(this.rules.other.unicodeAlphaNumeric))&&(!r[1]&&!r[2]||!n||this.rules.inline.punctuation.exec(n))){var o,i,u=[].concat(r[0]).length-1,s=u,a=0,c="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*t.length+u);null!=(r=c.exec(e));)if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6])if(i=[].concat(o).length,r[3]||r[4])s+=i;else if(!((r[5]||r[6])&&u%3)||(u+i)%3){if(!((s-=i)>0)){i=Math.min(i,i+s+a);var l=[].concat(r[0])[0].length,d=t.slice(0,u+r.index+l+i);if(Math.min(u,i)%2){var f=d.slice(1,-1);return{type:"em",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}var h=d.slice(2,-2);return{type:"strong",raw:d,text:h,tokens:this.lexer.inlineTokens(h)}}}else a+=i}},e.codespan=function(t){var e=this.rules.inline.code.exec(t);if(e){var n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}},e.br=function(t){var e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}},e.del=function(t){var e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}},e.autolink=function(t){var e,n,r=this.rules.inline.autolink.exec(t);if(r)return n="@"===r[2]?"mailto:"+(e=r[1]):e=r[1],{type:"link",raw:r[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}},e.url=function(t){var e;if(e=this.rules.inline.url.exec(t)){var n,r;if("@"===e[2])r="mailto:"+(n=e[0]);else{var o;do{var i,u;o=e[0],e[0]=null!=(i=null==(u=this.rules.inline._backpedal.exec(e[0]))?void 0:u[0])?i:""}while(o!==e[0]);n=e[0],r="www."===e[1]?"http://"+e[0]:e[0]}return{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}},e.inlineText=function(t){var e=this.rules.inline.text.exec(t);if(e){var n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}},t}(),Th=function(){function t(t){this.tokens=void 0,this.options=void 0,this.state=void 0,this.tokenizer=void 0,this.inlineQueue=void 0,this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Bf,this.options.tokenizer=this.options.tokenizer||new Mh,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var e={other:Of,block:Ch.normal,inline:kh.normal};this.options.pedantic?(e.block=Ch.pedantic,e.inline=kh.pedantic):this.options.gfm&&(e.block=Ch.gfm,this.options.breaks?e.inline=kh.breaks:e.inline=kh.gfm),this.tokenizer.rules=e}t.lex=function(e,n){return new t(n).lex(e)},t.lexInline=function(e,n){return new t(n).inlineTokens(e)};var e=t.prototype;return e.lex=function(t){t=t.replace(Of.carriageReturn,"\n"),this.blockTokens(t,this.tokens);for(var e=0;e<this.inlineQueue.length;e++){var n=this.inlineQueue[e];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens},e.blockTokens=function(t,e,n){var r=this;void 0===e&&(e=[]),void 0===n&&(n=!1),this.options.pedantic&&(t=t.replace(Of.tabCharGlobal,"    ").replace(Of.spaceLine,""));for(var o,i=function(){var o,i,u;if(null!=(o=r.options.extensions)&&null!=(o=o.block)&&o.some(function(n){return!!(u=n.call({lexer:r},t,e))&&(t=t.substring(u.raw.length),e.push(u),!0)}))return 0;if(u=r.tokenizer.space(t)){t=t.substring(u.raw.length);var s=e.at(-1);return 1===u.raw.length&&void 0!==s?s.raw+="\n":e.push(u),0}if(u=r.tokenizer.code(t)){t=t.substring(u.raw.length);var a=e.at(-1);return"paragraph"===(null==a?void 0:a.type)||"text"===(null==a?void 0:a.type)?(a.raw+="\n"+u.raw,a.text+="\n"+u.text,r.inlineQueue.at(-1).src=a.text):e.push(u),0}if(u=r.tokenizer.fences(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.heading(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.hr(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.blockquote(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.list(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.html(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.def(t)){t=t.substring(u.raw.length);var c=e.at(-1);return"paragraph"===(null==c?void 0:c.type)||"text"===(null==c?void 0:c.type)?(c.raw+="\n"+u.raw,c.text+="\n"+u.raw,r.inlineQueue.at(-1).src=c.text):r.tokens.links[u.tag]||(r.tokens.links[u.tag]={href:u.href,title:u.title}),0}if(u=r.tokenizer.table(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=r.tokenizer.lheading(t))return t=t.substring(u.raw.length),e.push(u),0;var l=t;if(null!=(i=r.options.extensions)&&i.startBlock){var d,f=1/0,h=t.slice(1);r.options.extensions.startBlock.forEach(function(t){"number"==typeof(d=t.call({lexer:r},h))&&d>=0&&(f=Math.min(f,d))}),f<1/0&&f>=0&&(l=t.substring(0,f+1))}if(r.state.top&&(u=r.tokenizer.paragraph(l))){var p=e.at(-1);return n&&"paragraph"===(null==p?void 0:p.type)?(p.raw+="\n"+u.raw,p.text+="\n"+u.text,r.inlineQueue.pop(),r.inlineQueue.at(-1).src=p.text):e.push(u),n=l.length!==t.length,t=t.substring(u.raw.length),0}if(u=r.tokenizer.text(t)){t=t.substring(u.raw.length);var m=e.at(-1);return"text"===(null==m?void 0:m.type)?(m.raw+="\n"+u.raw,m.text+="\n"+u.text,r.inlineQueue.pop(),r.inlineQueue.at(-1).src=m.text):e.push(u),0}if(t){var D="Infinite loop on byte: "+t.charCodeAt(0);if(r.options.silent)return console.error(D),1;throw new Error(D)}};t&&(0===(o=i())||1!==o););return this.state.top=!0,e},e.inline=function(t,e){return void 0===e&&(e=[]),this.inlineQueue.push({src:t,tokens:e}),e},e.inlineTokens=function(t,e){var n=this;void 0===e&&(e=[]);var r=t,o=null;if(this.tokens.links){var i=Object.keys(this.tokens.links);if(i.length>0)for(;null!=(o=this.tokenizer.rules.inline.reflinkSearch.exec(r));)i.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(o=this.tokenizer.rules.inline.anyPunctuation.exec(r));)r=r.slice(0,o.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(o=this.tokenizer.rules.inline.blockSkip.exec(r));)r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(var u,s=!1,a="",c=function(){var o,i,u;if(s||(a=""),s=!1,null!=(o=n.options.extensions)&&null!=(o=o.inline)&&o.some(function(r){return!!(u=r.call({lexer:n},t,e))&&(t=t.substring(u.raw.length),e.push(u),!0)}))return 0;if(u=n.tokenizer.escape(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.tag(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.link(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.reflink(t,n.tokens.links)){t=t.substring(u.raw.length);var c=e.at(-1);return"text"===u.type&&"text"===(null==c?void 0:c.type)?(c.raw+=u.raw,c.text+=u.text):e.push(u),0}if(u=n.tokenizer.emStrong(t,r,a))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.codespan(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.br(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.del(t))return t=t.substring(u.raw.length),e.push(u),0;if(u=n.tokenizer.autolink(t))return t=t.substring(u.raw.length),e.push(u),0;if(!n.state.inLink&&(u=n.tokenizer.url(t)))return t=t.substring(u.raw.length),e.push(u),0;var l=t;if(null!=(i=n.options.extensions)&&i.startInline){var d,f=1/0,h=t.slice(1);n.options.extensions.startInline.forEach(function(t){"number"==typeof(d=t.call({lexer:n},h))&&d>=0&&(f=Math.min(f,d))}),f<1/0&&f>=0&&(l=t.substring(0,f+1))}if(u=n.tokenizer.inlineText(l)){t=t.substring(u.raw.length),"_"!==u.raw.slice(-1)&&(a=u.raw.slice(-1)),s=!0;var p=e.at(-1);return"text"===(null==p?void 0:p.type)?(p.raw+=u.raw,p.text+=u.text):e.push(u),0}if(t){var m="Infinite loop on byte: "+t.charCodeAt(0);if(n.options.silent)return console.error(m),1;throw new Error(m)}};t&&(0===(u=c())||1!==u););return e},f(t,null,[{key:"rules",get:function(){return{block:Ch,inline:kh}}}])}(),Oh=function(){function t(t){this.options=void 0,this.parser=void 0,this.options=t||Bf}var e=t.prototype;return e.space=function(t){return""},e.code=function(t){var e,n=t.text,r=t.lang,o=t.escaped,i=null==(e=(r||"").match(Of.notSpaceStart))?void 0:e[0],u=n.replace(Of.endingNewline,"")+"\n";return i?'<pre><code class="language-'+bh(i)+'">'+(o?u:bh(u,!0))+"</code></pre>\n":"<pre><code>"+(o?u:bh(u,!0))+"</code></pre>\n"},e.blockquote=function(t){var e=t.tokens;return"<blockquote>\n"+this.parser.parse(e)+"</blockquote>\n"},e.html=function(t){return t.text},e.heading=function(t){var e=t.tokens,n=t.depth;return"<h"+n+">"+this.parser.parseInline(e)+"</h"+n+">\n"},e.hr=function(t){return"<hr>\n"},e.list=function(t){for(var e=t.ordered,n=t.start,r="",o=0;o<t.items.length;o++){var i=t.items[o];r+=this.listitem(i)}var u=e?"ol":"ul";return"<"+u+(e&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+u+">\n"},e.listitem=function(t){var e="";if(t.task){var n,r=this.checkbox({checked:!!t.checked});t.loose?"paragraph"===(null==(n=t.tokens[0])?void 0:n.type)?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&"text"===t.tokens[0].tokens[0].type&&(t.tokens[0].tokens[0].text=r+" "+bh(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return"<li>"+(e+=this.parser.parse(t.tokens,!!t.loose))+"</li>\n"},e.checkbox=function(t){return"<input "+(t.checked?'checked="" ':"")+'disabled="" type="checkbox">'},e.paragraph=function(t){var e=t.tokens;return"<p>"+this.parser.parseInline(e)+"</p>\n"},e.table=function(t){for(var e="",n="",r=0;r<t.header.length;r++)n+=this.tablecell(t.header[r]);e+=this.tablerow({text:n});for(var o="",i=0;i<t.rows.length;i++){var u=t.rows[i];n="";for(var s=0;s<u.length;s++)n+=this.tablecell(u[s]);o+=this.tablerow({text:n})}return o&&(o="<tbody>"+o+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+o+"</table>\n"},e.tablerow=function(t){return"<tr>\n"+t.text+"</tr>\n"},e.tablecell=function(t){var e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},e.strong=function(t){var e=t.tokens;return"<strong>"+this.parser.parseInline(e)+"</strong>"},e.em=function(t){var e=t.tokens;return"<em>"+this.parser.parseInline(e)+"</em>"},e.codespan=function(t){return"<code>"+bh(t.text,!0)+"</code>"},e.br=function(t){return"<br>"},e.del=function(t){var e=t.tokens;return"<del>"+this.parser.parseInline(e)+"</del>"},e.link=function(t){var e=t.href,n=t.title,r=t.tokens,o=this.parser.parseInline(r),i=wh(e);if(null===i)return o;var u='<a href="'+(e=i)+'"';return n&&(u+=' title="'+bh(n)+'"'),u+">"+o+"</a>"},e.image=function(t){var e=t.href,n=t.title,r=t.text,o=t.tokens;o&&(r=this.parser.parseInline(o,this.parser.textRenderer));var i=wh(e);if(null===i)return bh(r);var u='<img src="'+(e=i)+'" alt="'+r+'"';return n&&(u+=' title="'+bh(n)+'"'),u+">"},e.text=function(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:bh(t.text)},t}(),Nh=function(){function t(){}var e=t.prototype;return e.strong=function(t){return t.text},e.em=function(t){return t.text},e.codespan=function(t){return t.text},e.del=function(t){return t.text},e.html=function(t){return t.text},e.text=function(t){return t.text},e.link=function(t){return""+t.text},e.image=function(t){return""+t.text},e.br=function(){return""},t}(),Rh=function(){function t(t){this.options=void 0,this.renderer=void 0,this.textRenderer=void 0,this.options=t||Bf,this.options.renderer=this.options.renderer||new Oh,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Nh}t.parse=function(e,n){return new t(n).parse(e)},t.parseInline=function(e,n){return new t(n).parseInline(e)};var e=t.prototype;return e.parse=function(t,e){void 0===e&&(e=!0);for(var n="",r=0;r<t.length;r++){var o,i=t[r];if(null!=(o=this.options.extensions)&&null!=(o=o.renderers)&&o[i.type]){var u=i,s=this.options.extensions.renderers[u.type].call({parser:this},u);if(!1!==s||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)){n+=s||"";continue}}var a=i;switch(a.type){case"space":n+=this.renderer.space(a);continue;case"hr":n+=this.renderer.hr(a);continue;case"heading":n+=this.renderer.heading(a);continue;case"code":n+=this.renderer.code(a);continue;case"table":n+=this.renderer.table(a);continue;case"blockquote":n+=this.renderer.blockquote(a);continue;case"list":n+=this.renderer.list(a);continue;case"html":n+=this.renderer.html(a);continue;case"paragraph":n+=this.renderer.paragraph(a);continue;case"text":for(var c=a,l=this.renderer.text(c);r+1<t.length&&"text"===t[r+1].type;)c=t[++r],l+="\n"+this.renderer.text(c);n+=e?this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):l;continue;default:var d='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}return n},e.parseInline=function(t,e){void 0===e&&(e=this.renderer);for(var n="",r=0;r<t.length;r++){var o,i=t[r];if(null!=(o=this.options.extensions)&&null!=(o=o.renderers)&&o[i.type]){var u=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==u||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=u||"";continue}}var s=i;switch(s.type){case"escape":case"text":n+=e.text(s);break;case"html":n+=e.html(s);break;case"link":n+=e.link(s);break;case"image":n+=e.image(s);break;case"strong":n+=e.strong(s);break;case"em":n+=e.em(s);break;case"codespan":n+=e.codespan(s);break;case"br":n+=e.br(s);break;case"del":n+=e.del(s);break;default:var a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}return n},t}(),Ih=(kf=function(){function t(t){this.options=void 0,this.block=void 0,this.options=t||Bf}var e=t.prototype;return e.preprocess=function(t){return t},e.postprocess=function(t){return t},e.processAllTokens=function(t){return t},e.provideLexer=function(){return this.block?Th.lex:Th.lexInline},e.provideParser=function(){return this.block?Rh.parse:Rh.parseInline},t}(),kf.passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]),kf),Lh=function(){function t(){this.defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null},this.options=this.setOptions,this.parse=this.parseMarkdown(!0),this.parseInline=this.parseMarkdown(!1),this.Parser=Rh,this.Renderer=Oh,this.TextRenderer=Nh,this.Lexer=Th,this.Tokenizer=Mh,this.Hooks=Ih,this.use.apply(this,arguments)}var e=t.prototype;return e.walkTokens=function(t,e){for(var n,r=this,o=[],i=function(){var t=n.value;switch(o=o.concat(e.call(r,t)),t.type){case"table":for(var i,u=t,s=wf(u.header);!(i=s()).done;){var a=i.value;o=o.concat(r.walkTokens(a.tokens,e))}for(var c,l=wf(u.rows);!(c=l()).done;)for(var d,f=wf(c.value);!(d=f()).done;){var h=d.value;o=o.concat(r.walkTokens(h.tokens,e))}break;case"list":var p=t;o=o.concat(r.walkTokens(p.items,e));break;default:var m,D=t;null!=(m=r.defaults.extensions)&&null!=(m=m.childTokens)&&m[D.type]?r.defaults.extensions.childTokens[D.type].forEach(function(t){var n=D[t].flat(1/0);o=o.concat(r.walkTokens(n,e))}):D.tokens&&(o=o.concat(r.walkTokens(D.tokens,e)))}},u=wf(t);!(n=u()).done;)i();return o},e.use=function(){for(var t=this,e=this.defaults.extensions||{renderers:{},childTokens:{}},n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.forEach(function(n){var r=h({},n);if(r.async=t.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(function(t){if(!t.name)throw new Error("extension name required");if("renderer"in t){var n=e.renderers[t.name];e.renderers[t.name]=n?function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var i=t.renderer.apply(this,r);return!1===i&&(i=n.apply(this,r)),i}:t.renderer}if("tokenizer"in t){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");var r=e[t.level];r?r.unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}"childTokens"in t&&t.childTokens&&(e.childTokens[t.name]=t.childTokens)}),r.extensions=e),n.renderer){var o=t.defaults.renderer||new Oh(t.defaults),i=function(){if(!(u in o))throw new Error("renderer '"+u+"' does not exist");if(["options","parser"].includes(u))return 1;var t=u,e=n.renderer[t],r=o[t];o[t]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var u=e.apply(o,n);return!1===u&&(u=r.apply(o,n)),u||""}};for(var u in n.renderer)i();r.renderer=o}if(n.tokenizer){var s=t.defaults.tokenizer||new Mh(t.defaults),a=function(){if(!(c in s))throw new Error("tokenizer '"+c+"' does not exist");if(["options","rules","lexer"].includes(c))return 1;var t=c,e=n.tokenizer[t],r=s[t];s[t]=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=e.apply(s,n);return!1===i&&(i=r.apply(s,n)),i}};for(var c in n.tokenizer)a();r.tokenizer=s}if(n.hooks){var l=t.defaults.hooks||new Ih,d=function(){if(!(f in l))throw new Error("hook '"+f+"' does not exist");if(["options","block"].includes(f))return 1;var e=f,r=n.hooks[e],o=l[e];Ih.passThroughHooks.has(f)?l[e]=function(e){if(t.defaults.async)return Promise.resolve(r.call(l,e)).then(function(t){return o.call(l,t)});var n=r.call(l,e);return o.call(l,n)}:l[e]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=r.apply(l,e);return!1===i&&(i=o.apply(l,e)),i}};for(var f in n.hooks)d();r.hooks=l}if(n.walkTokens){var p=t.defaults.walkTokens,m=n.walkTokens;r.walkTokens=function(t){var e=[];return e.push(m.call(this,t)),p&&(e=e.concat(p.call(this,t))),e}}t.defaults=h({},t.defaults,r)}),this},e.setOptions=function(t){return this.defaults=h({},this.defaults,t),this},e.lexer=function(t,e){return Th.lex(t,null!=e?e:this.defaults)},e.parser=function(t,e){return Rh.parse(t,null!=e?e:this.defaults)},e.parseMarkdown=function(t){var e=this;return function(n,r){var o=h({},r),i=h({},e.defaults,o),u=e.onError(!!i.silent,!!i.async);if(!0===e.defaults.async&&!1===o.async)return u(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==n)return u(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof n)return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=t);var s=i.hooks?i.hooks.provideLexer():t?Th.lex:Th.lexInline,a=i.hooks?i.hooks.provideParser():t?Rh.parse:Rh.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(function(t){return s(t,i)}).then(function(t){return i.hooks?i.hooks.processAllTokens(t):t}).then(function(t){return i.walkTokens?Promise.all(e.walkTokens(t,i.walkTokens)).then(function(){return t}):t}).then(function(t){return a(t,i)}).then(function(t){return i.hooks?i.hooks.postprocess(t):t}).catch(u);try{i.hooks&&(n=i.hooks.preprocess(n));var c=s(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&e.walkTokens(c,i.walkTokens);var l=a(c,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(t){return u(t)}}},e.onError=function(t,e){return function(n){if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",t){var r="<p>An error occurred:</p><pre>"+bh(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}},t}(),Ph=new Lh;function zh(t,e){return Ph.parse(t,e)}function $h(t,e){var n=e.split("\n").flatMap(function(t){return[t,""]}).map(function(e){return""+t+e}).join("\n");return n.slice(0,n.length-1)}function jh(t){var e=(t.raw||t.text||"").match(/^(\s*)[-+*]\s+\[([ xX])\]\s+/);return e?{isTask:!0,checked:"x"===e[2].toLowerCase(),indentLevel:e[1].length}:{isTask:!1,indentLevel:0}}function Hh(t,e){return"string"!=typeof t?"json":e}zh.options=zh.setOptions=function(t){return Ph.setOptions(t),zh.defaults=Ph.defaults,Sf(zh.defaults),zh},zh.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},zh.defaults=Bf,zh.use=function(){return Ph.use.apply(Ph,arguments),zh.defaults=Ph.defaults,Sf(zh.defaults),zh},zh.walkTokens=function(t,e){return Ph.walkTokens(t,e)},zh.parseInline=Ph.parseInline,zh.Parser=Rh,zh.parser=Rh.parse,zh.Renderer=Oh,zh.TextRenderer=Nh,zh.Lexer=Th,zh.lexer=Th.lex,zh.Tokenizer=Mh,zh.Hooks=Ih,zh.parse=zh,zh.options,zh.setOptions,zh.use,zh.walkTokens,zh.parseInline,Rh.parse,Th.lex;var Vh=function(){function t(t){var e,n,r,o,i,u=this;this.baseExtensions=[],this.extensions=[],this.lastParseResult=null,this.markedInstance=null!=(e=null==t?void 0:t.marked)?e:zh,this.lexer=new this.markedInstance.Lexer,this.indentStyle=null!=(r=null==(n=null==t?void 0:t.indentation)?void 0:n.style)?r:"space",this.indentSize=null!=(i=null==(o=null==t?void 0:t.indentation)?void 0:o.size)?i:2,this.baseExtensions=(null==t?void 0:t.extensions)||[],(null==t?void 0:t.markedOptions)&&"function"==typeof this.markedInstance.setOptions&&this.markedInstance.setOptions(t.markedOptions),this.registry=new Map,this.nodeTypeRegistry=new Map,(null==t?void 0:t.extensions)&&(this.baseExtensions=t.extensions,us(t.extensions).forEach(function(t){return u.registerExtension(t,!1)})),this.lexer=new this.markedInstance.Lexer}var e=t.prototype;return e.hasMarked=function(){return!!this.markedInstance},e.registerExtension=function(t,e){var n,r;void 0===e&&(e=!0),this.extensions.push(t);var o=t.name,i=is(t,"markdownTokenName")||o,u=is(t,"parseMarkdown"),s=is(t,"renderMarkdown"),a=is(t,"markdownTokenizer"),c=null!=(n=is(t,"markdownOptions"))?n:null,l={tokenName:i,nodeName:o,parseMarkdown:u,renderMarkdown:s,isIndenting:null!=(r=null==c?void 0:c.indentsContent)&&r,tokenizer:a};if(i&&u){var d=this.registry.get(i)||[];d.push(l),this.registry.set(i,d)}if(s){var f=this.nodeTypeRegistry.get(o)||[];f.push(l),this.nodeTypeRegistry.set(o,f)}a&&this.hasMarked()&&(this.registerTokenizer(a),e&&(this.lexer=new this.markedInstance.Lexer))},e.registerTokenizer=function(t){var e=this;if(this.hasMarked()){var n=t.name,r=t.start,o=t.level,i=void 0===o?"inline":o,u=t.tokenize,s={inlineTokens:function(t){return e.lexer.inlineTokens(t)},blockTokens:function(t){return e.lexer.blockTokens(t)}},a={name:n,level:i,start:r?"function"==typeof r?r:function(t){return t.indexOf(r)}:function(t){var e=u(t,[],s);return e&&e.raw?t.indexOf(e.raw):-1},tokenizer:function(t,e){var r=u(t,e,s);if(r&&r.type)return h({},r,{type:r.type||n,raw:r.raw||"",tokens:r.tokens||[]})},childTokens:[]};this.markedInstance.use({extensions:[a]})}},e.getHandlersForToken=function(t){try{return this.registry.get(t)||[]}catch(t){return[]}},e.getHandlerForToken=function(t){var e=this.getHandlersForToken(t);if(e.length>0)return e[0];var n=this.getHandlersForNodeType(t);return n.length>0?n[0]:void 0},e.getHandlersForNodeType=function(t){try{return this.nodeTypeRegistry.get(t)||[]}catch(t){return[]}},e.serialize=function(t){return t?(Array.isArray(t),this.renderNodes(t,t)):""},e.parse=function(t){if(!this.hasMarked())throw new Error("No marked instance available for parsing");var e=this.markedInstance.lexer(t);return{type:"doc",content:this.parseTokens(e)}},e.parseTokens=function(t){var e=this;return t.map(function(t){return e.parseToken(t)}).filter(function(t){return null!==t}).flatMap(function(t){return Array.isArray(t)?t:[t]})},e.parseToken=function(t){var e=this;if(!t.type)return null;if("list"===t.type)return this.parseListToken(t);var n=this.getHandlersForToken(t.type),r=this.createParseHelpers();if(n.find(function(n){if(!n.parseMarkdown)return!1;var o=n.parseMarkdown(t,r),i=e.normalizeParseResult(o);return!(!i||Array.isArray(i)&&!(i.length>0)||(e.lastParseResult=i,0))})&&this.lastParseResult){var o=this.lastParseResult;return this.lastParseResult=null,o}return this.parseFallbackToken(t)},e.parseListToken=function(t){var e=this;if(!t.items||0===t.items.length)return this.parseTokenWithHandlers(t);var n=t.items.some(function(t){return jh(t).isTask}),r=t.items.some(function(t){return!jh(t).isTask});if(!n||!r||0===this.getHandlersForToken("taskList").length)return this.parseTokenWithHandlers(t);for(var o=[],i=[],u=null,s=function(){var n=t.items[a],r=jh(n),s=r.isTask,c=r.checked,l=r.indentLevel,d=n;if(s){var f=(n.raw||n.text||"").split("\n"),h=f[0].match(/^\s*[-+*]\s+\[([ xX])\]\s+(.*)$/),p=h?h[2]:"",m=[];if(f.length>1&&f.slice(1).join("\n").trim()){var D=f.slice(1),v=D.filter(function(t){return t.trim()});if(v.length>0){var g=Math.min.apply(Math,v.map(function(t){return t.length-t.trimStart().length})),F=D.map(function(t){return t.trim()?t.slice(g):""}).join("\n").trim();F&&(m=e.markedInstance.lexer(F+"\n"))}}d={type:"taskItem",raw:"",mainContent:p,indentLevel:l,checked:null!=c&&c,text:p,tokens:e.lexer.inlineTokens(p),nestedTokens:m}}var y=s?"taskList":"list";u!==y?(i.length>0&&o.push({type:u,items:i}),i=[d],u=y):i.push(d)},a=0;a<t.items.length;a+=1)s();i.length>0&&o.push({type:u,items:i});for(var c=[],l=0;l<o.length;l+=1){var d=o[l],f=h({},t,{type:d.type,items:d.items}),p=this.parseToken(f);p&&(Array.isArray(p)?c.push.apply(c,p):c.push(p))}return c.length>0?c:null},e.parseTokenWithHandlers=function(t){var e=this;if(!t.type)return null;var n=this.getHandlersForToken(t.type),r=this.createParseHelpers();if(n.find(function(n){if(!n.parseMarkdown)return!1;var o=n.parseMarkdown(t,r),i=e.normalizeParseResult(o);return!(!i||Array.isArray(i)&&!(i.length>0)||(e.lastParseResult=i,0))})&&this.lastParseResult){var o=this.lastParseResult;return this.lastParseResult=null,o}return this.parseFallbackToken(t)},e.createParseHelpers=function(){var t=this;return{parseInline:function(e){return t.parseInlineTokens(e)},parseChildren:function(e){return t.parseTokens(e)},createTextNode:function(t,e){return{type:"text",text:t,marks:e||void 0}},createNode:function(t,e,n){var r={type:t,attrs:e||void 0,content:n||void 0};return e&&0!==Object.keys(e).length||delete r.attrs,r},applyMark:function(t,e,n){return{mark:t,content:e,attrs:n&&Object.keys(n).length>0?n:void 0}}}},e.escapeRegex=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},e.parseInlineTokens=function(t){for(var e,n,r,o,i=[],u=0;u<t.length;u+=1){var s=t[u];if("text"===s.type)i.push({type:"text",text:s.text||""});else if("html"===s.type){var a=(null!=(n=null!=(e=s.raw)?e:s.text)?n:"").toString(),c=/^<\/[\s]*[\w-]+/i.test(a),l=a.match(/^<[\s]*([\w-]+)(\s|>|\/|$)/i);if(!c&&l&&!/\/>$/.test(a)){for(var d=l[1],f=this.escapeRegex(d),h=new RegExp("^<\\/\\s*"+f+"\\b","i"),p=-1,m=[a],D=u+1;D<t.length;D+=1){var v=t[D],g=(null!=(o=null!=(r=v.raw)?r:v.text)?o:"").toString();if(m.push(g),"html"===v.type&&h.test(g)){p=D;break}}if(-1!==p){var F=m.join(""),y={type:"html",raw:F,text:F,block:!1},C=this.parseHTMLToken(y);if(C){var k=this.normalizeParseResult(C);Array.isArray(k)?i.push.apply(i,k):k&&i.push(k)}u=p;continue}}var E=this.parseHTMLToken(s);if(E){var A=this.normalizeParseResult(E);Array.isArray(A)?i.push.apply(i,A):A&&i.push(A)}}else if(s.type){var b=this.getHandlerForToken(s.type);if(b&&b.parseMarkdown){var w=this.createParseHelpers(),x=b.parseMarkdown(s,w);if(this.isMarkResult(x)){var B=this.applyMarkToContent(x.mark,x.content,x.attrs);i.push.apply(i,B)}else{var S=this.normalizeParseResult(x);Array.isArray(S)?i.push.apply(i,S):S&&i.push(S)}}else s.tokens&&i.push.apply(i,this.parseInlineTokens(s.tokens))}}return i},e.applyMarkToContent=function(t,e,n){var r=this;return e.map(function(e){if("text"===e.type){var o=e.marks||[];return h({},e,{marks:[].concat(o,[n?{type:t,attrs:n}:{type:t}])})}return h({},e,{content:e.content?r.applyMarkToContent(t,e.content,n):void 0})})},e.isMarkResult=function(t){return t&&"object"==typeof t&&"mark"in t},e.normalizeParseResult=function(t){return t?this.isMarkResult(t)?t.content:t:null},e.parseFallbackToken=function(t){switch(t.type){case"paragraph":return{type:"paragraph",content:t.tokens?this.parseInlineTokens(t.tokens):[]};case"heading":return{type:"heading",attrs:{level:t.depth||1},content:t.tokens?this.parseInlineTokens(t.tokens):[]};case"text":return{type:"text",text:t.text||""};case"html":return this.parseHTMLToken(t);case"space":return null;default:return t.tokens?this.parseTokens(t.tokens):null}},e.parseHTMLToken=function(t){var e=t.text||t.raw||"";if(!e.trim())return null;try{var n=function(t,e){var n=function(t,e){return vs(Fs(t),e)}(e),r=bu(t);return mt.fromSchema(n).parse(r).toJSON()}(e,this.baseExtensions);return"doc"===n.type&&n.content?t.block?n.content:1===n.content.length&&"paragraph"===n.content[0].type&&n.content[0].content?n.content[0].content:n.content:n}catch(t){throw new Error("Failed to parse HTML in markdown: "+t)}},e.renderNodeToMarkdown=function(t,e,n,r){var o,i=this;if(void 0===n&&(n=0),void 0===r&&(r=0),"text"===t.type)return t.text||"";if(!t.type)return"";var u=this.getHandlerForToken(t.type);if(!u)return"";var s={renderChildren:function(e,o){var s=u.isIndenting?r+1:r;return!Array.isArray(e)&&e.content?i.renderNodes(e.content,t,o||"",n,s):i.renderNodes(e,t,o||"",n,s)},indent:function(t){return i.indentString+t},wrapInBlock:$h},a={index:n,level:r,parentType:null==e?void 0:e.type,meta:{}};return(null==(o=u.renderMarkdown)?void 0:o.call(u,t,s,a))||""},e.renderNodes=function(t,e,n,r,o){return void 0===n&&(n=""),void 0===r&&(r=0),void 0===o&&(o=0),Array.isArray(t)?this.renderNodesWithMarkBoundaries(t,e,n,o):t.type?this.renderNodeToMarkdown(t,e,r,o):""},e.renderNodesWithMarkBoundaries=function(t,e,n,r){var o=this;void 0===n&&(n=""),void 0===r&&(r=0);var i=[],u=new Map;return t.forEach(function(n,s){var a=s<t.length-1?t[s+1]:null;if(n.type)if("text"===n.type){var c=n.text||"",l=new Map((n.marks||[]).map(function(t){return[t.type,t]})),d=function(t,e){var n=[];return Array.from(t.keys()).forEach(function(t){e.has(t)||n.push(t)}),n}(u,l),f=function(t,e){var n=[];return Array.from(e.entries()).forEach(function(e){var r=e[0],o=e[1];t.has(r)||n.push({type:r,mark:o})}),n}(u,l);d.forEach(function(t){var e=u.get(t),n=o.getMarkClosing(t,e);n&&(c+=n),u.delete(t)});var h="";if(f.length>0){var p=c.match(/^(\s+)/);p&&(h=p[1],c=c.slice(h.length))}f.forEach(function(t){var e=t.type,n=t.mark,r=o.getMarkOpening(e,n);r&&(c=r+c),u.set(e,n)}),c=h+c;var m=function(t,e,n,r){var o=!n,i=n&&"text"===n.type&&(!n.marks||0===n.marks.length),u=n&&"text"===n.type&&n.marks&&!r(e,new Map(n.marks.map(function(t){return[t.type,t]}))),s=[];if(o||i||u)if(n&&"text"===n.type&&n.marks){var a=new Map(n.marks.map(function(t){return[t.type,t]}));Array.from(t.keys()).forEach(function(t){a.has(t)||s.push(t)})}else(o||i)&&s.push.apply(s,Array.from(t.keys()));return s}(u,l,a,o.markSetsEqual.bind(o)),D="";if(m.length>0){var v=c.match(/(\s+)$/);v&&(D=v[1],c=c.slice(0,-D.length))}m.forEach(function(t){var e=u.get(t),n=o.getMarkClosing(t,e);n&&(c+=n),u.delete(t)}),c+=D,i.push(c)}else{var g=new Map(u),F=function(t,e){var n="";return Array.from(t.keys()).reverse().forEach(function(r){var o=t.get(r),i=e(r,o);i&&(n=i+n)}),t.clear(),n}(u,o.getMarkClosing.bind(o)),y=o.renderNodeToMarkdown(n,e,s,r),C="hardBreak"===n.type?"":function(t,e,n){var r="";return Array.from(t.entries()).forEach(function(t){var o=t[0],i=t[1],u=n(o,i);u&&(r+=u),e.set(o,i)}),r}(g,u,o.getMarkOpening.bind(o));i.push(F+y+C)}}),i.join(n)},e.getMarkOpening=function(t,e){var n=this.getHandlersForNodeType(t),r=n.length>0?n[0]:void 0;if(!r||!r.renderMarkdown)return"";var o="__TIPTAP_MARKDOWN_PLACEHOLDER__",i={type:t,attrs:e.attrs||{},content:[{type:"text",text:o}]};try{var u=r.renderMarkdown(i,{renderChildren:function(){return o},indent:function(t){return t},wrapInBlock:function(t,e){return t+e}},{index:0,level:0,parentType:"text",meta:{}}),s=u.indexOf(o);return s>=0?u.substring(0,s):""}catch(e){throw new Error("Failed to get mark opening for "+t+": "+e)}},e.getMarkClosing=function(t,e){var n=this.getHandlersForNodeType(t),r=n.length>0?n[0]:void 0;if(!r||!r.renderMarkdown)return"";var o="__TIPTAP_MARKDOWN_PLACEHOLDER__",i={type:t,attrs:e.attrs||{},content:[{type:"text",text:o}]};try{var u=r.renderMarkdown(i,{renderChildren:function(){return o},indent:function(t){return t},wrapInBlock:function(t,e){return t+e}},{index:0,level:0,parentType:"text",meta:{}}),s=u.indexOf(o),a=s+33;return s>=0?u.substring(a):""}catch(e){throw new Error("Failed to get mark closing for "+t+": "+e)}},e.markSetsEqual=function(t,e){return t.size===e.size&&Array.from(t.keys()).every(function(t){return e.has(t)})},f(t,[{key:"instance",get:function(){return this.markedInstance}},{key:"indentCharacter",get:function(){return"space"===this.indentStyle?" ":"\t"}},{key:"indentString",get:function(){return this.indentCharacter.repeat(this.indentSize)}}])}(),_h=Vh,qh=ma.create({name:"markdown",addOptions:function(){return{indentation:{style:"space",size:2},marked:void 0,markedOptions:{}}},addCommands:function(){var t=this;return{setContent:function(e,n){if(!(null==n?void 0:n.contentType))return Ji.setContent(e,n);if("markdown"!==Hh(e,null==n?void 0:n.contentType)||!t.editor.markdown)return Ji.setContent(e,n);var r=t.editor.markdown.parse(e);return Ji.setContent(r,n)},insertContent:function(e,n){if(!(null==n?void 0:n.contentType))return Ji.insertContent(e,n);if("markdown"!==Hh(e,null==n?void 0:n.contentType)||!t.editor.markdown)return Ji.insertContent(e,n);var r=t.editor.markdown.parse(e);return Ji.insertContent(r,n)},insertContentAt:function(e,n,r){if(!(null==r?void 0:r.contentType))return Ji.insertContentAt(e,n,r);if("markdown"!==Hh(n,null==r?void 0:r.contentType)||!t.editor.markdown)return Ji.insertContentAt(e,n,r);var o=t.editor.markdown.parse(n);return Ji.insertContentAt(e,o,r)}}},addStorage:function(){return{manager:new _h({indentation:this.options.indentation,marked:this.options.marked,markedOptions:this.options.markedOptions,extensions:[]})}},onBeforeCreate:function(){var t=this;if(this.editor.markdown)console.error("[tiptap][markdown]: There is already a `markdown` property on the editor instance. This might lead to unexpected behavior.");else if(this.storage.manager=new _h({indentation:this.options.indentation,marked:this.options.marked,markedOptions:this.options.markedOptions,extensions:this.editor.extensionManager.baseExtensions}),this.editor.markdown=this.storage.manager,this.editor.getMarkdown=function(){return t.storage.manager.serialize(t.editor.getJSON())},this.editor.options.contentType&&"markdown"===Hh(this.editor.options.content,this.editor.options.contentType)){if(!this.editor.markdown)throw new Error('[tiptap][markdown]: The `contentType` option is set to "markdown", but the Markdown extension is not added to the editor. Please add the Markdown extension to use this feature.');if(void 0===this.editor.options.content||"string"!=typeof this.editor.options.content)throw new Error('[tiptap][markdown]: The `contentType` option is set to "markdown", but the initial content is not a string. Please provide the initial content as a markdown string.');var e=this.editor.markdown.parse(this.editor.options.content);this.editor.options.content=e}}}),Wh=function(){function t(){this.el=void 0,this.editor=null,this.params=null,this.inputListeners=[],this.inputListenerTimeout=null,this.keydownHandler=null}var e=t.prototype;return e.build=function(t,e){var n=this;this.params=e,this.inputListeners=e.inputListeners||[],this.el=document.createElement("div"),this.el.className=["TiptapEditor","FormControl"].concat(e.classNames).join(" "),t.appendChild(this.el),this.editor=new Ba({element:this.el,extensions:[bf.configure({heading:{levels:[1,2,3,4,5,6]},link:{openOnClick:!1}}),yf.configure({placeholder:e.placeholder||""}),qh],content:e.value||"",contentType:"markdown",editable:!e.disabled,onUpdate:function(){return n.handleUpdate()},onSelectionUpdate:function(){return n.triggerInputListeners()},onFocus:function(){return n.el.classList.add("focused")},onBlur:function(){return n.el.classList.remove("focused")},editorProps:{transformPastedHTML:function(t){var e=(new DOMParser).parseFromString(t,"text/html"),n=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;return e.querySelectorAll("img").forEach(function(t){n.test(t.src)&&t.remove()}),e.body.innerHTML}}}),this.keydownHandler=function(t){var e,r;(t.ctrlKey||t.metaKey)&&"Enter"===t.key&&(t.preventDefault(),null==(e=n.params)||e.onsubmit()),"Escape"===t.key&&(t.preventDefault(),null==(r=n.params)||null==r.escape||r.escape())},this.el.addEventListener("keydown",this.keydownHandler)},e.handleUpdate=function(){var t;null==(t=this.params)||t.oninput(this.getValue()),this.triggerInputListeners()},e.triggerInputListeners=function(){var t=this;this.inputListenerTimeout&&clearTimeout(this.inputListenerTimeout),this.inputListenerTimeout=window.setTimeout(function(){t.inputListeners.forEach(function(t){try{t()}catch(t){}})},50)},e.getValue=function(){return this.editor?this.editor.getMarkdown():""},e.setValue=function(t){this.editor&&this.editor.commands.setContent(t,{contentType:"markdown",emitUpdate:!1})},e.getSelectionRange=function(){if(!this.editor)return[0,0];var t=this.editor.state.selection;return[t.from,t.to]},e.moveCursorTo=function(t){this.editor&&this.editor.commands.setTextSelection(t)},e.insertAtCursor=function(t,e){if(void 0===e&&(e=!1),this.editor)if(e){var n=this.editor.state.selection,r=n.from,o=n.to;this.editor.view.dispatch(this.editor.state.tr.insertText(t,r,o))}else this.editor.commands.insertContent(t)},e.insertAt=function(t,e,n){void 0===n&&(n=!1),this.insertBetween(t,t,e,n)},e.insertBetween=function(t,e,n,r){void 0===r&&(r=!1),this.editor&&(r?this.editor.view.dispatch(this.editor.state.tr.insertText(n,t,e)):this.editor.chain().focus().insertContentAt({from:t,to:e},n).run())},e.replaceBeforeCursor=function(t,e,n){void 0===n&&(n=!1);var r=this.getSelectionRange()[0];this.insertBetween(t,r,e,n)},e.getLastNChars=function(t){if(!this.editor)return"";var e=this.editor.state.selection.$from.nodeBefore;return e&&e.text?e.text.slice(Math.max(0,e.text.length-t)):""},e.getCaretCoordinates=function(t){var e;if(null==(e=this.editor)||!e.view)return{top:0,left:0};var n=null!=t?t:this.editor.state.selection.from,r=this.editor.view.coordsAtPos(n),o=this.el.getBoundingClientRect();return{top:r.top-o.top+this.el.scrollTop,left:r.left-o.left+this.el.scrollLeft}},e.focus=function(){var t;null==(t=this.editor)||t.commands.focus()},e.destroy=function(){var t,e;this.inputListenerTimeout&&clearTimeout(this.inputListenerTimeout),this.keydownHandler&&(this.el.removeEventListener("keydown",this.keydownHandler),this.keydownHandler=null),null==(t=this.editor)||t.destroy(),this.editor=null,null==(e=this.el)||null==(e=e.parentNode)||e.removeChild(this.el)},e.disabled=function(t){var e;null==(e=this.editor)||e.setEditable(!t),this.el.classList.toggle("disabled",t)},e.toggleBold=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBold().run()},e.toggleItalic=function(){var t;null==(t=this.editor)||t.chain().focus().toggleItalic().run()},e.toggleUnderline=function(){var t;null==(t=this.editor)||t.chain().focus().toggleUnderline().run()},e.toggleStrike=function(){var t;null==(t=this.editor)||t.chain().focus().toggleStrike().run()},e.toggleCode=function(){var t;null==(t=this.editor)||t.chain().focus().toggleCode().run()},e.toggleCodeBlock=function(){var t;null==(t=this.editor)||t.chain().focus().toggleCodeBlock().run()},e.toggleBlockquote=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBlockquote().run()},e.toggleBulletList=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBulletList().run()},e.toggleOrderedList=function(){var t;null==(t=this.editor)||t.chain().focus().toggleOrderedList().run()},e.setHeading=function(t){var e;null==(e=this.editor)||e.chain().focus().toggleHeading({level:t}).run()},e.setLink=function(t){var e,n;t?null==(e=this.editor)||e.chain().focus().setLink({href:t}).run():null==(n=this.editor)||n.chain().focus().unsetLink().run()},e.insertHorizontalRule=function(){var t;null==(t=this.editor)||t.chain().focus().setHorizontalRule().run()},e.undo=function(){var t;null==(t=this.editor)||t.chain().focus().undo().run()},e.redo=function(){var t;null==(t=this.editor)||t.chain().focus().redo().run()},e.isActive=function(t,e){var n,r;return null!=(n=null==(r=this.editor)?void 0:r.isActive(t,e))&&n},e.canUndo=function(){var t,e;return null!=(t=null==(e=this.editor)?void 0:e.can().undo())&&t},e.canRedo=function(){var t,e;return null!=(t=null==(e=this.editor)?void 0:e.can().redo())&&t},t}();const Kh=flarum.core.compat["common/Component"];var Uh=t.n(Kh);const Jh=flarum.core.compat["common/components/Button"];var Gh=t.n(Jh);const Zh=flarum.core.compat["common/components/Dropdown"];var Qh=t.n(Zh);const Xh=flarum.core.compat["common/components/Tooltip"];var Yh=t.n(Xh);const tp=flarum.core.compat["common/utils/ItemList"];var ep=t.n(tp),np=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.view=function(){var t=this.state;return null!=t&&t.editor?m("div",{className:"TiptapMenu"},this.items().toArray()):null},n.items=function(){var t=new(ep()),e=this.state,n=this.attrs.disabled||!1;return e?(t.add("text_type",this.textTypeDropdown(e,n),100),t.add("bold",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.bold")},m(Gh(),{className:"Button Button--icon "+(e.isActive("bold")?"active":""),icon:"fas fa-bold",onclick:function(){return e.toggleBold()},disabled:n})),90),t.add("italic",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.italic")},m(Gh(),{className:"Button Button--icon "+(e.isActive("italic")?"active":""),icon:"fas fa-italic",onclick:function(){return e.toggleItalic()},disabled:n})),80),t.add("quote",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.quote")},m(Gh(),{className:"Button Button--icon "+(e.isActive("blockquote")?"active":""),icon:"fas fa-quote-left",onclick:function(){return e.toggleBlockquote()},disabled:n})),70),t.add("link",this.linkDropdown(e,n),60),t.add("unordered_list",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.bullet_list")},m(Gh(),{className:"Button Button--icon "+(e.isActive("bulletList")?"active":""),icon:"fas fa-list-ul",onclick:function(){return e.toggleBulletList()},disabled:n})),50),t.add("additional_items",this.hiddenItemsDropdown(e,n),0),t):t},n.hiddenItems=function(){var t=new(ep()),e=this.state,n=this.attrs.disabled||!1;return e?(t.add("code",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.code")},m(Gh(),{className:"Button Button--icon "+(e.isActive("code")?"active":""),icon:"fas fa-code",onclick:function(){return e.toggleCode()},disabled:n})),100),t.add("ordered_list",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.ordered_list")},m(Gh(),{className:"Button Button--icon "+(e.isActive("orderedList")?"active":""),icon:"fas fa-list-ol",onclick:function(){return e.toggleOrderedList()},disabled:n})),90),t.add("strike",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.strikethrough")},m(Gh(),{className:"Button Button--icon "+(e.isActive("strike")?"active":""),icon:"fas fa-strikethrough",onclick:function(){return e.toggleStrike()},disabled:n})),80),t.add("code_block",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.code_block")},m(Gh(),{className:"Button Button--icon "+(e.isActive("codeBlock")?"active":""),icon:"fas fa-terminal",onclick:function(){return e.toggleCodeBlock()},disabled:n})),70),t.add("horizontal_rule",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.horizontal_rule")},m(Gh(),{className:"Button Button--icon",icon:"fas fa-minus",onclick:function(){return e.insertHorizontalRule()},disabled:n})),60),t.add("undo",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.undo")},m(Gh(),{className:"Button Button--icon",icon:"fas fa-undo",onclick:function(){return e.undo()},disabled:n||!e.canUndo()})),50),t.add("redo",m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.redo")},m(Gh(),{className:"Button Button--icon",icon:"fas fa-redo",onclick:function(){return e.redo()},disabled:n||!e.canRedo()})),40),t):t},n.textTypeDropdown=function(t,e){var n=[{level:1,label:"H1"},{level:2,label:"H2"},{level:3,label:"H3"},{level:4,label:"H4"},{level:5,label:"H5"},{level:6,label:"H6"}],r=n.find(function(e){return t.isActive("heading",{level:e.level})}),o=r?r.label:"P";return m(Qh(),{className:"TiptapMenu-textType",buttonClassName:"Button",label:o,disabled:e},m(Gh(),{className:"NodeTypeButton "+(r?"":"active"),onclick:function(){return t.setParagraph()}},"P"),n.map(function(e){var n=e.level,r=e.label;return m(Gh(),{key:n,className:"NodeTypeButton "+(t.isActive("heading",{level:n})?"active":""),onclick:function(){return t.setHeading(n)}},r)}))},n.linkDropdown=function(t,e){var n=t.isActive("link");return m(Yh(),{text:r().translator.trans("lady-byron-editor.forum.toolbar.link")},m(Gh(),{className:"Button Button--icon "+(n?"active":""),icon:"fas fa-link",disabled:e,onclick:function(){var e=prompt(String(r().translator.trans("lady-byron-editor.forum.toolbar.link_prompt")),n?"":"https://");null!==e&&t.setLink(e)}}))},n.hiddenItemsDropdown=function(t,e){return m(Qh(),{className:"TiptapMenu-more",buttonClassName:"Button Button--icon",icon:"fas fa-ellipsis-h",label:"",disabled:e,menuClassName:"HiddenItemsDropdownMenu"},this.hiddenItems().toArray())},f(e,[{key:"state",get:function(){return this.attrs.state}}])}(Uh()),rp=function(){function t(){this.editor=null,this.boundUpdate=null,this.redrawTimeout=null}var e=t.prototype;return e.attachEditor=function(t){var e=this;this.editor=t,this.boundUpdate=function(){e.redrawTimeout&&clearTimeout(e.redrawTimeout),e.redrawTimeout=window.setTimeout(function(){return m.redraw()},16)},t.on("selectionUpdate",this.boundUpdate),t.on("update",this.boundUpdate)},e.destroy=function(){this.redrawTimeout&&(clearTimeout(this.redrawTimeout),this.redrawTimeout=null),this.editor&&this.boundUpdate&&(this.editor.off("selectionUpdate",this.boundUpdate),this.editor.off("update",this.boundUpdate)),this.boundUpdate=null,this.editor=null},e.isActive=function(t,e){var n,r;return null!=(n=null==(r=this.editor)?void 0:r.isActive(t,e))&&n},e.canUndo=function(){var t,e;return null!=(t=null==(e=this.editor)?void 0:e.can().undo())&&t},e.canRedo=function(){var t,e;return null!=(t=null==(e=this.editor)?void 0:e.can().redo())&&t},e.toggleBold=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBold().run()},e.toggleItalic=function(){var t;null==(t=this.editor)||t.chain().focus().toggleItalic().run()},e.toggleStrike=function(){var t;null==(t=this.editor)||t.chain().focus().toggleStrike().run()},e.toggleCode=function(){var t;null==(t=this.editor)||t.chain().focus().toggleCode().run()},e.toggleCodeBlock=function(){var t;null==(t=this.editor)||t.chain().focus().toggleCodeBlock().run()},e.toggleBlockquote=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBlockquote().run()},e.toggleBulletList=function(){var t;null==(t=this.editor)||t.chain().focus().toggleBulletList().run()},e.toggleOrderedList=function(){var t;null==(t=this.editor)||t.chain().focus().toggleOrderedList().run()},e.setHeading=function(t){var e;null==(e=this.editor)||e.chain().focus().toggleHeading({level:t}).run()},e.setParagraph=function(){var t;null==(t=this.editor)||t.chain().focus().setParagraph().run()},e.setLink=function(t){var e,n;t?null==(e=this.editor)||e.chain().focus().setLink({href:t}).run():null==(n=this.editor)||n.chain().focus().unsetLink().run()},e.insertHorizontalRule=function(){var t;null==(t=this.editor)||t.chain().focus().setHorizontalRule().run()},e.undo=function(){var t;null==(t=this.editor)||t.chain().focus().undo().run()},e.redo=function(){var t;null==(t=this.editor)||t.chain().focus().redo().run()},t}();r().initializers.add("lady-byron/editor",function(){(0,o.extend)(u().prototype,"buildEditorParams",function(t){this.menuState=new rp,t.classNames.push("Post-body"),t.escape=function(){return r().composer.close()}}),(0,o.override)(u().prototype,"buildEditor",function(t,e){var n=new Wh;return n.build(e,this.buildEditorParams()),this.tiptapDriver=n,this.menuState&&n.editor&&this.menuState.attachEditor(n.editor),n}),(0,o.extend)(u().prototype,"toolbarItems",function(t){t.has("markdown")&&t.remove("markdown"),t.add("tiptap-toolbar",m(np,{state:this.menuState,disabled:this.attrs.disabled}),100)}),(0,o.extend)(u().prototype,"onremove",function(){this.menuState&&(this.menuState.destroy(),this.menuState=null),this.tiptapDriver&&(this.tiptapDriver=null)})})})(),module.exports=e})();
//# sourceMappingURL=forum.js.map